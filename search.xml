<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Stata画中国省级地图</title>
      <link href="/2023/02/18/stata-hua-zhong-guo-sheng-ji-di-tu/"/>
      <url>/2023/02/18/stata-hua-zhong-guo-sheng-ji-di-tu/</url>
      
        <content type="html"><![CDATA[<p>参考：<a href="https://www.bilibili.com/video/BV12L411J7Vt/?vd_source=02b8b2856e40df6b2aacc74fc07e9257">使用 Stata 绘制中国省级地图！比例尺、指北针、秦岭-淮河线、胡焕庸线、海岸线</a></p><p>代码：<a href="https://github.com/Wsf921109/stata-prov-map/blob/main/README.md">github</a></p><p>笔记</p><p>填充地图</p><p><img src="/images/pic1.png" alt="pic1"></p><p><img src="/images/pic2.png" alt="pic2"></p><p>离散变量填充地图</p><p><img src="/images/pic8.png" alt="pic8"></p><p>连续变量填充地图</p><p><img src="/images/pic3.png" alt="pic3"></p><p>加小部件——矩形</p><p><img src="/images/pic6.png" alt="pic6"></p><p>加小部件——饼图</p><p><img src="/images/pic5.png" alt="pic5"></p><p>描点——点的大小表示另外一个变量</p><p><img src="/images/pic4.png" alt="pic4"></p><p>距离秦岭——淮河越近，点越小，距离越远，点越大。</p><pre><code>*画多边形chinaprov40_db.dta  //属性文件chinaprov40_coord.dta  //坐标文件*画线条和框线chinaprov40_line_db.dtachinaprov40_line_coord.dta*标签的位置chinaprov40_label.dta*画比例尺和指南针的多边形polygon.dta*画最简单的地图use chinaprov40_db.dta,clear*use chinaprov40_coord.dta,clearspmap using chinaprov40_coord.dta,id(ID)*加九段线和比例尺、胡焕庸线等use chinaprov40_db.dta,clearspmap using chinaprov40_coord.dta,id(ID) ///line(data(chinaprov40_line_coord.dta))*use chinaprov40_line_coord.dta,clear*use chinaprov40_line_db.dta,clear  //查看每一个ID对应的属性*删掉胡焕庸线*use chinaprov40_line_db.dta,clear  //查看每一个ID对应的属性*_ID=41use chinaprov40_db.dta,clearspmap using chinaprov40_coord.dta,id(ID) ///line(data(chinaprov40_line_coord.dta) ///select(drop if _ID ==44))*删掉秦岭淮河线*use chinaprov40_line_db.dta,clear  //查看每一个ID对应的属性*_ID=38use chinaprov40_db.dta,clearspmap using chinaprov40_coord.dta,id(ID) ///line(data(chinaprov40_line_coord.dta) ///select(drop if _ID ==44 |_ID ==38))*查看省与属性的一一对应关系use chinaprov40_line_coord.dta,clearren _ID IDmerge m:1 ID using chinaprov40_line_db.dtacontract group 省*group  类别*1    省界线*2    国界线*3    海岸线*4    秦岭-淮河线*5    小地图框格*6    指北针/比例尺*7    胡焕庸线*group的作用，不同的线条使用不同的粗细和颜色use chinaprov40_db.dta,clearspmap using chinaprov40_coord.dta,id(ID) ///line(data(chinaprov40_line_coord.dta) ///*select(drop if _ID ==44 |_ID ==38) ///by(group) size(vvthin *1.2 *0.5 *1.2 *0.5 *0.5 *1.2 )///color(white black blue%50 green black black red))*填充比例尺的颜色——polygonuse chinaprov40_db.dta,clearspmap using chinaprov40_coord.dta,id(ID) ///line(data(chinaprov40_line_coord.dta) ///*select(drop if _ID ==44 |_ID ==38) ///by(group) size(vvthin *1.2 *0.5 *1.2 *0.5 *0.5 *1.2 ) ///color(white black blue%50 green black black red)) ///polygon(data(polygon.dta) fcolor(black)) ///画多边形*加省份标签use chinaprov40_db.dta,clearspmap using chinaprov40_coord.dta,id(ID) ///line(data(chinaprov40_line_coord.dta) ///*select(drop if _ID ==44 |_ID ==38) ///by(group) size(vvthin *1.2 *0.5 *1.2 *0.5 *0.5 *1.2 ) ///color(white black blue%50 green black black red)) ///polygon(data(polygon.dta) fcolor(black)) /// //画多边形label(data(chinaprov40_label.dta) x(X) y(Y) label(cname)) //画中文标签*不要南海诸岛和指北针的标签use chinaprov40_db.dta,clearspmap using chinaprov40_coord.dta,id(ID) ///line(data(chinaprov40_line_coord.dta) ///*select(drop if _ID ==44 |_ID ==38) ///by(group) size(vvthin *1.2 *0.5 *1.2 *0.5 *0.5 *1.2 ) ///color(white black blue%50 green black black red)) ///polygon(data(polygon.dta) fcolor(black)) /// //画多边形label(data(chinaprov40_label.dta) x(X) y(Y) label(cname) ///*select(drop if cname==&quot;南海诸岛&quot;)) //画中文标签 select(drop if inlist(cname,&quot;南海诸岛&quot;,&quot;N&quot;,&quot;1000km&quot;)) //画中文标签*如何移动指北针和比例尺线条-多边形和use chinaprov40_line_coord.dta,clearuse chinaprov40_line_db.dta,clearreplace _X = _X+3000000 if inlist(_ID,40,41)replace _Y = _Y+4000000 if inlist(_ID,40,41) //单位是米save chinaprov40_line_coord2.dta,replace*画出坐标系，以确定X轴和Y轴要移动多少——freestyleuse chinaprov40_db.dta,clearspmap using chinaprov40_coord.dta,id(ID) ///line(data(chinaprov40_line_coord.dta) ///*select(drop if _ID ==44 |_ID ==38) ///by(group) size(vvthin *1.2 *0.5 *1.2 *0.5 *0.5 *1.2 ) ///color(white black blue%50 green black black red)) ///polygon(data(polygon.dta) fcolor(black)) /// //画多边形label(data(chinaprov40_label.dta) x(X) y(Y) label(cname)) freestyle//画中文标签*移动线条use polygon.dta,clearreplace _X = _X+3000000 if _ID==38replace _Y = _Y+4000000 if _ID==38save polygon2.dta,replaceuse chinaprov40_label.dta,clearreplace X = X + 3000000 if cname==&quot;N&quot;replace Y = Y + 4000000 if cname==&quot;N&quot;save chinaprov40_label2.dta,replaceuse chinaprov40_db.dta,clearspmap using chinaprov40_coord.dta,id(ID) ///line(data(chinaprov40_line_coord2.dta) ///*select(drop if _ID ==44 |_ID ==38) ///by(group) size(vvthin *1.2 *0.5 *1.2 *0.5 *0.5 *1.2 ) ///color(white black blue%50 green black black red)) ///polygon(data(polygon2.dta) fcolor(black)) /// //画多边形label(data(chinaprov40_label2.dta) x(X) y(Y) label(cname))*同时移动指北针和比例尺use chinaprov40_line_coord.dta,clearreplace _X = _X+3000000 if inlist(_ID,40,41)replace _Y = _Y+4000000 if inlist(_ID,40,41)replace _Y = _Y+200000 if inlist(_ID,42,43)save chinaprov40_line_coord2.dta,replaceuse polygon.dta,clearreplace _X = _X+3000000 if _ID==38replace _Y = _Y+4000000 if _ID==38replace _Y = _Y+200000 if _ID==39save polygon2.dta,replaceuse chinaprov40_label.dta,clearreplace X = X + 3000000 if cname==&quot;N&quot;replace Y = Y + 4000000 if cname==&quot;N&quot;replace Y = Y + 200000 if cname==&quot;1000km&quot;save chinaprov40_label2.dta,replaceuse chinaprov40_db.dta,clearspmap using chinaprov40_coord.dta,id(ID) ///line(data(chinaprov40_line_coord2.dta) ///*select(drop if _ID ==44 |_ID ==38) ///by(group) size(vvthin *1.2 *0.5 *1.2 *0.5 *0.5 *1.2 ) ///color(white black blue%50 green black black red)) ///polygon(data(polygon2.dta) fcolor(black)) /// //画多边形label(data(chinaprov40_label2.dta) x(X) y(Y) label(cname) size(*0.8))/// 设置标签小一点graphr(margin(medium))// 调整边距，放大*案例一：2019年中国省级行政区域use chinaprov40_db.dta,clearencode 类型,gen(type)codebook type //查看数-标签对照*注意 stata15（含）使用spmap，15之后就可以使用grmap，第一次使用需要激活*grmap,activate *使用grmap和spmap的结果是一样的，spmap是第三方，grmap是官方grmap type using chinaprov40_coord.dta,id(ID) /// //不需要改动底图，只需要添加type进行填充line(data(chinaprov40_line_coord2.dta) ///*select(drop if _ID ==44 |_ID ==38) ///by(group) size(vvthin *1.2 *0.5 *1.2 *0.5 *0.5 *1.2 ) ///color(white /// 省界颜色              black /// 国界线颜色              &quot;0 85 170&quot; /// 海岸线颜色              &quot;24 188 156&quot; /// 秦岭淮河线颜色              black /// 小地图框格颜色              black /// 比例尺和指北针颜色              &quot;227 26 28&quot; /// 胡焕庸线颜色              )) ///polygon(data(polygon2.dta) fcolor(black)) /// //画多边形label(data(chinaprov40_label2.dta) x(X) y(Y) label(cname) size(*0.8))/// 设置标签小一点graphr(margin(medium))// 调整边距，放大*想要的是每一种type对应一种颜色，但图形是分组1-4,4-5重新设定分组help spmap*clmethod(custom) clbreak(0 1 2 3 4 5) 自定义分组，分成五组fcolor(&quot;254 212 57&quot; &quot;253 116 70&quot; &quot;138 145 151&quot; &quot;213 228 162&quot; &quot;210 175 129&quot;) ///自己填充颜色，可选择渐变色*gr export test.pdf,replaceosize(vvthin ...)/// outline 边框线（省界）的大小 ...表示所有的图层 ocolor(white ...) ///颜色为白色legend(order(2 &quot;不统计&quot; 3 &quot;特别行政区&quot; 4 &quot;直辖市&quot; 5 &quot;省&quot; 6 &quot;自治区&quot; 11 &quot;秦岭-淮河线&quot; 14 &quot;胡焕庸线&quot;))ti(&quot;使用 Stata 绘制 2019 年中国省级行政区划&quot;) ///    subti(&quot;绘制：微信公众号 RStata&quot;) ///    caption(&quot;版本：使用 Stata 绘制中国省级地图数据包 4.0&quot;, size(*0.8))    gr export pic1.png, replace width(1200)*使用graph editor查看图层对应案例一：全部代码离散变量的绘制use chinaprov40_db.dta, clear encode 类型, gen(type)codebook typegrmap type using chinaprov40_coord.dta, ///    id(ID) osize(vvthin ...) ocolor(white ...) ///    clmethod(custom) clbreaks(0 1 2 3 4 5) ///    fcolor(&quot;254 212 57&quot; &quot;253 116 70&quot; &quot;138 145 151&quot; &quot;213 228 162&quot; &quot;210 175 129&quot;) ///    leg(order(2 &quot;不统计&quot; 3 &quot;特别行政区&quot; 4 &quot;直辖市&quot; 5 &quot;省&quot; 6 &quot;自治区&quot; 11 &quot;秦岭-淮河线&quot; 14 &quot;胡焕庸线&quot;)) ///    graphr(margin(medium)) ///    line(data(chinaprov40_line_coord.dta) by(group) size(vvthin *1 *0.5 *1.2 *0.5 *0.5 *1.2) pattern(solid ...) ///        color(white /// 省界颜色              black /// 国界线颜色              &quot;0 85 170&quot; /// 海岸线颜色              &quot;24 188 156&quot; /// 秦岭淮河线颜色              black /// 小地图框格颜色              black /// 比例尺和指北针颜色              &quot;227 26 28&quot; /// 胡焕庸线颜色              )) ///    polygon(data(polygon) fcolor(black) ///        osize(vvthin)) ///    label(data(chinaprov40_label) x(X) y(Y) label(cname) length(20) size(*0.8)) ///    ti(&quot;使用 Stata 绘制 2019 年中国省级行政区划&quot;) ///    subti(&quot;绘制：微信公众号 RStata&quot;) ///    caption(&quot;版本：使用 Stata 绘制中国省级地图数据包 4.0&quot;, size(*0.8))gr export pic1.png, replace width(1200)案例二-案例一的英文版本*chinaprov40_label.dta 数据决定了文本标签的位置和内容，如果想绘制英文版的地图，可以使用 ename 变量：grmap type using chinaprov40_coord.dta, ///    id(ID) osize(vvthin ...) ocolor(white ...) ///    clmethod(custom) clbreaks(0 1 2 3 4 5) ///    fcolor(&quot;254 212 57&quot; &quot;253 116 70&quot; &quot;138 145 151&quot; &quot;213 228 162&quot; &quot;210 175 129&quot;) ///    leg(order(2 &quot;Not within the scope of statistics&quot; 3 &quot;Special administrative region&quot; 4 &quot;Municipality directly under&quot; &quot;the Central Government&quot; 5 &quot;Province&quot; 6 &quot;Autonomous Region&quot; 11 &quot;Qinling Huaihe River Line&quot; 14 &quot;Hu Huanyong line&quot;)) /// 换行    graphr(margin(medium)) ///    line(data(chinaprov40_line_coord.dta) by(group) size(vvthin *1 *0.5 *1.2 *0.5 *0.5 *1.2) pattern(solid ...) ///        color(white /// 省界颜色              black /// 国界线颜色              &quot;0 85 170&quot; /// 海岸线颜色              &quot;24 188 156&quot; /// 秦岭淮河线颜色              black /// 小地图框格颜色              black /// 比例尺和指北针颜色              &quot;227 26 28&quot; /// 胡焕庸线颜色              )) ///    polygon(data(polygon) fcolor(black) ///        osize(vvthin)) ///    label(data(chinaprov40_label) x(X) y(Y) label(ename) length(20) size(*0.6)) ///标签长度和大小    ti(&quot;Using Stata to draw China&#39;s provincial map in 2019&quot;) ///    subti(&quot;WeChat Subscription: RStata&quot;) ///    caption(&quot;Version: 4.0&quot;, size(*0.8))gr export pic2.png, replace width(1200)案例三：连续变量*连续变量的绘制方法和离散变量的类似，通过恰当的分组和颜色填充就可以绘制出精美的图表了，下面以2020 年中国各省市地区生产总值的填充地图绘制为例：import delimited using &quot;2020年中国各省市地区生产总值.csv&quot;, clear encoding(utf8)gen prov = substr(省份, 1, 6)save 2020年中国各省市地区生产总值, replace use chinaprov40_db.dta, clear gen prov = substr(省, 1, 6) //省份的前两个字merge 1:1 prov using 2020年中国各省市地区生产总值replace 地区生产总值 = -1 if missing(地区生产总值)// 缺失值，缺失也可以填充颜色grmap 地区生产总值 using chinaprov40_coord.dta, ///    id(ID) osize(vvthin ...) ocolor(white ...) ///    clmethod(custom) clbreaks(-1 0 20000 40000 60000 80000 120000) ///    fcolor(gray &quot;224 242 241&quot; &quot;178 223 219&quot; &quot;128 203 196&quot; &quot;77 182 172&quot; &quot;38 166 154&quot;) ///    leg(order(2 &quot;无数据&quot; 3 &quot;&lt; 2 万亿元&quot; 4 &quot;2～4 万亿元&quot; 5 &quot;4～6 万亿元&quot; 6 &quot;6～8 万亿元&quot; 7 &quot;&gt; 8 万亿元&quot;)) ///    graphr(margin(medium)) ///    line(data(chinaprov40_line_coord.dta) ///        /// 去除秦岭淮河线(4)、胡焕庸线(7)        select(keep if inlist(group, 1, 2, 3, 5, 6)) ///        by(group) size(vvthin *1 *0.5 *0.5 *0.5) ///        pattern(solid ...) ///        color(white /// 省界颜色              black /// 国界线颜色              &quot;0 85 170&quot; /// 海岸线颜色              black /// 小地图框格颜色              black /// 比例尺和指北针颜色              )) ///    polygon(data(polygon) fcolor(black) ///        osize(vvthin)) ///    label(data(chinaprov40_label) x(X) y(Y) label(cname) length(20) size(*0.8)) ///    ti(&quot;2020 年中国各省市地区生产总值&quot;) ///    subti(&quot;绘制：微信公众号 RStata&quot;) ///    caption(&quot;数据来源：各地统计局&quot;, size(*0.8))gr export pic3.png, replace width(1200)</code></pre><p>主要关注怎么分组，怎么设定颜色，怎么设定图例？</p><pre><code>案例四：2013年中国工业企业分布及距离秦岭淮河的距离*转换坐标，经纬度到笛卡尔坐标系* 转换方式一：https://czxb.shinyapps.io/crs-trans/* 注意事项，上传的 csv 文件应该包含数值型的 lon 和 lat 变量，观测值上限大概是 10 万个，不可多人同时使用。use gq2013sample.dta,clearkeep *度ren 经度 lonren 维度 latexport delimited using &quot;待上传.csv&quot;,replaceimport delimited using &quot;转换后的数据.csv&quot;,cleargen id = _nsave 转换后的数据,replaceuse gq2013sample.dta,cleargen id=_nmerge 1:1 id using &quot;转换后的数据&quot;keep x y 与秦岭淮河线的距离 北方或南方encode 北方或南方,gen(north)save pointdata,replaceuse chinaprov40_db.dta, clearspmap using chinaprov40_coord.dta, id(ID) /// 不需要填充    ocolor(&quot;black&quot; ...) osize(vvthin ...) ///    line(data(chinaprov40_line_coord.dta) ///        /// 胡焕庸线（7）        select(keep if inlist(group, 1, 2, 3, 4, 5, 6)) ///        by(group) size(vvthin *1 *0.5 *1.5 *0.5 *0.5) ///        pattern(solid ...) ///        color(white /// 省界颜色              black /// 国界线颜色              &quot;0 85 170&quot; /// 海岸线颜色              &quot;0 85 170&quot; /// 秦岭淮河线颜色              black /// 小地图框格颜色              black /// 比例尺和指北针颜色              )) ///    polygon(data(polygon) fcolor(black) ///        osize(vvthin)) ///    label(data(chinaprov40_label) x(X) y(Y) label(cname) length(20) size(*0.8)) ///    point(data(pointdata) by(north) ///        fcolor(&quot;227 26 28%30&quot; &quot;24 188 156%30&quot;) ///        x(x) y(y) ///        proportional(与秦岭淮河线的距离) /// 点的大小        size(*0.1) legenda(on)) ///    leg(order(7 &quot;秦岭-淮河线&quot; 10 &quot;北方工企业&quot; 11 &quot;南方工企业&quot;)) ///    ti(&quot;2013 年中国工业企业与秦岭-淮河线的距离&quot;, color(black)) ///     subti(&quot;绘制：微信公众号 RStata&quot;) ///    graphr(margin(medium)) ///    caption(&quot;数据来源：2013 年中国工业企业数据库，使用高德地图地理编码接口解析经纬度&quot;, size(*0.8))gr export pic4.png, replace width(1200)</code></pre><p>案例五：加饼图</p><pre><code>饼图的位置可以用标签位置：use 各省历年GDP, clear drop if 省份 == &quot;中国&quot;replace 地区生产总值_亿元 = 地区生产总值_亿元 / 1000merge m:m 省代码 using chinaprov40_db.dtareplace 地区生产总值_亿元 = -1 if missing(年份)grmap 地区生产总值_亿元 if 年份 == 2019 | missing(年份) ///    using chinaprov40_coord.dta, id(ID) ///    clmethod(custom) clbreaks(-1 0 40 60 80 100 120) ///     fcolor(&quot;gray&quot; &quot;237 248 233&quot; &quot;199 233 192&quot; &quot;161 217 155&quot; &quot;116 196 118&quot; &quot;49 163 84&quot;) ///    ocolor(&quot;gray&quot; ...) ///    ti(&quot;2019 年中国各省地区生产总值 &amp; 产业结构&quot;, size(*1.1)) ///    subtitle(&quot;数据来源：CSMAR经济金融数据库&quot;) ///    graphr(margin(medium)) ///    osize(vvthin ...) ///    legend(size(*1.1) ///        order(2 &quot;无数据&quot; 3 &quot;&lt; 40千亿&quot; ///            4 &quot;40～60千亿&quot; 5 &quot;60～80千亿&quot; ///            6 &quot;80～100千亿&quot; 7 &quot;&gt; 100千亿&quot; ///            14 &quot;第一产业&quot; 15 &quot;第二产业&quot; 16 &quot;第三产业&quot;)) ///    caption(&quot;绘制：微信公众号 RStata&quot;, size(*0.8)) ///    line(data(chinaprov40_line_coord.dta) ///        /// 去除秦岭淮河线(4) 胡焕庸线（7）        select(keep if inlist(group, 1, 2, 3, 5, 6)) ///        by(group) size(vvthin *1 *0.5 *0.5 *0.5) ///        pattern(solid ...) ///        color(white /// 省界颜色              black /// 国界线颜色              &quot;0 85 170&quot; /// 海岸线颜色              black /// 小地图框格颜色              black /// 比例尺和指北针颜色              )) ///    polygon(data(polygon) fcolor(black) ///        osize(vvthin)) ///    label(data(chinaprov40_label) x(X) y(Y) label(cname) length(20) size(*0.8)) ///    diagram(data(piedata) x(X) y(Y) v(第一产业占GDP比重_百分比 第二产业占GDP比重_百分比 第三产业占GDP比重_百分比) ///        type(pie) legenda(on) os(vvthin) ///            size(1.5) fc(&quot;102 194 165&quot; &quot;252 141 98&quot; &quot;229 196 148&quot;) ///            oc(&quot;102 194 165&quot; &quot;252 141 98&quot; &quot;229 196 148&quot;))gr export &quot;pic5.png&quot;, replace width(1200)</code></pre><p>饼图也可以换成框架矩形图：</p><pre><code>grmap 地区生产总值_亿元 if 年份 == 2019 | missing(年份) ///    using chinaprov40_coord.dta, id(ID) ///    clmethod(custom) clbreaks(-1 0 40 60 80 100 120) ///     fcolor(&quot;gray&quot; &quot;237 248 233&quot; &quot;199 233 192&quot; &quot;161 217 155&quot; &quot;116 196 118&quot; &quot;49 163 84&quot;) ///    ocolor(&quot;gray&quot; ...) ///    ti(&quot;2019 年中国各省地区生产总值 &amp; 第一产业比重&quot;, size(*1.1)) ///    subtitle(&quot;数据来源：CSMAR经济金融数据库&quot;) ///    graphr(margin(medium)) ///    osize(vvthin ...) ///    legend(size(*1.1) ///        order(2 &quot;无数据&quot; 3 &quot;&lt; 40千亿&quot; ///            4 &quot;40～60千亿&quot; 5 &quot;60～80千亿&quot; ///            6 &quot;80～100千亿&quot; 7 &quot;&gt; 100千亿&quot; ///            15 &quot;第一产业比重&quot;)) ///    caption(&quot;绘制：微信公众号 RStata&quot;, size(*0.8)) ///    line(data(chinaprov40_line_coord.dta) ///        /// 去除秦岭淮河线(4) 胡焕庸线（7）        select(keep if inlist(group, 1, 2, 3, 5, 6)) ///        by(group) size(vvthin *1 *0.5 *0.5 *0.5) ///        pattern(solid ...) ///        color(white /// 省界颜色              black /// 国界线颜色              &quot;0 85 170&quot; /// 海岸线颜色              black /// 小地图框格颜色              black /// 比例尺和指北针颜色              )) ///    polygon(data(polygon) fcolor(black) ///        osize(vvthin)) ///    diagram(data(piedata) x(X) y(Y) v(第一产业占GDP比重_百分比) ///        type(frect) legenda(on) os(vvthin) ///            size(1.5) fc(&quot;252 141 98&quot;) ///            oc(&quot;252 141 98&quot;) refsize(none))gr export &quot;pic6.png&quot;, replace width(1200)</code></pre><p>案例六：各省人口密度</p><p>最后我们再演示下胡焕庸线的用法：</p><pre><code>use 中国人口空间分布省级面板数据集.dta, clear ren 省份 省merge m:1 省 using chinaprov40_db.dtakeep if 年份 == 2015 | missing(年份)replace 均值 = -1 if missing(均值)grmap 均值 using chinaprov40_coord.dta, ///    id(ID) osize(vvthin ...) ocolor(white ...) ///    clmethod(custom) clbreaks(-1 0 100 1000 2000 3000 4000) ///    fcolor(gray &quot;224 242 241&quot; &quot;178 223 219&quot; &quot;128 203 196&quot; &quot;77 182 172&quot; &quot;38 166 154&quot;) ///    leg(order(2 &quot;无数据&quot; 3 &quot;&lt; 100 人/平方公里&quot; 4 &quot;100～1000 人/平方公里&quot; 5 &quot;1000～2000 人/平方公里&quot; 6 &quot;2000～3000 人/平方公里&quot; 7 &quot;&gt; 3000 人/平方公里&quot; 14 &quot;胡焕庸线&quot;)) ///    graphr(margin(medium)) ///    line(data(chinaprov40_line_coord.dta) ///        /// 去除秦岭淮河线(4)        select(keep if inlist(group, 1, 2, 3, 5, 6, 7)) ///        by(group) size(vvthin *1 *0.5 *0.5 *0.5 *1.2) ///        pattern(solid ...) ///        color(white /// 省界颜色              black /// 国界线颜色              &quot;0 85 170&quot; /// 海岸线颜色              black /// 小地图框格颜色              black /// 比例尺和指北针颜色              &quot;227 26 28&quot; /// 胡焕庸线颜色              )) ///    polygon(data(polygon) fcolor(black) ///        osize(vvthin)) ///    label(data(chinaprov40_label) x(X) y(Y) label(cname) length(20) size(*0.8)) ///    ti(&quot;2015 年中国各省平均人口密度&quot;) ///    subti(&quot;绘制：微信公众号 RStata&quot;) ///    caption(&quot;数据来源：中国科学院资源环境科学与数据中心&quot;, size(*0.8))gr export pic7.png, replace width(1200)</code></pre><h4 id="【Stata】绘制一份完完整整的中国地图！"><a href="#【Stata】绘制一份完完整整的中国地图！" class="headerlink" title="【Stata】绘制一份完完整整的中国地图！"></a>【Stata】绘制一份完完整整的中国地图！</h4><p>文件准备：.shp和.dbf</p><p>转换文件：转换为stata可以识别的.dta</p><p>使用spmap命令绘图</p><p>找shp文件的方法：</p><p>stata自带命令提供的中国地图是不完整的，是不能使用的；另外，不过这个地图画出来也只能做ppt的演示，在国内发文章需要有正规的审图号，没审图号，发英文可以，中文期刊比较严格</p><p>阿里云地图选择器：<a href="http://datav.aliyun.com/tools/atlas/index.html">http://datav.aliyun.com/tools/atlas/index.html</a></p><p>在json格式，优点，在后续倒入快很多</p><p>shp格式转换：<a href="https://mapshaper.org/">https://mapshaper.org/</a></p><p><img src="/images/image-20230307144909621.png" alt="image-20230307144909621"></p><p><img src="/images/image-20230307145115235.png" alt="image-20230307145115235"></p><p>底图+指标</p><p><img src="/images/640.png" alt="图片"></p><p>也可以不使用stata画九段线，使用没有九段线的图和带九段线的图，在ppt中合并为1张图</p><h2 id="stata-画二维地图"><a href="#stata-画二维地图" class="headerlink" title="stata 画二维地图"></a>stata 画二维地图</h2><h2 id="1-简介"><a href="#1-简介" class="headerlink" title="1. 简介"></a>1. 简介</h2><p>二维地图很复杂，但是并不在于他们有多难画，而在于我们往往难以预料到画完的结果。很多时候我们很难绘制想要的图，但是一个像下面这样非常漂亮的图，无疑可以为我们的论文增添不少光彩。下面就让我们看看如何绘制二维地图吧！</p><p><img src="/images/空间计量二维地图_陈卓然_Fig24.png" alt="img"></p><p><img src="/images/空间计量二维地图_陈卓然_Fig25.png" alt="img"></p><p> </p><h2 id="2-准备工作"><a href="#2-准备工作" class="headerlink" title="2. 准备工作"></a>2. 准备工作</h2><p>首先安装如下命令，并进行相关设置。</p><pre><code>ssc install geo2xy, replace  // 用来调整地图的映射ssc install schemepack, replace  // Stata绘图模板仓库set scheme white_tableau                  // 设置绘图模板graph set window fontface &quot;Arial Narrow&quot;  // 设置绘图字体</code></pre><p>然后下载数据「<a href="https://www2.census.gov/programs-surveys/popest/datasets/2010-2020/counties/asrh/CC-EST2020-ALLDATA6.csv">CC-EST2020-ALLDATA6.csv</a>」，并做一些数据清理的工作。</p><pre><code>import delim CC-EST2020-ALLDATA6.csv, cleartab year keep if year==13   // 2020keep if agegrp==0  // TOTALdrop year agegrpkeep sumlev state county stname ctyname tot_pop ba_male ba_female h_male h_female aa_male aa_femaledestring _all, replaceren state  STATEFPren county COUNTYFPgen tot_afam  = ba_male  + ba_female  // african-americangen tot_hisp  = h_male   + h_female   // hispanicgen tot_asian = aa_male  + aa_female  // asiangen share_afam  = (tot_afam  / tot_pop) * 100gen share_hisp  = (tot_hisp  / tot_pop) * 100gen share_asian = (tot_asian / tot_pop) * 100compresssave county_race.dta, replace</code></pre><p>接着，下载州和县的 ShapeFiles，即「<a href="https://www2.census.gov/geo/tiger/GENZ2018/shp/cb_2018_us_state_500k.zip">cb_2018_us_state_500k.zip</a>」。现在，我们从边界开始画起。</p><pre><code>spshape2dta cb_2018_us_state_500k.shp,replace saving(usa_state)</code></pre><p>以上命令语句是将 .shp 格式的文件转化为 Stata 认识的 .dta 格式的文件。</p><pre><code>use usa_state, clearspmap using usa_state_shp, id(_ID)</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig2.png" alt="img"></p><p>很不巧，阿拉斯加实在是太大的，为了后续作图的美观，我们将阿拉斯加和夏威夷群岛去掉，只留下美国本土。为了快速找出这几个不在美国本土的州，我们用下面这个巧妙的方法来得到这些岛屿的识别码。</p><pre><code>twoway (scatter _CY _CX, mlabel(STATEFP))</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig3.png" alt="img"></p><p>这样我们就找到了需要删掉掉的岛屿的识别码了，他们是 <code>STATEFP = 02, 15, 60, 66, 69, 72, 78</code></p><pre><code>* clean up the boundaries use usa_state_shp, clearmerge m:1 _ID using usa_state  // to get the identifiersdestring STATEFP, replace drop if inlist(STATEFP,2,15,60,66,69,72,78)twoway (scatter _Y _X)</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig4.png" alt="img"></p><p>好像和我们平时看到的美国地图不太一样，我们可以采用 <code>geo2xy</code> 这个命令来将经纬度转换到笛卡尔坐标系当中。</p><pre><code>geo2xy _Y _X, proj(albers) replacetwoway (scatter _Y _X)</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig5.png" alt="img"></p><p>看上去好多了！下面我们简单清理一下数据，然后保存起来。</p><pre><code>drop _CX- _merge sort _ID shape_ordersave usa_state_shp_clean.dta, replace</code></pre><p>让我们看下此时的地图长啥样。</p><pre><code>use usa_state, clearspmap using usa_state_shp_clean, id(_ID)</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig6.png" alt="img"></p><p>看上去很不错，下面我们再对不同的县做同样的处理，这里需要下载文件「<a href="https://www2.census.gov/geo/tiger/GENZ2018/shp/cb_2018_us_county_500k.zip">cb_2018_us_county_500k.zip</a>」。</p><pre><code> * get the counties in order spshape2dta &quot;cb_2018_us_county_500k.shp&quot;, replace saving(usa_county)* clean up the boundaries use usa_county_shp, clearmerge m:1 _ID using usa_countydestring STATEFP, replace drop if inlist(STATEFP,2,15,60,66,69,72,78)drop _CX- _merge geo2xy _Y _X, proj(albers) replacesort _ID shape_ordersave usa_county_shp_clean.dta, replace * 绘制地图use usa_county, cleardestring _all, replacespmap using usa_county_shp_clean, id(_ID)</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig7.png" alt="img"></p><p> </p><h2 id="3-地图"><a href="#3-地图" class="headerlink" title="3. 地图"></a>3. 地图</h2><p>首先让我们把需要的数据全部合并到一份文件当中。</p><pre><code>use usa_county, cleardestring _all, replacemerge 1:1 STATEFP COUNTYFP using county_racekeep if _m==3drop _mspmap share_afam using usa_county_shp_clean, id(_ID) clm(custom) clb(0(10)100) fcolor(Heat)  // 非裔美国人的比例</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig8.png" alt="img"></p><pre><code>spmap share_hisp using usa_county_shp_clean, id(_ID) clm(custom) clb(0(10)100)  fcolor(Heat)  // 拉美裔美国人比例</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig9.png" alt="img"></p><p>可以看到拉美裔和非裔美国人的分布存在显著差异。我们也可以画一个散点图来直观体现非裔美国人和拉美裔美国人之间的交叠部分。</p><pre><code>scatter share_afam share_hisp</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig10.png" alt="img"></p><p>可以发现二者几乎没有什么重叠区域。下面我们将这个散点图按种类分开。对于双变量的地图，我们需要分配 9 种或者 16 种颜色到不同的种类组合。但是在具体分配之前，我们需要做一件重要的事情就是弄清楚颜色分配的顺序。作者给出这样的颜色分配顺序：</p><p><img src="/images/空间计量二维地图_陈卓然_Fig11.png" alt="img"></p><p>接下来要做的是将数据按照顺序分为 9 组，分组的方式有很多，我们可以采用等分的方式或分位数分组的方式。首先让我们看一下如何采用等分的方式分组，作者给出了一种非常巧妙的方法。</p><pre><code>* 将数据进行切分cap drop cut*egen cut_afam = cut(share_afam), at(0,33,66,100) icodesegen cut_hisp = cut(share_hisp), at(0,33,66,100) icodesegen cut_hisp2 = cut(share_hisp), group(3) icodes // 这个就是分位数* 分组sort cut_afam cut_hispegen grp_cut = group(cut_afam cut_hisp)</code></pre><p>分位数分组数命令如下：</p><pre><code> * 分位数cap drop xtile*xtile xtile_afam = share_afam, n(3)xtile xtile_hisp = share_hisp, n(3) * 分组sort xtile_afam xtile_hispegen grp_xtile = group(xtile_afam xtile_hisp)</code></pre><p>下面我们来比较一下这两种分组的结果：</p><pre><code>twoway (scatter share_hisp share_afam, msize(small) mc(%10)), yline(0 33 66 100) ///       xline(0 33 66 100) xlabel(0(20)100) ylabel(0(20)100) aspect(1) * get the cut-off points from tabstattabstat share_hisp, by(xtile_hisp) c(stat) stat(max) tabstat share_afam, by(xtile_afam) c(stat) stat(max) * based on percentilestwoway (scatter share_hisp share_afam, msize(small) mc(%10)), yline(0 3 7.4 100) ///       xline(0 1.2 6.5 100) xlabel(0(20)100) ylabel(0(20)100) aspect(1)</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig12.png" alt="img"></p><p><img src="/images/空间计量二维地图_陈卓然_Fig13.png" alt="img"></p><p>很明显，在等分法画出的图大约 80% 的点都落在左下角的那个方格当中，而在右上角的方格中却没有点，因此等分法的结果并不理想。相比之下以分位数法分组的结果就很理想，分位数的设置使得每一个方格中都有大约相等的点数。所以相比于等分法而言，分位数分组的结果可能会更加理想一些。下面我们检查一下两种分组的结果如何改变地图的格式。</p><p>首先是等分的结果：</p><pre><code>spmap grp_cut using usa_county_shp_clean, id(_ID) clm(unique) fcolor(Heat)</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig14.png" alt="img"></p><p>可以看出在等分法分组的情形下并没有什么特别之处，我们划分的 9 类中只有 6 类在图中体现出来了。而且在不同种类中划分地并不均匀。</p><p>其次是分位数的结果：</p><pre><code>spmap grp_xtile using usa_county_shp_clean, id(_ID) clm(unique) fcolor(Heat)</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig15.png" alt="img"></p><p>可以看到我们有 1-9 组，而且每一组都大致相等的点。然而有一个小缺陷就是颜色的深浅并不代表任何顺序。</p><h2 id="4-颜色"><a href="#4-颜色" class="headerlink" title="4. 颜色"></a>4. 颜色</h2><p>二维地图的颜色设计需要仔细考虑，它们需要很容易区分并且有着足够的对比度以呈现更为有意义的信息。首先我们挑选一个紫色的模板：</p><pre><code>colorpalette #e8e8e8 #dfb0d6 #be64ac #ace4e4 #a5add3 #8c62aa #5ac8c8 #5698b9 #3b4994</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig16.png" alt="img"></p><p>下面让我们把颜色放进地图：</p><pre><code>* 颜色放进地图colorpalette #e8e8e8 #dfb0d6 #be64ac #ace4e4 #a5add3 #8c62aa #5ac8c8 #5698b9 #3b4994, nograph local colors `r(p)&#39;spmap grp_xtile using usa_county_shp_clean, ///    id(_ID) clm(unique)  fcolor(&quot;`colors&#39;&quot;) ///    ocolor(white ..) osize(0.02 ..)         ///     ndfcolor(gs14) ndocolor(gs6 ..) ndsize(0.03 ..) ndlabel(&quot;No data&quot;) ///    polygon(data(&quot;usa_state_shp_clean&quot;) ocolor(white) osize(0.15) )    ///    legend(pos(5) size(2.5))  legstyle(2) ///    title(&quot;Comparison of African American versus Hispanic shares&quot;, size(5)) ///    note(&quot;Source: United States Census Bureau&quot;, size(vsmall))</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig17.png" alt="img"></p><p>下面让我们去掉一些额外的信息：</p><pre><code>colorpalette #e8e8e8 #dfb0d6 #be64ac #ace4e4 #a5add3 #8c62aa #5ac8c8 #5698b9 #3b4994, nograph local colors `r(p)&#39;spmap grp_xtile using usa_county_shp_clean, ///     id(_ID) clm(unique)  fcolor(&quot;`colors&#39;&quot;) ///     ocolor(white ..) osize(none ..)         ///      ndfcolor(gs14) ndocolor(gs6 ..) ndsize(0.03 ..) ndlabel(&quot;No data&quot;) ///     polygon(data(&quot;usa_state_shp_clean&quot;) ocolor(white) osize(0.12) )    ///     legend(off) name(bivar_map, replace)</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig18.png" alt="img"></p><p> </p><h2 id="5-图例"><a href="#5-图例" class="headerlink" title="5. 图例"></a>5. 图例</h2><p>首先我们先在一个干净的画布上生成九个格点：</p><pre><code>clearset obs 9egen y = seq(), b(3)  egen x = seq(), t(3)twoway (scatter y x)</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig19.png" alt="img"></p><p>现在将这些点转化为方格，然后增加坐标轴的大小：</p><pre><code>twoway (scatter y x, msymbol(square) msize(18)), xlabel(0 4) ylabel(0 4) aspect(1)</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig20.png" alt="img"></p><p>接下来把颜色放进去了，我们先看如何把对角的颜色填充进去：</p><pre><code>colorpalette #e8e8e8 #dfb0d6 #be64ac #ace4e4 #a5add3 #8c62aa #5ac8c8 #5698b9 #3b4994, nograph return listlocal color11 `r(p1)&#39;local color12 `r(p2)&#39;local color13 `r(p3)&#39;local color21 `r(p4)&#39;local color22 `r(p5)&#39;local color23 `r(p6)&#39;local color31 `r(p7)&#39;local color32 `r(p8)&#39;local color33 `r(p9)&#39;twoway (scatter y x if x==1 &amp; y==1, msymbol(square) msize(18) mc(&quot;`color11&#39;&quot;)) ///    (scatter y x if x==2 &amp; y==2, msymbol(square) msize(18) mc(&quot;`color22&#39;&quot;))    ///     (scatter y x if x==3 &amp; y==3, msymbol(square) msize(18) mc(&quot;`color33&#39;&quot;)),   ///   xlabel(0 4) ylabel(0 4) aspect(1)  legend(off)</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig21.png" alt="img"></p><p>然后我们用循环的方法来快速填充其余的方格：</p><pre><code>* 填充颜色levelsof x, local(xlvl) levelsof y, local(ylvl)local boxesforeach x of local xlvl &#123;     foreach y of local ylvl &#123;         local boxes `boxes&#39; (scatter y x if x==`x&#39; &amp; y==`y&#39;, msymbol(square) ///           msize(19) mc(&quot;`color`x&#39;`y&#39;&#39;&quot;))     &#125; &#125;cap drop spike*gen spike1_x1  = 0.2 in 1gen spike1_x2  = 3.6 in 1 gen spike1_y1  = 0.2 in 1 gen spike1_y2  = 0.2 in 1 gen spike1_m   = &quot;More African Americans&quot;   gen spike2_y1  = 0.2 in 1gen spike2_y2  = 3.2 in 1 gen spike2_x1  = 0.2 in 1  gen spike2_x2  = 0.2 in 1  gen spike2_m   = &quot;More Hispanics&quot;twoway `boxes&#39; (pcarrow spike1_y1 spike1_x1 spike1_y2 spike1_x2, lcolor(gs12) lw(thin)   ///   mcolor(gs12) mlabel(spike1_m) mlabpos(7) headlabel) (pcarrow spike2_y1 spike2_x1    ///    spike2_y2 spike2_x2, lcolor(gs12) lw(thin) mcolor(gs12) mlabel(spike2_m) mlabpos(10) ///   headlabel mlabangle(90) mlabgap(1.8)), xlabel(0 4) ylabel(0 4) aspect(1) legend(off)</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig22.png" alt="img"></p><p>接下来将这张图的尺寸缩小以匹配我们之前绘制的地图，同时删掉原来的坐标轴和格点：</p><pre><code>colorpalette #e8e8e8 #dfb0d6 #be64ac #ace4e4 #a5add3 #8c62aa #5ac8c8 #5698b9 #3b4994, nograph return listlocal color11 `r(p1)&#39;local color12 `r(p2)&#39;local color13 `r(p3)&#39;local color21 `r(p4)&#39;local color22 `r(p5)&#39;local color23 `r(p6)&#39;local color31 `r(p7)&#39;local color32 `r(p8)&#39;local color33 `r(p9)&#39;levelsof x, local(xlvl) levelsof y, local(ylvl)local boxesforeach x of local xlvl &#123;     foreach y of local ylvl &#123;        local boxes `boxes&#39; (scatter y x if x==`x&#39; &amp; y==`y&#39;, msymbol(square) msize(5) ///           mc(&quot;`color`x&#39;`y&#39;&#39;&quot;))     &#125; &#125;twoway `boxes&#39; (pcarrow spike1_y1 spike1_x1 spike1_y2 spike1_x2, lw(thin)   ///              lcolor(gs12)  mcolor(gs12) mlabel(spike1_m) mlabpos(7 ) msize(0.8) headlabel ///            mlabsize(2)) (pcarrow spike2_y1 spike2_x1 spike2_y2 spike2_x2, lw(thin) ///    lcolor(gs12) mcolor(gs12)  mlabel(spike2_m) mlabpos(10) msize(0.8) headlabel ///         mlabangle(90) mlabgap(1.8)  mlabsize(2)), xlabel(0 4, nogrid) ylabel(0 4, nogrid) ///    aspectratio(1) xsize(1) ysize(1)  fxsize(20) fysize(100) legend(off) ytitle(&quot;&quot;) ///    xtitle(&quot;&quot;) xscale(off) yscale(off) name(bivar_legend, replace)</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig23.png" alt="img"></p><p>最后我们将地图和这张小图例合在一起：</p><pre><code> * 合并两张图graph combine bivar_map bivar_legend, imargin(zero) ///       title(&quot;&#123;fontface Arial Bold:Share of African Americans and Hispanics in the USA&#125;&quot;,        size(4.5)) ///       note(&quot;Source of data, and county and state layers: United States Census Bureau.&quot;, size(2))</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig24.png" alt="img"></p><p> </p><h2 id="6-中国地图"><a href="#6-中国地图" class="headerlink" title="6. 中国地图"></a>6. 中国地图</h2><pre><code>set scheme white_tableau                  // 设置绘图模板cap spshape2dta 省级数据/*这条命令可以将 dbf 和 shp 格式的地图文件转为两个 dta 格式的文件，分别以省级数据.dta 和省级数据_shp.dta命名，其中后者省级数据_shp.dta为坐标数据，前者省级数据.dta为标签数据，在绘制地图时，我们主要是通过标签数据中的 ID 变量连接 (合并) 地图数据和作图数据*/* 绘制一维地图import excel 北京大学数字普惠金融指数.xlsx,firstrow sheet(Provinces) clear// 使用总的数字金融普惠指数collapse (mean) index_aggregate, by(prov_name)drop in 1save 普惠金融指数.dta,replaceren prov_name namemerge 1:1 name using &quot;省级数据.dta&quot;// drop in 32 // 由于北大普惠指数没有考虑香港、澳门、台湾，因此这些地区的数据缺失drop _mergespmap index_aggregate using 省级数据_shp, id(_ID) fcolor(Blues)  mocolor(black) mosize(0.1)* 二维地图import excel 北京大学数字普惠金融指数.xlsx, firstrow sheet(Provinces) clearcollapse (mean) coverage_breadth usage_depth, by(prov_name)drop in 1save 数字金融广度和深度.dta,replaceren prov_name namemerge 1:1 name using &quot;省级数据.dta&quot;// drop in 32drop _mergextile xtile_coverage = coverage_breadth, n(3) xtile xtile_usage = usage_depth, n(3)sort xtile_coverage xtile_usagecap drop xtile2egen xtile2 = group(xtile_coverage xtile_usage)// map with new color schemecolorpalette #c8b35a #b0d5df #64acbe #e4acac #ad9ea5 #627f8c #c85a5a #985356 #574249, nograph local colors `r(p)&#39;spmap xtile2 using 省级数据_shp, id(_ID) clm(unique)  fcolor(&quot;`colors&#39;&quot;) ///    ocolor(black ..) osize(0.02 ..) ///     ndfcolor(gs14) ndocolor(gs6 ..) ndsize(0.03 ..) ndlabel(&quot;No data&quot;)   ///    polygon(data(&quot;省级数据_shp&quot;) ocolor(black) osize(0.12) )             ///    legend(off) name(bivar_map2, replace) mosize(vvvthick)// legend with new color schemeclearset obs 9egen y = seq(), b(3)  egen x = seq(), t(3)cap drop spike*gen spike1_x1  = 0.2 in 1gen spike1_x2  = 3.6 in 1 gen spike1_y1  = 0.2 in 1 gen spike1_y2  = 0.2 in 1 gen spike1_m   = &quot;数字普惠广度更强&quot;   gen spike2_y1  = 0.2 in 1gen spike2_y2  = 3.2 in 1 gen spike2_x1  = 0.2 in 1  gen spike2_x2  = 0.2 in 1  gen spike2_m   = &quot;数字普惠深度更强&quot;colorpalette #c8b35a #b0d5df #64acbe #e4acac #ad9ea5 #627f8c #c85a5a #985356 #574249, nographlocal color11 `r(p1)&#39;local color12 `r(p2)&#39;local color13 `r(p3)&#39;local color21 `r(p4)&#39;local color22 `r(p5)&#39;local color23 `r(p6)&#39;local color31 `r(p7)&#39;local color32 `r(p8)&#39;local color33 `r(p9)&#39; levelsof x, local(xlvl) levelsof y, local(ylvl)local boxesforeach x of local xlvl &#123;    foreach y of local ylvl &#123;        local boxes `boxes&#39; (scatter y x if x==`x&#39; &amp; y==`y&#39;, msymbol(square)  ///            msize(5) mc(&quot;`color`x&#39;`y&#39;&#39;&quot;))    &#125;&#125;twoway`boxes&#39; (pcarrow spike1_y1 spike1_x1 spike1_y2 spike1_x2, lw(thin)        ///    lcolor(gs12) mcolor(gs12) mlabel(spike1_m) mlabpos(7) msize(0.8)            ///    headlabel mlabsize(2)) (pcarrow spike2_y1 spike2_x1 spike2_y2 spike2_x2,    ///    lw(thin) lcolor(gs12) mcolor(gs12) mlabel(spike2_m) mlabpos(10) msize(0.8)  ///    headlabel mlabangle(90) mlabgap(1.8) mlabsize(2)), xlabel(0 4, nogrid)      ///    ylabel(0 4, nogrid) aspectratio(1) xsize(1) ysize(1) fxsize(20) fysize(100) ///    legend(off) ytitle(&quot;&quot;) xtitle(&quot;&quot;) xscale(off) yscale(off)                   ///    name(bivar_legend2, replace)// combine the two graphsgraph combine bivar_map2 bivar_legend2, imargin(zero) ///    title(&quot;&#123;fontface Arial Bold:中国数字普惠金融的广度和深度&#125;&quot;, size(4.5)) ///    subtitle(&quot;Colors defined by tercile cut-offs of digital finance extent in pronvinces of China&quot;, size(2.8)) ///    note(&quot;郭峰等. 测度中国数字普惠金融发展: 指数编制与空间特征[J]. 经济学 (季刊), 2020, 19(4): 1401-1418.&quot;,    ///    size(2))</code></pre><p><img src="/images/空间计量二维地图_陈卓然_Fig25.png" alt="img"></p><p> </p><h2 id="空间计量之用-spmap-绘制地图"><a href="#空间计量之用-spmap-绘制地图" class="headerlink" title="空间计量之用 spmap 绘制地图"></a>空间计量之用 spmap 绘制地图</h2><p>在绘制地图时，大家可能会推荐 <strong>ArcGIS</strong> 等专业软件。然而，对于习惯使用 Stata 的用户而言，若数据管理、数据分析、绘图等各方面都能在 Stata 实现，那就太棒了！Stata 的绘图功能日益强大，能满足大多数可视化需求。现在，Stata 能通过外部命令 <code>spmap</code> 绘制出各式各样的地图，如下图所示：</p><p><img src="/images/v2-2d648ddbfdbab0abe4d80bb9b98077cb_1440w.webp" alt="img"></p><p>本文将详细介绍如何使用 <code>spmap</code> 命令绘制各种常用的地图。</p><h2 id="1-命令简介"><a href="#1-命令简介" class="headerlink" title="1. 命令简介"></a>1. 命令简介</h2><p>外部命令 <code>spmap</code> (Pisati, 2007) 的前身为 <code>tmap</code> (Pisati, 2004)。Stata 15 版本的官方命令 <code>grmap</code> 改编自 <code>spmap</code>。相较 <code>spmap</code>， <code>grmap</code> 改动不大，但只用于空间数据 (spset data)。</p><p>由于篇幅有限，本推文只介绍 <code>spmap</code>。由于其命令的选项 (options) 较复杂，我们先熟悉绘制地图的一般步骤；再进一步了解其语法结构。</p><h3 id="1-1-绘制步骤"><a href="#1-1-绘制步骤" class="headerlink" title="1.1 绘制步骤"></a>1.1 绘制步骤</h3><p>参考 <a href="https://zhuanlan.zhihu.com/[https://www.stata.com/support/faqs/graphics/spmap-and-maps/](https://www.stata.com/support/faqs/graphics/spmap-and-maps/">「Stata 官网提供的 FAQ」</a>)，绘制地图的一般步骤如下：</p><h3 id="第一步：下载三个外部命令：spmap-shp2dta-mif2dta"><a href="#第一步：下载三个外部命令：spmap-shp2dta-mif2dta" class="headerlink" title="第一步：下载三个外部命令：spmap | shp2dta | mif2dta"></a>第一步：下载三个外部命令：spmap | shp2dta | mif2dta</h3><pre class=" language-lang-text"><code class="language-lang-text">*-Step 1: Obtain and install the spmap, shp2dta, and mif2dta commands// 画地图的外部命令ssc install spmap, replace // 将外部的 dbf 文件和 shp 文件转化为 dta 文件  ssc install shp2dta, replace  // 将外部的 mif 文件和 mid 文件转化为 dta 文件ssc install mif2dta, replace * 获得帮助文件help spmap help shp2dtahelp mif2dta</code></pre><h3 id="第二步：下载描绘地图的矢量数据文件"><a href="#第二步：下载描绘地图的矢量数据文件" class="headerlink" title="第二步：下载描绘地图的矢量数据文件"></a>第二步：下载描绘地图的矢量数据文件</h3><p>绘制地图时，一般需要两份数据：标签数据 (比如 ID 变量) 和地理坐标数据。对于后者，则有两种常用的矢量数据存储格式： <strong>ESRI shapefile</strong> （简称 shapefile）或 <strong>MapInfo Interchange Format</strong>。具体说明如下：</p><ul><li><a href="https://link.zhihu.com/?target=https%3A//baike.baidu.com/item/shapefile%E6%96%87%E4%BB%B6/11041662%3Ffr%3Daladdin">ESRI shapefile </a>是<a href="https://zhuanlan.zhihu.com/[https://www.esri.com/zh-cn/home](https://www.esri.com/zh-cn/home">美国环境系统研究所公司 (ESRI)</a>) 开发的一种空间数据开放格式，用于存储地理要素的位置、形状和属性。Shapefile 通常有一个 .zip 压缩文件，包含多个文件，其中必须包括以下三个基本文件：</li><li><strong>主文件 (*.shp)：</strong> 存储几何要素的的空间信息，也就是 XY 坐标。</li><li><strong>索引文件 (*.shx)：</strong> 存储有关 <em>.shp 存储的索引信息。它记录了在 </em>.shp 中，空间数据是如何存储的，XY 坐标的输入点在哪里，有多少 XY 坐标对等信息。</li><li><strong>表文件 (*.dbf)：</strong> 存储地理数据的属性信息的 dBase 表。</li></ul><p>用 Stata 绘制地图时，我们只需要 <strong>shape (*.shp)</strong> 和 <strong>dBase (*.dbf)</strong> 两个文件。 <strong>shp2dta</strong> 命令能帮助我们分别将这两个文件转成 Stata 专属的 <strong>.dta</strong> 格式的数据。</p><ul><li><a href="https://link.zhihu.com/?target=https%3A//baike.baidu.com/item/MIF/1416600%3Ffr%3Daladdin">MapInfo Interchange Format </a>是美国公司<a href="https://link.zhihu.com/?target=https%3A//www.pitneybowes.com/us/location-intelligence/geographic-information-systems/mapinfo-pro.html"> MapInfo </a>开发的通用数据交换格式。这种格式是 ASCⅡ 码，可以编辑，易于生成，且可以工作在 MapInfo 支持的所有平台上。它将 MapInfo 数据保存于以下两个文件：</li><li><strong>*.mif 文件：</strong> 存储图形数据，可理解为 XY 坐标。</li><li><strong>*.mid 文件：</strong> 存储文本（属性）数据。</li></ul><p>用 Stata 绘制地图时， <code>mif2dta</code> 命令能帮助我们分别将 <strong>*.mif</strong> 和 <strong>*.mid</strong> 文件转成 Stata 专属的 <strong>.dta</strong> 格式的数据。</p><blockquote><p><strong>Stata 范例：</strong><br>Shapefiles 包含多种类型（比如，Polygon, Point, Polyine。）在绘制地图底图时，推荐使用 <strong>polygon shapefile</strong>。 一般地，ESRI shapefile 比 MapInfo Interchange Format 更易获得。我们可以在搜索引擎上获得 shapefiles。<br>本例子中，我们使用美国地图 shapefile 数据。获得 shapefile 文件步骤如下： </p><ul><li>在 <a href="https://link.zhihu.com/?target=https%3A//www.google.com.hk/">谷歌</a> 或 <a href="https://link.zhihu.com/?target=https%3A//www.google.com.hk/">雅虎</a> 上搜 “United States shapefile” </li><li>在搜索结果中找到 <a href="https://link.zhihu.com/?target=https%3A//www.weather.gov/gis/USStates">https://www.weather.gov/gis/USStates</a> </li><li>下载 <a href="https://link.zhihu.com/?target=https%3A//www.weather.gov/source/gis/Shapefiles/County/s_11au16.zip">s_11au16.zip</a> （注：文件名会随数据的更新而改变。） </li><li>解压文件，我们只需两个文件：<strong>s_11au16.shp</strong> 和 <strong>s_11au16.dbf</strong><br>更详细的操作介绍见下图：</li></ul></blockquote><p><img src="/images/v2-dc5a5cd60e8bd35cf870aeafa13942ee_1440w.webp" alt="img"></p><h3 id="第三步：将地图的矢量数据文件转成-Stata-格式数据文件"><a href="#第三步：将地图的矢量数据文件转成-Stata-格式数据文件" class="headerlink" title="第三步：将地图的矢量数据文件转成 Stata 格式数据文件"></a>第三步：将地图的矢量数据文件转成 Stata 格式数据文件</h3><p>利用命令 <code>shp2dta</code> 或 <code>mif2dta</code> 将地图的矢量数据文件转成 Stata .dta 格式的数据。 检查 .dbf (.mid) 文件经转换后对应的 .dta 数据。该数据为标签数据，包含 <strong>ID</strong> 变量（命名为 id），不同 <strong>id</strong> 对应不同区域划分。我们应该了解地图矢量数据的提供者是如何划分区域的。比如，在一份数据中， id=1 对应 Alaska，id=2 对应 Alabama；而在另一份数据中，id=1 对应 Albania，id=2 对应 Argentina。</p><pre class=" language-lang-text"><code class="language-lang-text">*-Step 3: Translate the files* note:将数据放在当前工作路径shp2dta using s_11au16, database(usdb) coordinates(uscoord) genid(id)</code></pre><blockquote><p>关于代码的一些说明： </p><ul><li><code>database(usdb)</code> 将 database file 转换成 usdb.dta； </li><li><code>coordinates(uscoord)</code> 将 coordinate file 转换成 uscoord.dta； </li><li><code>genid(id)</code> 将 usdb.dta 中的 ID 变量命名为 id;</li><li>转换 MapInfo files 时，语法一致，只需将 shp2dta 换成 mif2dta。 </li><li>转换后的两个 .dta 文件如下：</li></ul></blockquote><p><img src="/images/v2-c649711dd06141c60864052ad6216855_1440w.webp" alt="img"></p><h3 id="第四步：将作图所需数据文件转换成-Stata-格式文件"><a href="#第四步：将作图所需数据文件转换成-Stata-格式文件" class="headerlink" title="第四步：将作图所需数据文件转换成 Stata 格式文件"></a>第四步：将作图所需数据文件转换成 Stata 格式文件</h3><p>具体而言，将我们需要作图的数据（attribute variable，比如，某年的人口数据）转换成 Stata 格式的 .dta 数据。</p><p>在绘制地图时，我们主要是通过标签数据中的 <strong>ID</strong> 变量连接（合并）地图数据和作图数据。我们需要保证不同数据中的 <strong>ID</strong> 变量对应的区域划分是一致的。</p><blockquote><p>本例中，我们作图的数据为美国各州 1990 年的人口数据：<a href="https://link.zhihu.com/?target=https%3A//www.stata.com/support/faqs/graphics/spmap/stats.dta">stats.dta</a>。 由于 stats.dta 中各州的 ID 变量为 <strong>scode</strong> ，与 usdb.dta 中的 ID 变量 <strong>id</strong> 编码不一致，我们生成一个中间文件 <a href="https://link.zhihu.com/?target=https%3A//www.stata.com/support/faqs/graphics/spmap/trans.dta">trans.dta</a>，将 <strong>scode</strong> 与 <strong>id</strong> 对应起来。</p></blockquote><pre class=" language-lang-text"><code class="language-lang-text">*-Step 4: Determine the coding used by the map* note:将数据放在当前工作路径use stats, clearmerge 1:1 scode using trans    Result                           # of obs.    -----------------------------------------    not matched                             0    matched                                51  (_merge==3)    -----------------------------------------drop _merge*仔细检查合并的结果，确认无误后可删掉 _merge*- _merge 变量的含义：* _merge==1 obs. from master data* _merge==2 obs. from only one using dataset* _merge==3 obs. from at least two datasets, master or using</code></pre><h3 id="第五步：数据合并"><a href="#第五步：数据合并" class="headerlink" title="第五步：数据合并"></a>第五步：数据合并</h3><p>将 .dbf (.mid) 文件经转换后对应的 .dta 数据与我们需要作图的 .dta 数据进行合并。</p><pre class=" language-lang-text"><code class="language-lang-text">*-Step 5: Merge datasets* note:将数据放在当前工作路径merge 1:1 id using usdb    Result                           # of obs.    -----------------------------------------    not matched                             6        from master                         0  (_merge==1)        from using                          6  (_merge==2)    matched                                51  (_merge==3)    -----------------------------------------drop if _merge!=3(6 observations deleted)drop _merge*仔细检查合并的结果，确定无误后可删掉多余观测值 ```</code></pre><h4 id="第六步：用-spmap-命令绘图"><a href="#第六步：用-spmap-命令绘图" class="headerlink" title="第六步：用 spmap 命令绘图"></a>第六步：用 spmap 命令绘图</h4><p> 最后一步啦！可以用 <code>spmap</code> 命令进行画图！show your data!</p><pre class=" language-lang-stata"><code class="language-lang-stata">*-Step 6: Draw the graph* 图1：不完美示范spmap pop1990 using uscoord, id(id) fcolor(Blues)* 图2：进一步美化replace pop1990 = pop1990/1e+6* 改变单位，避免图例里显示的数字过大format pop1990 %4.2f* 变量数据格式（整数与小数部分长度）spmap pop1990 using uscoord ///if id !=1  & id !=54 & ///    id !=39 & id !=56, ///id(id) fcolor(Blues)</code></pre><blockquote><p>关于代码的一些说明：</p><ul><li><strong>pop1990</strong> 是我们作图的数据（1990 年美国各州人口数据）。</li><li><strong>using uscoord</strong> 是必填项。绘制地图地图时，必需坐标数据（本例子中坐标数据为 uscoord.dta）。 - <strong>id(id)</strong> 是必填项。 绘制地图地图时，必需不同区域划分的 ID 变量（本例子中命名为 id）。 </li><li><strong>fcolor(Blues)</strong> 是可选项，设置专题地图 (Choropleth map) 的填充颜色。本例中选用 Blues 主题，即以蓝色为主题色，不同区域会根据作图数据（本例中为人口数据）大小填充深浅不同的颜色。</li><li><strong>clnumber(#)</strong> 是可选项，设置分组数。<code>spmap</code> 默认基于分位数，将作图数据（本例中为人口数据）分为四组；若要自定义组数，则可加上该选项。 </li><li><strong>if</strong> 命令的使用：本例中使用 <code>if</code> 去掉四个州，是因为这四个州分布过于分散，画出的图不美观。 </li><li>两幅图的对比如下：</li></ul></blockquote><p><img src="/images/v2-bf1262dc5d930070fa324336f813fabf_1440w.webp" alt="img"></p><h3 id="1-2-命令的语法"><a href="#1-2-命令的语法" class="headerlink" title="1.2 命令的语法"></a>1.2 命令的语法</h3><p>该命令的基本语法如下：</p><pre class=" language-lang-text"><code class="language-lang-text">spmap [attribute] [if] [in] using basemap [,            basemap_options            polygon(polygon_suboptions)            line(line_suboptions)            point(point_suboptions)            diagram(diagram_suboptions)            arrow(arrow_suboptions)            label(label_suboptions)            scalebar(scalebar_suboptions)            graph_options]</code></pre><p>主要可选项说明如下：</p><ul><li><code>basemap_options</code> 设置地图底图。</li><li>其中最重要的选项为 id(idvar)。该选项必须加上，用来识别不同区域划分的 ID 变量 idvar。</li><li>其他选项用来控制底图的四个方面： Cartogram（比如背景色）, Choropleth map（比如将作图数据分为几组）, Format（比如填充颜色）, Legend（比如是否显示图例）。</li><li><code>polygon(polygon_suboptions)</code> 在底图基础上添加其他多边形。</li><li><code>line(line_suboptions)</code> 在底图基础上添加线条。</li><li><code>point(point_suboptions)</code> 在底图基础上添加点。</li><li><code>diagram(diagram_suboptions)</code> 在底图基础上添加条形/扇形统计图。</li><li><code>arrow(arrow_suboptions)</code> 在底图基础上添加箭头。</li><li><code>label(label_suboptions)</code> 在底图基础上添加文字标签。</li><li><code>scalebar(scalebar_suboptions)</code> 设置比例尺。</li><li><code>graph_options</code> 与我们常规画图的选项 (<code>twoway_options</code>) 基本一致。</li><li><code>help spmap</code> 获得更多详细信息。</li></ul><h2 id="2-Stata-范例"><a href="#2-Stata-范例" class="headerlink" title="2. Stata 范例"></a>2. Stata 范例</h2><p>目前，我们已经熟悉了绘制地图的一般步骤和语法结构。接下来我们将结合具体的例子进一步掌握 <code>spmap</code> 的使用方法。本节 2.2-2.4 的例子均来自 <code>help spmap</code> 帮助文件。官方提供的数据集可通过下述方式获得： <code>net get spmap.pkg, from(http://fmwww.bc.edu/RePEc/bocode/s)</code></p><h3 id="2-1-如何获得地图的矢量数据文件？"><a href="#2-1-如何获得地图的矢量数据文件？" class="headerlink" title="2.1 如何获得地图的矢量数据文件？"></a>2.1 如何获得地图的矢量数据文件？</h3><p>用 Stata 绘制地图至少需要两份数据：带有标签 (比如 ID 变量) 的数据和地理坐标数据。在 <code>spmap</code> 中，标签数据被称为 “master” dataset，地理坐标数据被称为 “basemap” dataset。</p><p>因此，我们绘图前必须先下载地图的矢量数据文件。若能直接下载 .dta 格式文件，则无需转换格式；若只能下载 <strong>shapefile</strong> （或 <strong>MapInfo Interchange Format</strong>） 格式的文件，则需用 <code>shp2dta</code> （或 <code>mif2dta</code> ）将其转成 .dta 格式。</p><blockquote><p>获得途径总结如下：</p><ul><li>在搜索引擎上搜索关键词，比如 “中国地图 shapefile”。</li><li>在 <a href="https://link.zhihu.com/?target=https%3A//gadm.org/data.html">GADM</a> 网站上下载 shapefile 文件。该网站提供世界及世界各国的地图数据。 </li><li>利用 Stata 命令，如下：</li></ul></blockquote><pre class=" language-lang-text"><code class="language-lang-text">*-获得中国地图数据copy "http://fmwww.bc.edu/repec/bocode/c/china_map.zip" china_map.zip, replaceunzipfile china_map, replace  // 解压压缩文件*-获得世界地图数据use  "http://fmwww.bc.edu/repec/bocode/w/world-c.dta",clearsave world-c.dtause  "http://fmwww.bc.edu/repec/bocode/w/world-d.dta",clear   save world-d.dta</code></pre><p>获得数据后，我们可利用 <code>scatter</code> 检查数据，看地图轮廓是否满足要求。</p><pre class=" language-lang-text"><code class="language-lang-text">use "china_map.dta", clearscatter _Y _X, msize(vtiny)</code></pre><p><img src="/images/v2-7c1f63e697c63c0424782d58305932d0_1440w.webp" alt="img"></p><h3 id="2-2-Stata-范例-1-Choropleth-maps"><a href="#2-2-Stata-范例-1-Choropleth-maps" class="headerlink" title="2.2 Stata 范例 1: Choropleth maps"></a>2.2 Stata 范例 1: Choropleth maps</h3><p>Choropleth map 可翻译为 <strong><a href="https://link.zhihu.com/?target=http%3A//antv.alipay.com/zh-cn/vis/chart/choropleth-map.html">分级统计地图</a></strong>。在这种地图中，每个区域以不同深浅度的颜色表示数据变量。此法因常用色级表示，所以也叫色级统计图法。我们可简单理解为 “<strong>地图+热力：颜色渐变常见</strong>“。</p><pre class=" language-lang-text"><code class="language-lang-text">use "Italy-RegionsData.dta", clear#d ;spmap relig1 using "Italy-RegionsCoordinates.dta", id(id)           title("Pct. Catholics without reservations", size(*0.8))        subtitle("Italy, 1994-98" " ", size(*0.8));  #d cr</code></pre><p><img src="/images/v2-e7ec19cdbf5e20ad37408becd9a6bd53_1440w.jpeg" alt="img"></p><pre class=" language-lang-text"><code class="language-lang-text">use "Italy-RegionsData.dta", clear#d ;spmap relig1m using "Italy-RegionsCoordinates.dta", id(id)    ndfcolor(red)           clmethod(eqint) clnumber(5) eirange(20 70)                        title("Pct. Catholics without reservations", size(*0.8))           subtitle("Italy, 1994-98" " ", size(*0.8))                         legstyle(2) legend(region(lcolor(black)));                        #d cr</code></pre><p><img src="/images/v2-0b23a37eee09404a4642571a365cbbbb_1440w.jpeg" alt="img"></p><pre class=" language-lang-text"><code class="language-lang-text">use "Italy-RegionsData.dta", clear#d ;spmap relig1 using "Italy-RegionsCoordinates.dta", id(id)           clnumber(20) fcolor(Reds2) ocolor(none ..)                         title("Pct. Catholics without reservations", size(*0.8))           subtitle("Italy, 1994-98" " ", size(*0.8))                         legstyle(3) legend(ring(1) position(3));   #d cr</code></pre><p><img src="/images/v2-3b235a0ac24b6895928b0dab80cab0d8_1440w.jpeg" alt="img"></p><pre class=" language-lang-text"><code class="language-lang-text">use "Italy-RegionsData.dta", clear#d ;spmap relig1 using "Italy-RegionsCoordinates.dta", id(id)          clnumber(20) fcolor(Greens2) ocolor(white ..) osize(thin ..)     title("Pct. Catholics without reservations", size(*0.8))         subtitle("Italy, 1994-98" " ", size(*0.8))                       legstyle(3) legend(ring(1) position(3))                         plotregion(icolor(stone)) graphregion(icolor(stone))             polygon(data("Italy-Highlights.dta") ocolor(white)               osize(medthick))scalebar(units(500) scale(1/1000) xpos(-100) label(Kilometers));#d cr</code></pre><p><img src="/images/v2-3f7dce5ebf796c53fead779c2f237016_1440w.jpeg" alt="img"></p><blockquote><p>关于代码的一些说明：</p></blockquote><ul><li>官方直接提供了 dta 文件，所以我们在绘制地图时省略 <code>shp2dta</code> 或 <code>mif2dta</code> 转换地图矢量数据文件的步骤。</li><li><code>ndfcolor(red)</code> 用红色表示缺失数据区域。</li><li><code>clmethod(...)</code> 设置作图数据分组方式，默认是根据分位数分为 4 组。</li><li>括号里可选填 quantile, boxplot, eqint, stdev, kmeans, custom, unique。</li><li><code>clmethod(eqint) clnumber(5) eirange(20 70)</code>：将作图数据按 20-70 范围等分为 5 组。</li><li><code>clunmber(#)</code> 设置分组数。</li><li><code>legstyle(#)</code> 设置图例显示模式，默认为 1，可选 2,3。</li><li>1 显示为 (num,num]；2 显示为 num-num；3 为色卡。</li><li><code>legend(...)</code> 设置图例是否带框线、摆放位置等。</li><li><code>fcolor(...)</code> 设置填充颜色。</li><li><code>icolor(...)</code> 设置背景色。</li><li><code>ocolor(...)</code> 设置区域边界颜色。</li><li><code>osize(...)</code> 设置区域边界线宽度。</li><li><code>polygon(...)</code> 在底图 (basemap) 上添加其他多边形。</li><li><code>scalebar(...)</code> 设置比例尺。</li></ul><h3 id="2-3-Stata-范例-2-Proportional-symbol-maps"><a href="#2-3-Stata-范例-2-Proportional-symbol-maps" class="headerlink" title="2.3 Stata 范例 2: Proportional symbol maps"></a>2.3 Stata 范例 2: Proportional symbol maps</h3><p>Proportional symbol map 可理解为 <strong><a href="https://link.zhihu.com/?target=http%3A//antv.alipay.com/zh-cn/vis/chart/bubble-map.html">带气泡的地图 (Bubble Map)</a></strong>。在这种地图中，气泡的面积代表了这个数据的大小。我们可简单理解为 “<strong>地图+气泡：圆越大数越大</strong>“。</p><p>我们可以通过添加选项 <code>point(... proportional(propvar_pn) ...)</code> 完成带气泡的地图。若我们想将气泡（圆）变成其他符号（比如为正方形），可在里面添加子选项 <code>shape(s)</code>。</p><p>若在该选项中去掉子选项 <code>proportional(propvar_pn)</code>，则该图可退化为 <strong><a href="https://link.zhihu.com/?target=http%3A//antv.alipay.com/zh-cn/vis/chart/dot-map.html">点描法地图 (dot map)</a></strong>，即气泡变为大小相等的点。我们可简单理解为 “<strong>地图+点：哪里有数点哪里</strong>“。</p><pre class=" language-lang-text"><code class="language-lang-text">use "Italy-OutlineData.dta", clear#d;spmap using "Italy-OutlineCoordinates.dta", id(id)                 title("Pct. Catholics without reservations", size(*0.8))        subtitle("Italy, 1994-98" " ", size(*0.8))                      point(data("Italy-RegionsData.dta") xcoord(xcoord)              ycoord(ycoord) deviation(relig1) fcolor(red) dmax(30)            legenda(on) leglabel(Deviation from the mean));#d cr</code></pre><p><img src="/images/v2-4c88e9c667f3bea2ad838959e1ef6ddf_1440w.jpeg" alt="img"></p><pre class=" language-lang-text"><code class="language-lang-text">use "Italy-OutlineData.dta", clear#d;spmap using "Italy-OutlineCoordinates.dta", id(id)                 title("Pct. Catholics without reservations", size(*0.8))         subtitle("Italy, 1994-98" " ", size(*0.8))                       point(data("Italy-RegionsData.dta") xcoord(xcoord)               ycoord(ycoord) proportional(relig1) fcolor(green)                  ocolor(white) size(*3))                                          label(data("Italy-RegionsData.dta") xcoord(xcoord)               ycoord(ycoord) label(relig1) color(white) size(*0.7));#d cr</code></pre><p><img src="/images/v2-5fe273f65dffdf8b00b90dfe8e99ab33_1440w.webp" alt="img"></p><blockquote><p>关于代码的一些说明： </p><ul><li>point(…)<code>在底图 (basemap) 上添加点。</code></li><li><code>label(...)</code> 在底图 (basemap) 上添加标签（比如地名，数字等）。</li></ul></blockquote><h3 id="2-4-Stata-范例-3-Other-maps"><a href="#2-4-Stata-范例-3-Other-maps" class="headerlink" title="2.4 Stata 范例 3: Other maps"></a>2.4 Stata 范例 3: Other maps</h3><p>我们还可以通过 <code>spmap</code> 画其他类型的图，比如在地图上添加条形图/扇形图。</p><pre class=" language-lang-text"><code class="language-lang-text">use "Italy-RegionsData.dta", clear#d ;spmap using "Italy-RegionsCoordinates.dta", id(id) fcolor(stone)     title("Pct. Catholics without reservations", size(*0.8))          subtitle("Italy, 1994-98" " ", size(*0.8))                         diagram(variable(relig1) range(0 100) refweight(pop98)            xcoord(xcoord) ycoord(ycoord) fcolor(red));#d cr</code></pre><p><img src="/images/v2-02b95e1b2abd8f8cf90ba0ebe445994f_1440w.webp" alt="img"></p><pre class=" language-lang-text"><code class="language-lang-text">use "Italy-RegionsData.dta", clear#d ;spmap using "Italy-RegionsCoordinates.dta", id(id) fcolor(stone)   diagram(variable(relig1 relig2 relig3) proportional(fortell)    xcoord(xcoord) ycoord(ycoord) legenda(on))                       legend(title("Religious orientation", size(*0.5) bexpand        justification(left)))                                            note(" "                                                         "NOTE: Chart size proportional to number of fortune tellers per million population", size(*0.75));#d cr</code></pre><p><img src="/images/v2-3732194c243e8689ee5bc1ec9a8f7d32_1440w.webp" alt="img"></p><pre class=" language-lang-text"><code class="language-lang-text">use "Italy-OutlineData.dta", clear#d ;spmap using "Italy-OutlineCoordinates.dta", id(id) fc(bluishgray)    ocolor(none)                                                       title("Provincial capitals" " ", size(*0.9) color(white))          point(data("Italy-Capitals.dta") xcoord(xcoord)                    ycoord(ycoord) by(size) fcolor(orange red maroon) shape(s ..)      legenda(on))                                                       legend(title("Population 1998", size(*0.5) bexpand                 justification(left)) region(lcolor(black) fcolor(white))           position(2))                                                       plotregion(margin(medium) icolor(dknavy) color(dknavy))            graphregion(icolor(dknavy) color(dknavy));#d cr</code></pre><p><img src="/images/v2-75d2610cb2232ea62ccf01fbc2316df7_1440w.jpeg" alt="img"></p><pre class=" language-lang-text"><code class="language-lang-text">use "Italy-RegionsData.dta", clear#d ;spmap relig1 using "Italy-RegionsCoordinates.dta" if zone==1,        id(id) fcolor(Blues2) ocolor(white ..) osize(medthin ..)           title("Pct. Catholics without reservations", size(*0.8))           subtitle("Northern Italy, 1994-98" " ", size(*0.8))                polygon(data("Italy-OutlineCoordinates.dta") fcolor(gs12)          ocolor(white) osize(medthin)) polyfirst;#d cr</code></pre><p><img src="/images/v2-e506f7bdbf1d41237d5a45f4c0028225_1440w.jpeg" alt="img"></p><pre class=" language-lang-text"><code class="language-lang-text">use "Italy-OutlineData.dta", clear#d ;spmap using "Italy-OutlineCoordinates.dta", id(id) fc(sand)        title("Main lakes and rivers" " ", size(*0.9))                   polygon(data("Italy-Lakes.dta") fcolor(blue) ocolor(blue))       line(data("Italy-Rivers.dta") color(blue) )                      freestyle aspect(1.4) xlab(400000 900000 1400000, grid);#d cr</code></pre><p><img src="/images/v2-6067fe901b11b4aea9e39ffcec1866a5_1440w.webp" alt="img"></p><blockquote><p>关于代码的一些说明： </p><ul><li><code>polygon(...)</code> 在底图 (basemap) 上添加其他多边形。 </li><li><code>point(...)</code> 在底图 (basemap) 上添加点。 </li><li><code>line(...)</code> 在底图 (basemap) 上添加线条。 </li><li>绘制比较复杂的地图时，常用上述三个命令在底图 (basemap) 上叠加图层。</li></ul></blockquote><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>用 Stata 绘制地图有两个关键点：一是获得地图的矢量数据文件，熟悉数据结构；二是熟悉命令 <code>spmap</code> 的语法结构。</p><h1 id="基于Stata绘制2022年中国34个省域GDP空间分位图的演示"><a href="#基于Stata绘制2022年中国34个省域GDP空间分位图的演示" class="headerlink" title="基于Stata绘制2022年中国34个省域GDP空间分位图的演示"></a>基于Stata绘制2022年中国34个省域GDP空间分位图的演示</h1><p>一、引言</p><p>可以绘制地图的软件除了ArcGIS以外，Stata、SAS等软件也可以。因为ASEF主要基于ArcGIS和Stata做相关研究，所以在特定环境下它更倾向于采用Stata绘制地图。Stata绘制地图的命令有官方命令grmap、非官方命令spmap等。关于spmap命令的演示，ASEF之前做过推文(<a href="https://mp.weixin.qq.com/s?__biz=Mzg2NDE3OTkxMQ==&amp;mid=2247484542&amp;idx=1&amp;sn=9c732145a85e518f530478bc67a79290&amp;chksm=ce6c07d6f91b8ec0b948415649b736eba6621de5f1b893e50bb7e659dbde8cd91bc6b24cbc2d&amp;token=726204196&amp;lang=zh_CN&amp;scene=21#wechat_redirect">基于Stata的ESDA（探索性空间数据分析）代码解析与实操验证</a>)，不再赘述。今天与大家一起学习，如何采用grmap命令绘制规范的中国标准地图。</p><p>二、演示</p><p>下面采用2022年中国34个省域的GDP数据进行空间分位图绘制演示。本演示共有四部分组成：（1）制作填色地图标签文件；（2）制作填色地图的值（本案例中为2022年中国34个省域的GDP）文件；（3）制作指北针文件；（4）绘制2022年中国34个省域GDP空间分位图。</p><p>第一部分为制作填色地图标签文件，程序如下：</p><pre class=" language-lang-stata"><code class="language-lang-stata">clearinput Y X strL cname strL ename2070000 155000 1000km 1000km2200000 2480000 南海诸岛 "South China Sea"2545645 577264 海南 HAINAN2606862 -596605 N N2793167 904743 澳门 MACAO SAR2924472 1216567 香港 HONG KONG SAR3033598 454021 广西 GUANGXI ZHUANGZU ZIZHIQU3117659 901401 广东 GUANGDONG3147149 -364398 云南 YUNAN3171792 1723148 台湾 TAIWAN3337393 223839 贵州 GUIZHOU3359174 1310984 福建 FUJIAN3448290 704352 湖南 HUNAN3492625 1055225 江西 JIANGXI3716572 273824 重庆 CHONGQING SHI3753226 1458284 浙江 ZHEJIANG3773471 -212006 四川 SICHUAN3846593 688818 湖北 HUBEI3994884 1142714 安徽 ANHUI3997977 1543993 上海 SHANGHAI SHI4038557 -1532343 西藏 XIZANG ZIZHIQU4156136 1325927 江苏 JIANGSU4174676 780159 河南 HENAN4179103 341037 陕西 SHAANXI4264787 -22066 甘肃 GANSU4381696 -792836 青海 QINGHAI4495014 1142137 山东 SHANDONG4501152 99684 宁夏 NINGXIA HUIZU ZIZHIQU4559114 621816 山西 SHANXI4656767 917719 河北 HEBEI4800073 1154470 天津 TIANJIN SHI4936223 425619 内蒙古 "NEI MOGOL ZIZHIQU"4981659 934732 北京 BEIJING SHI5093605 1407783 辽宁 LIAONING5113455 -1609429 新疆 XINJIANG ZIZHIQU5409037 1625827 吉林 JILIN5866667 1623938 黑龙江 HEILONGJIANGendcompresssave 填色地图_标签, replace</code></pre><p>第二部分为制作填色地图的值文件，程序如下：</p><pre class=" language-lang-stata"><code class="language-lang-stata">clearinput 省代码 strL 省 ID GDP110000 北京 1 4.16120000 天津 2 1.63130000 河北 3 4.24140000 山西 4 2.56150000 内蒙古 5 2.32210000 辽宁 6 2.9220000 吉林 8 1.31230000 黑龙江 9 1.59310000 上海 10 4.47320000 江苏 11 12.29330000 浙江 12 7.77340000 安徽 13 4.5350000 福建 14 5.31360000 江西 15 3.21370000 山东 16 8.74410000 河南 17 6.13420000 湖北 18 5.37430000 湖南 19 4.87440000 广东 20 12.91450000 广西 21 2.63460000 海南 22 0.68500000 重庆市 23 2.91510000 四川 24 5.67520000 贵州 25 2.02530000 云南 26 2.9540000 西藏 27 0.21610000 陕西 28 3.28620000 甘肃 29 1.12630000 青海 30 0.36640000 宁夏 31 0.51650000 新疆 32 1.77710000 台湾 33 5.13810000 香港 34 2.77820000 澳门 35 0.22end compresssave 填色地图_值, replace</code></pre><p>第三部分为制作指北针文件，程序如下：</p><pre><code>clearinput _ID _X _Y value38 . . 138 -600000 2200000 138 -600000 2500000 138 -500000 2160000 138 -600000 2200000 139 . . 139 -850000 2000000 139 -850000 2080000 139 -600000 2080000 139 -600000 2000000 139 -850000 2000000 139 . . 139 -350000 2000000 139 -350000 2080000 139 -100000 2080000 139 -100000 2000000 139 -350000 2000000 1endsave 填色地图_指北针, replace</code></pre><p>第四部分为绘制2022年中国34个省域GDP空间分位图，程序如下：</p><pre class=" language-lang-stata"><code class="language-lang-stata">use 填色地图_值, cleargrmap GDP using chinaprov40_coord, id(ID) osize(vvthin ...) ocolor(white ...) clmethod(custom) clbreaks(-1 0 0.5 2 3 8 13) \\\fcolor(gray "254 237 222" "253 190 133" "253 141 60" "230 85 13" "166 54 3") \\\leg(order(2 "No Data" 3 "< 0.5" 4 "0.5～2" 5 "2～3" 6 "3～8" 7 "> 8")) \\\graphr(margin(medium)) \\\line(data(chinaprov40_line_coord.dta) select(keep if inlist(group, 1, 2, 3, 4, 5, 6)) by(group) size(vvthin *1 *0.5 *1.2 *0.5 *0.5) pattern(solid ...) color(white black "0 85 170" "24 188 156" black black)) \\\polygon(data(填色地图_指北针) fcolor(black) osize(vvthin)) \\\label(data(填色地图_标签) x(X) y(Y) label(cname) length(20) size(*0.6)) \\\ti("2022年中国34个省域GDP空间分位图")gr export 填色地图_输出.png, replace width(1200)</code></pre><p>成图见图1。图1显示，2022年，广东、江苏、山东的GDP均居于全国前三名。</p><p><img src="/images/640-167818814734983.png" alt="图片"></p><p>图1</p>]]></content>
      
      
      <categories>
          
          <category> 实证 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Stata </tag>
            
            <tag> 画图 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>STATA常用命令汇集</title>
      <link href="/2023/02/17/stata-chang-yong-ming-ling-hui-ji/"/>
      <url>/2023/02/17/stata-chang-yong-ming-ling-hui-ji/</url>
      
        <content type="html"><![CDATA[<h4 id="均值t检验"><a href="#均值t检验" class="headerlink" title="均值t检验"></a>均值t检验</h4><p>ttest：即 t tests (mean-comparison tests)，简单来说，在t检验的假设都满足的前提下，如满足正态分布，如同方差假定，比较不同的数据的均值，以判断数据之间是否存在差异。</p><p>常用<strong>两样本t检验</strong>：<strong>命令：ttest varname,by(groupvar)</strong>，即检验<strong>不同分组</strong>下，观察值的均值是否存在显著差异。若无同方差假定，或数据本身不同方差，则要加上unequal 选项。</p><p><img src="/images/a2cc7cd98d1001e98e50e2c2876ab9ea55e7977e.png" alt=""></p><p>至于上面t检验怎么看，主要是看p值，若p值较小，则拒绝原假设，差异是显著的；若p值较大，则接受原假设，差异并不显著。</p><p>结果导出：</p><p>esttab</p><p>参考：</p><p>1、<a href="https://www.bilibili.com/read/cv15830360">用好 esttab，导遍表格都不怕</a></p><p>2、<a href="https://www.bilibili.com/read/cv16075082">用好esttab，导遍表格都不怕[进阶操作]</a></p><p>3、<a href="https://cloud.tencent.com/developer/article/1820267">Stata 回归表格输出之 esttab 详解</a></p><p><code>logout2</code></p><p>基本使用形式：</p><pre class=" language-lang-stata"><code class="language-lang-stata">logout2 [m1 m2 m3] using filename , word/excel replace +[other options]</code></pre><pre class=" language-lang-stata"><code class="language-lang-stata">sysuse nlsw88,clear tab race,gen(d_race) drop d_race1tab occu,gen(d_occu) drop d_occu1         //分别生产人种、职业虚拟变量reg wage hours ttl_exp married  est sto m1 reg wage hours ttl_exp married d_race*   est sto m2 reg wage hours ttl_exp married d_race* d_occu*  est sto m3 outreg2 [m1 m2 m3] using out1,replace excel      ///  drop(d_occu*) sortvar(married hours)           ///  tdec(2) rdec(3) adjr2 e(F) tstat               ///  nonote                                         ///  addnote("注：（1）。。。                        ///                         （2）。。。"）</code></pre><p>述命令中，excel表示输出excel文件，drop(d_occu*)表示不再表中展示职业虚拟变量的回归结果（太多了），sortvar可以调整回归表中变量的顺序，tdec、rdec分别表示设定t统计量与R2 保留的小数位数，adjr2,e(F)分别表示表中展示调整后的R2 、F统计量，tstat表示估计系数下方展示 t 统计量，相应的若改为pvalue可以呈现显著性水平；nonote表示不展示默认的英文注释，addnote可以自己加入自己的回归结果注释。</p><p>同时，outreg2还可以通过append选项继续追加回归结果。<br>下面将logit回归结果加入上文out1估计结果中：</p><pre class=" language-lang-stata"><code class="language-lang-stata">logit union wage married wage d_race* d_occu* est sto logit outreg2 [logit] using out1,excel append</code></pre><p>相关系数</p><ul><li>皮尔逊相关系数：<code>corr x y z</code>（从整体上计算）；<code>pwcorr x y z</code>（两两计算）</li><li>斯皮尔曼相关系数：<code>spearman x y z</code>（从整体上计算）；<code>spearman x y z, pw</code>（两两计算）</li></ul><p>Pearson 相关系数</p><pre class=" language-lang-stata"><code class="language-lang-stata">corr price weight length mpgpwcorr var1 var2pwcorr price weight length mpg,sigpwcorr price weight length mpg,star(0.01)* pwcorr 的缺陷在于，默认保留小数点后四位小数，且无法调整，不符合一般期刊的格式要求</code></pre><p>Spearman 相关系数</p><pre class=" language-lang-stata"><code class="language-lang-stata">sysuse auto,clearspearman mpg rep78//Two variables; output displayed in tabular form by defaultspearman mpg rep78, matrix//Two variables; output displayed in matrix formspearman mpg price rep78, pw//Use all nonmissing observations between a pair of variablesspearman mpg price rep78, pw star(0.05)// Star all correlation coefficients significant at the 5% level or lower</code></pre><p> Pearson &amp;Spearman 系数合并显示</p><pre><code>corsp mpg price rep78,format(%7.3f)corsp mpg price rep78</code></pre><blockquote><p>Pearson &amp;Spearman 系数的区别<br>如果变量同时满足以下三个条件，Pearson &amp;Spearman 系数都可以使用，此时使用Pearson 系数更好<br>①连续变量<br>②正态分布<br>③ 线性关系<br>以上任意一个条件不满足，只能使用spearman 相关系数，不能用 Pearson 相关系数.</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 计量 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Stata </tag>
            
            <tag> 实证 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>重要资料汇集（定期整理）</title>
      <link href="/2023/02/16/chong-yao-zi-liao-hui-ji-ding-qi-zheng-li/"/>
      <url>/2023/02/16/chong-yao-zi-liao-hui-ji-ding-qi-zheng-li/</url>
      
        <content type="html"><![CDATA[<h4 id="John-Rogers"><a href="#John-Rogers" class="headerlink" title="John Rogers"></a>John Rogers</h4><ul><li><p>讲义1：<a href="/images/Presentations-Inflation Shocks and Asset Prices Around the World.pdf">Inflation Shocks and Asset Prices Around the World</a>（June 2022）</p><ul><li>Three Topics：The Outlook and the Fed</li><li>U.S. Inflation Expectations<ul><li>measurement：<strong>Survey-based</strong>（<a href="https://www.newyorkfed.org/microeconomics/sce#/">Survey of Consumer Expectations (New York Fed)</a>，<a href="http://www.sca.isr.umich.edu/">University of Michigan Survey of Consumers</a>，<a href="https://www.philadelphiafed.org/surveys-and-data/real-time-data-research/survey-of-professional-forecasters#:~:text=The%20Survey%20of%20Professional%20Forecasters%20is%20the%20oldest,of%20Philadelphia%20took%20over%20the%20survey%20in%201990.">Survey of Professional Forecasters (Philadelphia Fed)</a>）， <strong>Model-based</strong>（ <a href="https://www.clevelandfed.org/indicators-and-data/inflation-expectations">Cleveland Fed</a>），<strong>Market-based</strong>（Nominal minus real (TIPS) Treasury yields，breakeven inflation rate，<strong><a href="https://fred.stlouisfed.org/series/T10YIE">10-Year Breakeven Inflation Rate</a></strong>，<strong><a href="https://fred.stlouisfed.org/series/T5YIE/">5-Year Breakeven Inflation Rate</a></strong>）</li></ul></li><li>Global stock markets<ul><li>Stock price reflects present discounted value of future corp. earnings.</li><li>Expected higher interest rates reduce the pdv of earnings, all else constant, and lower stock price today</li></ul></li></ul></li><li><p>讲义2：<a href="\images\Presentations -U.S. Monetary Policy and the World Capital Market.pdf">U.S. Monetary Policy and the World Capital Market</a>（Sept 2022）</p><ul><li><p>Four Central Banks：Fed, ECB, BOE, and BOJ</p></li><li><p>Four Topics：Mandates and Methods of Policy Implementation，The Outlook，Recent Monetary Policy Actions，Exchange Rates</p><ul><li>What should the Fed set the FFR at now?-Taylor Rule</li><li>ECB:“MBM” operating framework</li><li>UK：Bank Rate</li></ul></li><li><p>Four Exchange Rates</p><ul><li><p>Theory</p><ul><li><strong>difference in interest rates between countries.</strong> Tighter monetary policy at home raises real interest rates and appreciates home currency</li><li>difference in <strong>real economic activity</strong> (like GDP) between countries. Greater activity at home increases demand for currency and appreciates home currency</li></ul></li><li><p>Seems like ‘yes’ for currencies and ‘no’ for stocks: if U.S. data releases are better (worse) than expected, belief the Fed will (will not) continue to raise interest rates. Thus, good news helps rally stocks but hurts the USD.</p></li><li><p><a href="https://corporatefinanceinstitute.com/resources/economics/fed-put/">Fed put</a>：The “Fed Put” is a commonly used term in financial markets to describe the belief that many market practitioners hold that the U.S. Federal Reserve (the Fed) will step in with accommodative <a href="https://corporatefinanceinstitute.com/resources/knowledge/economics/monetary-policy/">monetary policy</a> to buoy markets, specifically the U.S. equity market, if prices fall too fast too quickly.</p></li></ul></li></ul></li></ul><h4 id="余永定"><a href="#余永定" class="headerlink" title="余永定"></a>余永定</h4><p>书籍：</p><p>《<a href="https://weread.qq.com/web/reader/2ea32810726c89ec2ea83ddk16732dc0161679091c5aeb1">太阳之下无新事</a>》：本书梳理了作者回国后撰写的有关中国宏观经济形势和宏观经济政策的主要文章。主要包括两个方面：一是对中国宏观经济中、短期变化趋势的判断；二是对中国宏观经济的一些争议问题的理论探讨。</p><p>《<a href="https://www.aliyundrive.com/s/2utPHQ2PhR4">见证失衡：:双顺差、人民币汇率和美元陷阱</a>》：作为有影响力的经济学家，作者十多年来一直呼吁遏制中国经济的双顺差，理顺中国经济与世界经济的关系，但却并不如愿。今日中美经济关系的严重扭曲，使我们有必要重新审视作者当年的忧虑。《见证失衡:双顺差、人民币汇率和美元陷阱》遴选其三十多篇代表作品，以年代为序，试图表现作者一脉相承的见解，同时也表达了一个经济学家敢于反思研究历程并接受历史检验的勇气。</p><p>演讲：</p><p><a href="https://www.bilibili.com/video/BV1oP4y1T7e9/?spm_id_from=333.337.search-card.all.click">余永定：2022年中国宏观经济政策</a>    </p><p><a href="/images/余永定_2022年中国宏观经济政策_汇丰商学院演讲.pdf">PPT</a>    <a href="/images/余永定_2022年经济增长前景和宏观经济政策选择.pdf">工作论文版本</a>  <a href="https://www.163.com/dy/article/H1NOFTD3052100BV.html">媒体版本</a></p><p>注：可以学习一下这个分析问题的思路（深度）</p><p><strong>1.GDP增速。针对2022年GDP增长目标5.5%，从消费、净出口、投资三方面进行拆解（有一定的数据假设）。针对投资，又可以拆解为房地产、制造业、基建，基建进一步细分为12个子行业。</strong></p><p><strong>2.基建投资。增速低迷的原因：地方政府积极性、融资成本和融资量成正比的怪现象。调整：扩张性财政政策、放宽货币政策</strong></p><p><strong>3.金融风险与稳增长之间的平衡，向稳增长倾斜。</strong></p><p><strong>4.财政政策。财政政策的扩张与否不能直接看G-T，要看一般公共预算对经济的刺激作用（扣除资金跨时跨账户的转移支付）。中国公共预算：一般公共预算+政府性基金+国有资本经营+社会保险</strong></p><p><strong>5.货币政策.通货膨胀压力减少，PPI下降；但美通货膨胀压力大，且发生俄乌战争；源于供给冲击不能通过紧缩性货币政策。汇率浮动要保持定力，除非发现非常情况，不要对汇率进行干预。货币政策的根本目的：稳增长、物价稳定。</strong></p><p><strong>6.美对俄的金融制裁</strong></p><p> <strong>6.1制裁措施：封锁国际金融</strong></p><p> <strong>选定银行从SWIFT中删除（但最大两家未删除，因为欧洲对俄罗斯石油天然气的依赖）</strong></p><p> <strong>冻结俄罗斯央行外储（核弹）</strong></p><p> <strong>系统性重要银行列入CAPTA（不能进入美国市场）</strong></p><p><strong>冻结俄罗斯海外富豪资产</strong></p><p><strong>SDN名单（不得提取存款）</strong></p><p> <strong>补充：国际结算三要素</strong></p><p> <strong>报文系统</strong></p><p> <strong>发起和接收银行</strong></p><p> <strong>清算、结算系统</strong></p><p> <strong>6.2 影响：石油、粮食、大宗商品</strong></p><p><strong>6.3 美国目的：使得俄罗斯短期造成动荡、无法支持战争，长期经济无法发展</strong></p><p><strong>6.4 俄罗斯国际收支状况和海外投资头寸：净债权国</strong></p><p><strong>6.5 对俄罗斯的影响：股市暴跌、汇率暴跌、升息（汇率稳定三条路径：央行干预、升息、资本管制）</strong>            </p><p><strong>7. 中国海外资产的安全性问题，中国是美国的最大债权国</strong></p><h4 id="林毅夫"><a href="#林毅夫" class="headerlink" title="林毅夫"></a>林毅夫</h4><p>林毅夫解读2022政府工作报告及中国经济发展前景解析  <a href="https://www.bilibili.com/video/BV1CR4y1F7Wo/?spm_id_from=333.337.search-card.all.click">视频</a> <a href="/images/林毅夫解读2022政府工作报告及中国经济发展前景解析.pdf">笔记</a></p><p>宏观观察</p><p>中国宏观经济论坛（CMF):三重压力叠加超预期变化的宏观经济(2022.4.20月度分析会)   <a href="https://www.bilibili.com/video/BV1PT4y1a7bB/?spm_id_from=333.337.search-card.all.click">视频</a>  <a href="/images/三重压力叠加超预期变化的宏观经济_PPT.pdf">PPT</a>  <a href="https://mp.weixin.qq.com/s/atjVvB8befjqpaKWpgDpxQ">图文报道（微信）</a>  <a href="/images/三重压力叠加超预期变化的宏观经济.pdf">笔记</a></p>]]></content>
      
      
      <categories>
          
          <category> 资料 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 知识 </tag>
            
            <tag> 生活 </tag>
            
            <tag> 投资 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>经济学论文数据与代码——期刊、平台和个人</title>
      <link href="/2023/02/15/jing-ji-xue-lun-wen-shu-ju-yu-dai-ma-qi-kan-ping-tai-he-ge-ren/"/>
      <url>/2023/02/15/jing-ji-xue-lun-wen-shu-ju-yu-dai-ma-qi-kan-ping-tai-he-ge-ren/</url>
      
        <content type="html"><![CDATA[<p>学术期刊网站</p><p>经济学Top5期刊</p><p><strong>American Economic Review</strong></p><p>AEA官网论文Additional Materials：</p><p><a href="https://www.aeaweb.org/journals/aer/issues">https://www.aeaweb.org/journals/aer/issues</a></p><p>OpenICPSR网站：</p><p><a href="https://www.icpsr.umich.edu/web/ICPSR/search/publications?start=0&amp;COLLECTION=DATA&amp;ARCHIVE=ICPSR&amp;JOURNAL=American Economic Review&amp;sort=YEAR_PUB_DATE desc,AUTHORS_SORT asc">https://www.icpsr.umich.edu/web/ICPSR/search/publications?start=0&amp;COLLECTION=DATA&amp;ARCHIVE=ICPSR&amp;JOURNAL=American%20Economic%20Review&amp;sort=YEAR_PUB_DATE%20desc,AUTHORS_SORT%20asc</a></p><p><strong>The Quarterly Journal of Economics</strong></p><p>Harvard Dataverse</p><p><a href="https://dataverse.harvard.edu/dataverse/qje">https://dataverse.harvard.edu/dataverse/qje</a></p><p><strong>Econometrica</strong></p><p>官网论文Data &amp; Programs</p><p><a href="https://onlinelibrary.wiley.com/journal/14680262">https://onlinelibrary.wiley.com/journal/14680262</a></p><p><a href="https://www.econometricsociety.org/">econometric society</a> 发表在ECONOMETRICA上的论文可以在这个网站找到code和数据集。</p><p><strong>Journal of Political Economy</strong></p><p>官网论文Supplemental Material</p><p><a href="https://www.journals.uchicago.edu/toc/jpe/current">https://www.journals.uchicago.edu/toc/jpe/current</a></p><p><strong>The Review of Economic Studies</strong></p><p>官网论文Supplementary data</p><p><a href="https://academic.oup.com/restud">https://academic.oup.com/restud</a></p><p>金融学Top3期刊</p><p><strong>The Journal of Finance</strong></p><p>官网论文Supporting Information</p><p><a href="https://onlinelibrary.wiley.com/toc/15406261/current">https://onlinelibrary.wiley.com/toc/15406261/current</a></p><p><strong>Journal of Financial Economics</strong></p><p>2021年7月1日之前的论文：</p><p><a href="https://www.jfinec.com/data-and-code">https://www.jfinec.com/data-and-code</a></p><p>2021年7月1日之后的论文，见ScienceDirect官网链接或以下网址：</p><p><a href="https://data.mendeley.com/journal/0304405X">https://data.mendeley.com/journal/0304405X</a></p><p><strong>Review of Financial Studies</strong></p><p>Supplementary data</p><p><a href="https://dataverse.harvard.edu/dataverse/rfs">https://dataverse.harvard.edu/dataverse/rfs</a></p><p>其他经济学期刊：劳动、能源、计量、统计</p><p><strong>Review of Economics and Statistics</strong></p><p><a href="https://dataverse.harvard.edu/dataverse/restat">https://dataverse.harvard.edu/dataverse/restat</a></p><p><strong>Journal of Labor Economics</strong></p><p>Supplemental Material</p><p><a href="https://www.journals.uchicago.edu/toc/jole/current">https://www.journals.uchicago.edu/toc/jole/current</a></p><p><strong>Energy Economics</strong></p><p>Latest Mendeley Data Datasets</p><p><a href="https://www.journals.elsevier.com/energy-economics/mendeley-datasets">https://www.journals.elsevier.com/energy-economics/mendeley-datasets</a></p><p><strong>The Economic Journal</strong></p><p>Data &amp; Codes 基本都有代码</p><p><a href="https://academic.oup.com/ej">https://academic.oup.com/ej</a></p><p><strong>European Economic Review</strong></p><p>部分有代码</p><p><a href="https://www.journals.elsevier.com/european-economic-review">https://www.journals.elsevier.com/european-economic-review</a></p><p><strong>Journal of Economics and Statistics</strong></p><p>Data &amp; Programs</p><p><a href="https://journaldata.zbw.eu/journals/jbnst">https://journaldata.zbw.eu/journals/jbnst</a></p><p><strong>Journal of Statistics Software</strong></p><p>Data &amp; Programs</p><p><a href="https://www.jstatsoft.org/">https://www.jstatsoft.org/</a></p><p><strong>Journal of Applied Econometrics</strong></p><p>Data Archive 基本都有代码</p><p><a href="https://journaldata.zbw.eu/journals/jae">https://journaldata.zbw.eu/journals/jae</a></p><p><strong>Review of Economic Dynamics</strong></p><p>Computer Codes 基本都有代码</p><p><a href="https://ideas.repec.org/s/red/ccodes.html">https://ideas.repec.org/s/red/ccodes.html</a></p><p><strong>PLOS ONE</strong></p><p>Data-availability</p><p><a href="https://journals.plos.org/plosone/">https://journals.plos.org/plosone/</a></p><p><strong>Journal of the European Economic Association</strong></p><p><a href="https://academic.oup.com/jeea/issue/21/1">https://academic.oup.com/jeea/issue/21/1</a></p><p><strong>American Economic Journal:Applied Economics</strong></p><p><a href="https://www.aeaweb.org/journals/app">https://www.aeaweb.org/journals/app</a></p><p><strong>quantitative economics</strong></p><p><a href="https://www.econometricsociety.org/publications/quantitative-economics">https://www.econometricsociety.org/publications/quantitative-economics</a></p><p>中文期刊</p><p>《中国工业经济》国内经管类期刊首位公开数据的期刊，从2016年11期起，开放获取论文原文、数据、代码 </p><p><a href="http://ciejournal.ajcass.org/">http://ciejournal.ajcass.org/</a></p><p>数量经济技术经济研究：从2022年9期起，开放获取论文原文、数据、代码。</p><p><a href="http://www.jqte.net/sljjjsjjyj/ch/index.aspx">http://www.jqte.net/sljjjsjjyj/ch/index.aspx</a></p><p>02 数据和代码分享平台</p><p>Wharton Research Data Services（WRDS）WRDS是由宾夕法尼亚大学沃顿商学院于1993年开发的金融领域的跨库研究工具，可以整合Compustat、CRSP、TFN(THOMSON)、TAQ、IBES等多个著名数据库产品，同时还是一个研究人员分享数据和代码的社区。</p><p><a href="https://wrds-www.wharton.upenn.edu/">https://wrds-www.wharton.upenn.edu/</a></p><p>哈佛大学Dataverse网站</p><p>Dataverse是哈佛大学主办的研究数据、代码的储存和分享网站。</p><p><a href="https://dataverse.harvard.edu/">https://dataverse.harvard.edu/</a></p><p>OpenICPSR网站</p><p>ICPSR是密歇根大学主办的论文数据分享网站。</p><p><a href="https://www.openicpsr.org/openicpsr/search/studies">https://www.openicpsr.org/openicpsr/search/studies</a></p><p><a href="https://www.icpsr.umich.edu/">https://www.icpsr.umich.edu/</a></p><p>Mendeley平台</p><p>Mendeley平台提供的论文数据检索网站。</p><p><a href="https://data.mendeley.com/">https://data.mendeley.com/</a></p><p>Find Economic Articles with Data</p><p>德国乌尔姆大学（Ulm University）创建的查找经济学论文实证数据的网站。</p><p><a href="https://ejd.econ.mathematik.uni-ulm.de/">https://ejd.econ.mathematik.uni-ulm.de/</a></p><p>Replication WIKI</p><p>Replication WIKI是哥廷根大学主办的实证研究的数据库，主要提供经济学论文复制研究的数据以及代码。</p><p><a href="http://replication.uni-goettingen.de/wiki/index.php/Main_Page">http://replication.uni-goettingen.de/wiki/index.php/Main_Page</a></p><p>03 学者个人主页</p><p>Kenneth R. French</p><p><a href="http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html">http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html</a></p><p>Hou-Xue-Zhang q-factors data library</p><p><a href="https://global-q.org/index.html">https://global-q.org/index.html</a></p><p>Joshua Angrist</p><p><a href="http://economics.mit.edu/faculty/angrist/data1">http://economics.mit.edu/faculty/angrist/data1</a></p><p>Esther Duflo</p><p><a href="http://economics.mit.edu/faculty/eduflo/papers">http://economics.mit.edu/faculty/eduflo/papers</a></p><p>Daron Acemoglu</p><p><a href="http://economics.mit.edu/faculty/acemoglu/data">http://economics.mit.edu/faculty/acemoglu/data</a></p><p>Nathan Nunn</p><p><a href="https://scholar.harvard.edu/nunn/home">https://scholar.harvard.edu/nunn/home</a></p><p>Raj Chetty</p><p><a href="http://www.rajchetty.com/papers-chronological/">http://www.rajchetty.com/papers-chronological/</a></p><p>Ross Levine</p><p><a href="http://faculty.haas.berkeley.edu/ross_levine/papers.htm">http://faculty.haas.berkeley.edu/ross_levine/papers.htm</a></p><p>Itay Saporta-Eksten</p><p><a href="https://www.tau.ac.il/~itaysap/research.html">https://www.tau.ac.il/~itaysap/research.html</a></p><p>Daniel Taylor</p><p><a href="http://acct.wharton.upenn.edu/~dtayl/code.htm">http://acct.wharton.upenn.edu/~dtayl/code.htm</a></p><p><a href="https://danieltayloranalytics.com/data/">https://danieltayloranalytics.com/data/</a></p><p>Michael Greenstone（环境经济学）</p><p><a href="https://www.michaelgreenstone.com/">https://www.michaelgreenstone.com/</a></p><p>James D. Hamilton</p><p><a href="https://econweb.ucsd.edu/~jhamilto/">https://econweb.ucsd.edu/~jhamilto/</a></p><p>Melissa Dell（“RDD女王”）</p><p><a href="https://scholar.harvard.edu/dell">https://scholar.harvard.edu/dell</a></p><p>Tao Zha</p><p><a href="http://www.tzha.net/code">http://www.tzha.net/code</a></p><p>Haroon Mumtaz</p><p><a href="https://sites.google.com/site/hmumtaz77/">https://sites.google.com/site/hmumtaz77/</a></p><p>Ambrogio Cesa-Bianchi</p><p><a href="https://sites.google.com/site/ambropo/replications">https://sites.google.com/site/ambropo/replications</a></p><p>Gary Koop</p><p><a href="https://sites.google.com/site/garykoop/home/computer-code-2">https://sites.google.com/site/garykoop/home/computer-code-2</a></p><p>Dimitris Korobilis</p><p><a href="https://sites.google.com/site/dimitriskorobilis/matlab">https://sites.google.com/site/dimitriskorobilis/matlab</a></p><p>Joshua Chan</p><p><a href="http://joshuachan.org/code.html">http://joshuachan.org/code.html</a></p><p>Kaiji Motegi’s Website</p><p><a href="http://www2.kobe-u.ac.jp/~motegi/Matlab_Codes.html">http://www2.kobe-u.ac.jp/~motegi/Matlab_Codes.html</a></p><p>Robert F. Stambaugh</p><p><a href="https://finance.wharton.upenn.edu/~stambaug/">https://finance.wharton.upenn.edu/~stambaug/</a></p><p>Dacheng Xiu</p><p><a href="https://dachxiu.chicagobooth.edu/">https://dachxiu.chicagobooth.edu/</a></p><p>Pol Antràs</p><p><a href="https://scholar.harvard.edu/antras/pages/data">https://scholar.harvard.edu/antras/pages/data</a></p><p>Robert J. Barro</p><p><a href="https://scholar.harvard.edu/barro/data_sets">https://scholar.harvard.edu/barro/data_sets</a></p><p>Richard B. Freeman</p><p><a href="https://scholar.harvard.edu/freeman/data-available-public">https://scholar.harvard.edu/freeman/data-available-public</a></p><p>Elhanan Helpman</p><p><a href="https://scholar.harvard.edu/helpman/pages/data-1">https://scholar.harvard.edu/helpman/pages/data-1</a></p>]]></content>
      
      
      <categories>
          
          <category> 实证 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据 </tag>
            
            <tag> 代码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>China&#39;s economy and finance</title>
      <link href="/2023/02/15/china-s-economy-and-finance/"/>
      <url>/2023/02/15/china-s-economy-and-finance/</url>
      
        <content type="html"><![CDATA[<p>经济政策的效果</p><p>Bai C E, Hsieh C T, Song Z M. （ 2016）.<a href="\images\the long shadow Fiscal Expansion_chang-taihsieh-2016.pdf">The Long Shadow of China’s  Fiscal Expansion</a>,<a href="http://www.michaelzsong.cn/uploads/4/8/1/4/48141215/long_shadow_ppendix.pdf"><strong>appendix</strong></a></p><p>解释中国的经济增长</p><p>Song Z, Storesletten K, Zilibotti F.(2011)<a href="http://www.michaelzsong.cn/uploads/4/8/1/4/48141215/glc.pdf">Growing like China</a>,  <a href="http://www.michaelzsong.cn/uploads/4/8/1/4/48141215/glc_appendix.pdf">Technical Appendix</a>, <a href="http://www.michaelzsong.cn/uploads/4/8/1/4/48141215/matlabcode_glc.zip">Code</a>, <a href="http://www.michaelzsong.cn/uploads/4/8/1/4/48141215/errata_glc.pdf">Errata</a></p><p>Xiong W. <a href="\images\THE MANDARIN MODEL OF GROWTH.pdf">The mandarin model of growth</a>. NBER, 2018.</p><p>Bai C E, Hsieh C T, Song Z(2020)<a href="\images\Special Deals with Chinese Characteristics.pdf">Special Deals with Chinese Characteristics</a></p>]]></content>
      
      
      <categories>
          
          <category> 事实 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 中国经济 </tag>
            
            <tag> 中国金融 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VAR类模型</title>
      <link href="/2023/02/15/var-lei-mo-xing/"/>
      <url>/2023/02/15/var-lei-mo-xing/</url>
      
        <content type="html"><![CDATA[<h3 id="TVAR"><a href="#TVAR" class="headerlink" title="TVAR"></a>TVAR</h3><ul><li>Piergiorgio Alessandri, Haroon Mumtaz 2017, <a href="http://www.google.com/url?q=http%3A%2F%2Fwww.sciencedirect.com%2Fscience%2Farticle%2Fpii%2FS1094202517300042&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw0QvOs2ZKSC9XGTwdt5Qkdq"><strong>Financial conditions and density forecasts for US output and inflation</strong></a>, Review of Economic Dynamics (<a href="https://www.google.com/url?q=https%3A%2F%2Fideas.repec.org%2Fc%2Fred%2Fccodes%2F14-103.html&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw11MIPlhtIZF3Y9uJH44Cac"><strong>Code</strong></a>)  Example：<a href="https://www.google.com/url?q=https%3A%2F%2Fwww.dropbox.com%2Fsh%2Ftbomikfq7ni92ob%2FAABDyan8si--frIGbPQUZFF9a%3Fdl%3D0&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw0CpafJpXMugOOgm12zdkGe">Two regime threshold VAR model</a> estimated via the algorithm in <a href="http://www.google.com/url?q=http%3A%2F%2Fonlinelibrary.wiley.com%2Fdoi%2F10.1111%2Fj.1467-9892.1995.tb00248.x%2Fabstract&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw25FD0x6cve7O0JVFA2YbI-">Chen and Lee (2004)</a></li></ul><p><a href="https://sites.google.com/site/hmumtaz77/code">Haroon Mumtaz</a> 提供如下VAR模型的代码</p><ul><li><a href="https://www.google.com/url?q=https%3A%2F%2Fwww.dropbox.com%2Fsh%2F484r70be3fx4nak%2FAABZMHeI_jSTNRrB_FbqgpdTa%3Fdl%3D0&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw28u4IGY3YtfMyOgYqt4rHO">Panel Threshold VAR </a>with hierarchical prior</li><li><a href="https://www.google.com/url?q=https%3A%2F%2Fwww.dropbox.com%2Fsh%2Fagiuygl8zfkwnie%2FAACLVuVHgcgEYFUXKjTi0lEOa%3Fdl%3D0&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw3oMapS1NDm-RFXg-kF8fQe">Panel VAR</a> with hierarchical prior</li><li><a href="https://www.google.com/url?q=https%3A%2F%2Fwww.dropbox.com%2Fs%2F0iz3innixhv5410%2FTVPVAR.zip%3Fdl%3D0&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw1vdRxQJMck17gay54mrOBF">TVP VAR</a> with stochastic volatility </li><li><a href="https://www.google.com/url?q=https%3A%2F%2Fwww.dropbox.com%2Fsh%2Ftbomikfq7ni92ob%2FAABDyan8si--frIGbPQUZFF9a%3Fdl%3D0&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw0CpafJpXMugOOgm12zdkGe">Two regime threshold VAR model</a> estimated via the algorithm in <a href="http://www.google.com/url?q=http%3A%2F%2Fonlinelibrary.wiley.com%2Fdoi%2F10.1111%2Fj.1467-9892.1995.tb00248.x%2Fabstract&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw25FD0x6cve7O0JVFA2YbI-">Chen and Lee (2004) </a>.  </li><li><a href="https://www.google.com/url?q=https%3A%2F%2Fwww.dropbox.com%2Fs%2Fnsd0alpcx9ufxuf%2FMSTVTP.zip%3Fdl%3D0&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw3BhOVHZu0Ge0NX5h4dujqM">Two regime Markov Switching VAR with time-varying transition probabilities</a>. Uses an example US dataset. </li><li><a href="https://www.google.com/url?q=https%3A%2F%2Fwww.dropbox.com%2Fs%2Fdolhk7hvmt122b6%2Fmsvar.zip%3Fdl%3D0&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw1LMx1A6BYq3g_SUmZkzNdH">Two regime Markov Switching VAR</a>. Uses an example US dataset. </li><li><a href="https://www.google.com/url?q=https%3A%2F%2Fwww.dropbox.com%2Fsh%2Fr6qxnl2cup78xu6%2FAACKutG3hmVySWacD4Deb0gga%3Fdl%3D0&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw1wbi-2GE70mCqnduIfOM1Q">A VAR with sign restrictions.</a> </li><li><a href="https://www.google.com/url?q=https%3A%2F%2Fwww.dropbox.com%2Fs%2Fdpwy3n15juietma%2Frunfavar.zip%3Fdl%3D0&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw0zB9ciSTKP0EoTyi96qlsd">A Factor-Augmented VAR model</a>. </li><li><a href="https://www.google.com/url?q=https%3A%2F%2Fwww.dropbox.com%2Fs%2F7nt1t2ofvmk0vft%2Ffavartvp.zip%3Fdl%3D0&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw1YcP6P-fOWXfuap-80oKB7">A Factor-Augmented VAR model with time-varying parameters</a>. This is an example of the model used in this <a href="https://www.google.com/url?q=https%3A%2F%2Fideas.repec.org%2Fa%2Feee%2Fdyncon%2Fv37y2013i3p543-560.html&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw1hA6tWj3EpXQog7UTW-Hw7">paper</a>. </li><li><a href="https://www.google.com/url?q=https%3A%2F%2Fwww.dropbox.com%2Fsh%2Fppt63mmaiovy0t4%2FAADTZr6u7yXmd7DOnVofQ96Ha%3Fdl%3D0&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw3RkfNsVSIyjICeMRopqXnW">A VAR model with stochastic volatility in mean</a>. This is an example of the model used in this <a href="https://www.google.com/url?q=https%3A%2F%2Fwww.dropbox.com%2Fs%2Fvl0mmkqniqkryjz%2FWPdraft2016.pdf%3Fdl%3D0&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw0taGTlRUoctqxTvCLYp5wu">paper</a>. </li></ul><p>Notes and Code on <a href="https://www.google.com/url?q=https%3A%2F%2Fwww.dropbox.com%2Fs%2Fd2bcxh23p55bt6z%2Fdraft2.pdf%3Fdl%3D0&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNF6-iL6SZ1yk-Fr8RQa8fBeKApf6A"><strong>Applied Bayesian Econometrics for Central Bankers.</strong></a> (<a href="https://www.google.com/url?q=https%3A%2F%2Fwww.dropbox.com%2Fs%2Fijgq003lhdmiqsc%2FCode2017.zip%3Fdl%3D0&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNEAs8VB9H4hDeeQscAeXQgY9GDMVg"><strong>Code</strong></a>)</p>]]></content>
      
      
      <categories>
          
          <category> 计量 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> VAR </tag>
            
            <tag> SVAR </tag>
            
            <tag> TVAR </tag>
            
            <tag> FAVAR </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>有用的计量工具箱</title>
      <link href="/2023/02/15/you-yong-de-ji-liang-gong-ju-xiang/"/>
      <url>/2023/02/15/you-yong-de-ji-liang-gong-ju-xiang/</url>
      
        <content type="html"><![CDATA[<h4 id="Ambrogio-Cesa-Bianchi"><a href="#Ambrogio-Cesa-Bianchi" class="headerlink" title="Ambrogio Cesa-Bianchi"></a><a href="https://sites.google.com/site/ambropo/home">Ambrogio Cesa-Bianchi</a></h4><p><a href="https://drive.google.com/open?id=1gwRPkL8R9BZGqPaPT6_7aoij-IDaNxY2">DSGE Bayesian Toolbox (ZIP)</a></p><p><strong>A toolbox for the analysis of DSGE models estimated with Bayesian techniques</strong></p><p>This toolbox uses the standard output of Dynare to: </p><p>(i) plot the Markov chain Monte Carlo (MCMC), </p><p>(ii) plot the ergodic distribution of the posterior distribution, </p><p>(iii) plot the prior versus the posterior distribution, together with the mode of the posterior, </p><p>(iv) assess the convergence of the MCMC chain through CUSUM procedure, and </p><p>(v) compare the correlation between the parameters implied by the Hessian and the chain.  </p><p>The toolbox makes use of few Matlab routines of <a href="http://www.google.com/url?q=http%3A%2F%2Fwww.dynare.org%2F&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw0mieXfWcRSewXd-MkXI4E1">Dynare</a>.</p><p>The following example uses as an input the replication of F. Schorfheide (2000) “<a href="\images\LOSS FUNCTION-BASED EVALUATION OF DSGE MODELS-2000.pdf">Loss function-based evaluation of DSGE models</a>“ Journal of Applied Econometrics, 15, 645-670, available on the Dynare website. The convergence of the Markov chain Monte Carlo is assessed with the DSGE Bayesian Toolbox.</p><p>[<a href="https://drive.google.com/open?id=1b5WBlzQf0gRhMngnzphaNurCVEA0Ag1Y">Example</a><a href="https://drive.google.com/open?id=1b5WBlzQf0gRhMngnzphaNurCVEA0Ag1Y"> </a><a href="https://drive.google.com/open?id=1b5WBlzQf0gRhMngnzphaNurCVEA0Ag1Y">Code (ZI</a><a href="https://drive.google.com/open?id=1b5WBlzQf0gRhMngnzphaNurCVEA0Ag1Y">P)</a>]</p><p><a href="https://www.google.com/url?q=https%3A%2F%2Fgithub.com%2Fambropo%2FVAR-Toolbox&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw1Y9GVQ-HDud2rggKQ9Xrcl">VAR Toolbox 3.0</a></p><p><strong>A toolbox for VAR analysis</strong></p><p>The VAR Toolbox is a collection of Matlab codes to perform Vector Autoregression (VAR) analysis. Estimation is performed with OLS. The VAR Toolbox allows for identification of structural shocks with zero short-run restrictions; zero long-run restrictions; sign restrictions; external instruments (proxy SVAR); and a combination of external instruments and sign restrictions. Impulse Response Functions (IR), Forecast Error Variance Decomposition (VD), and Historical Decompositions (HD) are computed according to the chosen identification. Confidence intervals are obtained with bootstrapping methods.</p><p><strong>Vector Autoregressions: A Primer</strong></p><p>A simple primer on VARs (slides and accompanying Matlab codes) using VAR Toolbox is available at the following links:</p><p>[<a href="https://www.google.com/url?q=https%3A%2F%2Fgithub.com%2Fambropo%2FVAR-Toolbox%2Ftree%2Fmain%2Fv3dot0%2FPrimer&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw3WqkJGnx7UIPnLbEo66AD2">Matlab Code</a>]  [<a href="https://drive.google.com/open?id=14LA-q41ns364CtlkJYxF1h-JgCWM-HCy">Slides</a>]</p><h4 id="The-BEAR-toolbox"><a href="#The-BEAR-toolbox" class="headerlink" title="The BEAR toolbox"></a><a href="https://www.ecb.europa.eu/pub/research/working-papers/html/bear-toolbox.en.html">The BEAR toolbox</a></h4><p><a href="https://www.ecb.europa.eu/pub/research/authors/profiles/alistair-dieppe.en.html">Dieppe, Alistair</a>, <a href="https://www.ecb.europa.eu/pub/research/authors/profiles/bjrn-van-roye.en.html">van Roye, Björn</a></p><p>The Bayesian Estimation, Analysis and Regression toolbox (BEAR) is a comprehensive (Bayesian Panel) VAR toolbox for forecasting and policy analysis.</p><p>BEAR is a MATLAB based toolbox which is easy for non-technical users to understand, augment and adapt. In particular, BEAR includes a user-friendly graphical interface which allows the tool to be used by country desk economists.</p><p>Furthermore, BEAR is well documented, both within the code as well as including a detailed theoretical and user’s guide. BEAR includes state-of-the art applications such as FAVARs, stochastic volatility, time-varying parameters, mixed-frequency, sign and magnitude restrictions, conditional forecasts, Bayesian forecast evaluation measures, Bayesian Panel VAR using different prior distributions (for example hierarchical priors).</p><p>BEAR is specifically developed for transparently supplying a tool for state-of-the-art research and is planned to be further developed to always be at the frontier of economic research.</p><h5 id="BEAR-Toolbox"><a href="#BEAR-Toolbox" class="headerlink" title="BEAR Toolbox"></a>BEAR Toolbox</h5><ul><li><a href="https://www.ecb.europa.eu/pub/research/working-papers/html/BEAR_toolbox_v5_1.pdf">BEAR 5.1 Overview</a></li><li><a href="https://github.com/european-central-bank/BEAR-toolbox/">Download the BEAR Toolbox</a></li></ul><h4 id="Empirical-macro-toolbox"><a href="#Empirical-macro-toolbox" class="headerlink" title="Empirical macro toolbox"></a><a href="https://github.com/naffe15/BVAR_">Empirical macro toolbox</a></h4><p>The empirical macro toolbox is a new package that contains MATLAB functions and routines to estimate VARs, FAVARs, local projections and other models with classical or Bayesian methods. The toolbox allows a researcher to conduct inference under various prior assumptions on the parameters, to produce point and density forecasts, and to trace out the causal effect of shocks using a number of identification schemes. The toolbox is equipped to handle missing observations. It can also deal with panels of time series. We describe the methodology employed and implementation of the functions. We illustrate the main features with a number of practical examples.</p><p><a href="https://github.com/naffe15/BVAR_/blob/master/HitchhikerGuide_.pdf">A hitchhiker guide to empirical macro models (Reference Document)</a> by Ferroni F. and Canova F.</p><p><a href="https://github.com/naffe15/BVAR_">Go to Toolbox</a></p><p><a href="https://www.youtube.com/channel/UCDepPX4wbdkIqfg438J0h_g">Go to video tutorial (youtube)</a></p>]]></content>
      
      
      <categories>
          
          <category> 计量 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Matlab </tag>
            
            <tag> 工具 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RBC与Dynare</title>
      <link href="/2023/02/15/rbc-yu-dynare/"/>
      <url>/2023/02/15/rbc-yu-dynare/</url>
      
        <content type="html"><![CDATA[<h3 id="RBC"><a href="#RBC" class="headerlink" title="RBC"></a>RBC</h3><p>讲义：PPT</p>]]></content>
      
      
      <categories>
          
          <category> 理论 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Dynare </tag>
            
            <tag> RBC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DSGE学习和参考文献</title>
      <link href="/2023/02/15/dsge-xue-xi-he-can-kao-wen-xian/"/>
      <url>/2023/02/15/dsge-xue-xi-he-can-kao-wen-xian/</url>
      
        <content type="html"><![CDATA[<p>财政乘数的计算</p><p>Jesper Lindé &amp; Mathias Trabandt（2018，JAE):<strong>Should we use linearized models to calculate fiscal multipliers?</strong>   <a href="\images\Lindé &amp; Trabandt_2018，JAE_Should we use linearized models to calculate fiscal multipliers.pdf">PDF</a>   <a href="http://qed.econ.queensu.ca/jae/2018-v33.7/linde-trabandt/lt-codes.zip">code </a> <a href="http://qed.econ.queensu.ca/jae/2018-v33.7/linde-trabandt/readme.lt.txt">readme</a></p><p>理由：建模规范，代码清晰</p><p>摘要：We calculate the magnitude of the government consumption multiplier in linearized and nonlinear solutions of a New Keynesian model at the zero lower bound. Importantly, the model is amended with real rigidities to simultaneously account for the <em>macroeconomic evidence</em> of a low Phillips curve slope and the <em>microeconomic evidence</em> of frequent price changes. We show that the nonlinear solution is associated with a much smaller multiplier than the linearized solution in long-lived liquidity traps, and pin down the key features in the model which account for the difference. Our results caution against the common practice of using linearized models to calculate fiscal multipliers in long-lived liquidity traps.</p><p>摘要：</p><p>We argue that positive co-movements between land prices and business investment are a driving force behind the broad impact of land-price dynamics on the macroeconomy. We develop an economic mechanism that captures the co-movements by incorporating two key features into a DSGE model: We introduce land as a collateral asset in firms’ credit constraints, and we identify a shock that drives most of the observed fluctuations in land prices. Our estimates imply that these two features combine to generate an empirically important mechanism that amplifies and propagates macroeconomic fluctuations through the joint dynamics of land prices and business investment.</p><p>经典的DSGE文献：</p><ol><li>CEE-2005-<a href="\images\CEE-2005-Nominal Rigidities and the Dynamic Effects of a Shock to Monetary Policy.pdf">Nominal Rigidities and the Dynamic Effects of a Shock to Monetary Policy</a></li><li><p>Gertler&amp;Kiyotaki<em>2011</em><a href="\images\Gertler&amp;Kiyotaki_2011_Financial Intermediation and Credit Policy in Business Cycle Analysis.pdf">Financial Intermediation and Credit Policy in Business Cycle Analysis</a></p></li><li><p>Smets&amp;Wouters<em>2003</em><a href="\images\Smets Wouters 2003-AN ESTIMATED DYNAMIC STOCHASTIC GENERAL EQUILIBRIUM MODEL OF THE EURO AREA.pdf">AN ESTIMATED DYNAMIC STOCHASTIC GENERAL EQUILIBRIUM MODEL OF THE EURO AREA</a></p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 理论 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Matlab </tag>
            
            <tag> DSGE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>我关注的公众号</title>
      <link href="/2023/02/15/wo-guan-zhu-de-gong-zhong-hao/"/>
      <url>/2023/02/15/wo-guan-zhu-de-gong-zhong-hao/</url>
      
        <content type="html"><![CDATA[<h3 id="经济金融资讯"><a href="#经济金融资讯" class="headerlink" title="经济金融资讯"></a>经济金融资讯</h3><ul><li>中国金融新闻网</li></ul><h3 id="顶尖大学学院公众号"><a href="#顶尖大学学院公众号" class="headerlink" title="顶尖大学学院公众号"></a>顶尖大学学院公众号</h3><ul><li>北大国发院</li><li>北京大学光华管理学院</li><li>复旦大学经济学院</li><li>清华大学经济管理学院</li><li>清华五道口</li><li>上海高级金融学院</li><li>中国社会科学院经济研究所</li><li>人大重阳</li></ul><h3 id="学术期刊公众号"><a href="#学术期刊公众号" class="headerlink" title="学术期刊公众号"></a>学术期刊公众号</h3><ul><li>比较</li><li>管理世界</li><li>管理学季刊</li><li>经济学动态</li><li>经济研究</li></ul><h3 id="智库"><a href="#智库" class="headerlink" title="智库"></a>智库</h3><ul><li>中国金融四十人论坛</li><li><p>中国经济50人论坛</p></li><li><p>资本市场50人论坛</p></li><li>首席经济学家论坛</li></ul><h3 id="官方机构"><a href="#官方机构" class="headerlink" title="官方机构"></a>官方机构</h3><ul><li>财政部</li><li>证监会发布</li><li>中国人民银行</li><li>中国银保监会</li><li>统计微讯</li></ul><h3 id="文献和学术分享"><a href="#文献和学术分享" class="headerlink" title="文献和学术分享"></a>文献和学术分享</h3><ul><li>AmyEconFin  </li><li>东海岸的雨</li><li>大森投研</li><li>大金融思想</li><li>东周宏观</li><li>DSGE与宏观计量分析</li><li>EV视点</li><li>何不娓娓道来</li><li>宏观研学会</li><li>IRID区域与产业发展研究中心</li><li>家进不错</li><li>唧唧堂</li><li>经管定量笔记</li><li>金融学前言论文速递</li><li>机器学习与数字经济实验室（上财郭峰）</li><li>科研岛</li><li>李力南以离开</li><li>MacroHub</li><li>铭心而论</li><li>文献速读一号机</li><li>香樟经济学术圈</li><li>小田说事</li><li>学术成长学苑</li><li>学术无界</li><li>一刹春浓</li><li>刀熊说说</li><li>NSD博士之家</li><li>学术志</li></ul><h3 id="计量方法"><a href="#计量方法" class="headerlink" title="计量方法"></a>计量方法</h3><ul><li>DMETP</li><li>功夫计量经济学</li><li>计量经济圈</li><li>计量经济模型</li><li>计量经济学</li><li>计量经济学与Stata应用</li><li>经济学结构估计前言</li><li>经济知识综合</li><li>君泉计量</li><li>量化研究方法</li><li>连享会</li><li>PaperCodeTips</li><li>实证论文方法研究</li><li>Stata中文社区</li></ul><h3 id="数据和工具"><a href="#数据和工具" class="headerlink" title="数据和工具"></a>数据和工具</h3><ul><li><p>Python</p><ul><li>大邓和他的Python</li></ul></li><li><p>Excel</p><ul><li>Excel之家ExcelHome</li></ul></li><li>综合<ul><li>EasyShu</li><li>社会科学中的机器学习</li><li>数据化管理</li></ul></li><li>Latex<ul><li>Latex工作室</li></ul></li><li>Matlab<ul><li>matlab入门到入门</li></ul></li><li>R<ul><li>R语言数据分析与实践</li></ul></li></ul><h3 id="时政经济分析"><a href="#时政经济分析" class="headerlink" title="时政经济分析"></a>时政经济分析</h3><ul><li>成方街哨兵</li><li>大树乡长</li><li>地安门外一闲人</li><li>鹅少说</li><li><p>富贵门</p></li><li><p>法询金融</p></li><li>法询金融固收组</li><li>FICCRUC</li><li>付鹏的财经世界</li><li>高善文经济观察</li><li>冠男固收视野（华创）</li><li>郭磊宏观茶座</li><li>顾子明的政事堂免费</li><li>海清FICC频道（早评系列）</li><li>寒飞论债</li><li>宏观闻涛声（中信建投）</li><li>见闻早餐</li><li>蕉易猿生像（每日日报）</li><li>金融监管研究院</li><li>金融监管与风险观察（金融风险周报）</li><li>金融街老裘</li><li>金融老编辑</li><li>韭菜一家人</li><li>李迅雷金融与投资</li><li>猫哥的视界713</li><li>咩咩说</li><li>明细笔谈（中信宏观）</li><li>秦大明</li><li>秦小明</li><li>求实处</li><li>任博宏观论道</li><li>人生几个BP</li><li>Rick笔记</li><li>三表龙门阵</li><li>三法司正道办</li><li>三法司正路办</li><li>沈建光博士宏观研究</li><li>势场</li><li>图解金融</li><li>王涵论宏观</li><li>王剑的角度（银行）</li><li>伍戈经济笔记</li><li>心路独舞（从中国看美国，从美国看中国）</li><li>言他君</li><li>圆方你怎么看啊</li><li>郁言债市</li><li>泽平宏观</li><li>债市邦</li><li>政事堂2019</li><li>政事堂编辑部</li><li>政事堂Plus2019</li><li>智堡Wisburg</li><li>一川Law</li><li>奇霖宏观</li><li>三折人生</li><li>张明宏观金融研究</li></ul><h3 id="暂不关注公众号汇总"><a href="#暂不关注公众号汇总" class="headerlink" title="暂不关注公众号汇总"></a>暂不关注公众号汇总</h3><p>投资类公众号</p><ul><li>半夏投资</li><li>川总写量化</li></ul><p>商业模式解析</p><ul><li>笔记侠</li></ul><p>理性思辨</p><ul><li><p>C计划</p></li><li><p>L先生说</p></li><li><p>饶议科学</p></li><li><p>思维有了模型</p></li><li><p>拾遗</p></li><li><p>warfalcon</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 信息 </tag>
            
            <tag> 知识 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SVAR模型</title>
      <link href="/2023/02/14/svar-mo-xing/"/>
      <url>/2023/02/14/svar-mo-xing/</url>
      
        <content type="html"><![CDATA[<p>以下内容来自微信公众号《李力南以离开》</p><p>SVAR模型曾经是实证宏观经济学中最主要的方法之一，很可惜已经不再是目前最流行的方法了，因为局部投影方法(Local Projection)最近几年在宏观实证研究中越来越受到重视，基本可以替代VAR模型，但是SVAR模型由于可以施加结构约束，其地位仍然很重要。很遗憾的是，国内没有专门介绍SVAR模型的教科书，这使得很多人对于VAR模型存在误解。VAR模型最重要的难点在于“识别”(identification)。推荐两本关于SVAR模型非常好的教科书：</p><ol><li><p>‘<a href="\images\Structural Vector Autoregressive Analysis.pdf">Structural Vector Autoregressive Analysis</a>‘ by Lutz Kilian and Helmut Lütkepohl, Cambridge University Press, 2017.</p><p><img src="/images/112908a969d9ciyow46w9z.jpg" alt=""></p></li></ol><p>作者Lutz Kilian是这个世界上SVAR模型做得最好的学者之一。北大的图书馆没有这本书，但是人大图书馆有，所以我有一段时间经常去人大就是为了查阅这本书，后来委托人大同学借到这本书，如获至宝，大概读了70%左右，收货非常大，此书系统地介绍了SVAR模型的各种识别方法，包括短期约束、长期约束、符号约束、高频识别(high frequency identification)、异方差识别、工具变量识别(external instrument)，narrative identification等等。<strong>所谓的识别，就是解决内生问题，而这才是VAR模型的核心所在</strong>，很可惜大多数国内的学者对于识别的探讨非常少，构建的VAR模型存在很大的内生问题, 而审稿人也未必熟悉这一领域，这就导致很多权威中文期刊上发表的基于SVAR模型的分析甚至是错误的。若能通读此书，基本可以接近国际前沿水平。目前，此书在实证宏观中的地位就好比实证微观中Angrist的 Mostly Harmless Econometrics。</p><ol><li>‘<a href="\images\2005 New introduction to multiple time series analysis.pdf">New introduction to multiple time series analysis</a>‘. By Lütkepohl H. , Springer Science &amp; Business Media, 2005</li></ol><p><img src="/images/978-3-540-27752-1.jpeg" alt="New Introduction to Multiple Time Series Analysis | SpringerLink" style="zoom:50%;" /></p><p>此书的作者Lütkepohl H也是第一本书的第二作者，是德国著名的计量经济学家，专门从事时间序列分析，我还没有系统研读过这本书，但是曾经在时间序列分析备课的时候参阅过其中的一章，非常经典。这本书相对理论，适合拿来推导。这本书比Hamilton的《time series analysis》更适合用来学习SVAR模型。</p><p>关于SVAR模型，目前还有两个工具箱，可以直接用于实证分析：</p><p>第一个是欧洲央行开发的BEAR工具箱，下载链接：</p><p><a href="https://www.ecb.europa.eu/pub/research/working-papers/html/bear-toolbox.en.html">https://www.ecb.europa.eu/pub/research/working-papers/html/bear-toolbox.en.html</a></p><p>第二个是宏观计量大量Canova开发的Empirical Macro 工具箱，下载链接：</p><p><a href="https://sites.google.com/view/fabio-canova-homepage/home/empirical-macro-toolbox">https://sites.google.com/view/fabio-canova-homepage/home/empirical-macro-toolbox</a></p><p>这两个工具箱都是基于MATLAB，基本涵盖了当前所有文献中提及的识别方法，对于不想做理论的来说，完全足够了。</p>]]></content>
      
      
      <categories>
          
          <category> 计量方法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SVAR </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>局部投影法</title>
      <link href="/2023/02/14/ju-bu-tou-ying-fa/"/>
      <url>/2023/02/14/ju-bu-tou-ying-fa/</url>
      
        <content type="html"><![CDATA[<h3 id="一、介绍"><a href="#一、介绍" class="headerlink" title="一、介绍"></a>一、介绍</h3><p>局部投影法被认为是VAR的改进，尤其是在得到脉冲响应函数方面。而脉冲响应函数主要被用于宏观经济学中的冲击响应分析（比如，提升利率对GDP的影响），通过画图可以直观地明白政策的效果。</p><p>局部投影法的优势在于可以不用像VAR一样对数个方程同时进行估计，而是可以根据需要灵活地设定和估计我们感兴趣的变量的响应函数；同时，通过引入高次项和其他控制变量，可以使得模型的预测更符合真实的情况；而且，局部投影法对于经济变量背后的data generating process （DGP）要求更低，即使我们不能准确变量真实的DGP，通过局部投影法得到的结果也是（更）稳健的。</p><p><strong>VAR模型与脉冲响应</strong></p><p>局部投影法是近年来新兴起的脉冲响应函数估计方法，简便、灵活、稳健的特性使其备受青睐。局部投影法多用于分析宏观冲击（政策）对微观层面的影响，也可以分析时间序列数据。局部投影法的功能强大，用起来却十分方便，我们可以直接在软件中使用简单的ols或者iv回归命令进行局部投影法估计。需要注意的是，局部投影法中的关键解释变量（宏观冲击）一般需要是使用其他技术（如SVAR等）得到的外生冲击。</p><p>下面转引大森投研的PPT：</p><p>从一个故事出发:预测2022年毕业时失业率…</p><p><img src="/images/image-20230214154548645.png" alt=""></p><p><img src="/images/image-20230214154604602.png" alt=""></p><p><img src="/images/image-20230214154615388.png" alt=""></p><p><strong>1、AR(1)模型</strong>：假设失业率仅与一个月前的失业率线性相关</p><p><strong>2、AR(p)模型</strong>：放松假设到与前p个月的失业率线性相关</p><p><img src="/images/image-20230214154635261.png" alt=""></p><p><strong>3、VAR(p)模型</strong>：失业率、油价等一组变量取值与其前p个月的取值相关</p><p><img src="/images/image-20230214154645364.png" alt=""></p><p>应用VAR模型的假设：</p><p>  1、误差项</p><p>  2、不同情形下变量需要满足的条件</p><p><img src="/images/image-20230214154653375.png" alt=""></p><p>将VAR(p)压缩到VAR(1)</p><p><img src="/images/image-20230214154705119.png" alt=""></p><p>脉冲响应：油价的突然上涨对未来t期失业率产生的影响</p><p>  1、迭代方程</p><p>  2、取一维形式</p><p><img src="/images/image-20230214154713192.png" alt=""></p><p><img src="/images/image-20230214154728379.png" alt=""></p><p><strong>局部投影法（LP）</strong></p><p>使用LP方法的原因：</p><p>  1、使用简单</p><p>  2、对模型误设更稳健</p><p>  3、可用于非线性识别中（VAR模型为线性估计）</p><p>  4、不用确定和估计出未知的真实模型也可以处理脉冲响应</p><p><img src="/images/image-20230214154736079.png" alt=""></p><p>LP的数学定义</p><p><img src="/images/image-20230214154746121.png" alt=""></p><p><img src="/images/image-20230214154758118.png" alt=""></p><p>VAR和LP的对比</p><p>  1、预测误差</p><p>  2、线性模型下脉冲响应的特征</p><p>  3、LP方法的灵活性</p><p><img src="/images/image-20230214154805262.png" alt=""></p><p><img src="/images/image-20230214171840477.png" alt=""></p><p><img src="/images/image-20230214171847831.png" alt=""></p><p><img src="/images/image-20230214171855712.png" alt=""></p><p><img src="/images/image-20230214171906193.png" alt=""></p><p>特定情况下VAR与LP方法等价</p><p><img src="/images/image-20230214171913496.png" alt=""></p><p><img src="/images/image-20230214171920867.png" alt=""></p><p>下面展示一个局部投影法的实例（来自于Morlacco &amp; Zeke 2021 JME，<a href="\image\Morlacco&amp;Zeke-Monetary Policy, Customer Capital, and Market Power.pdf">Monetary Policy, Customer Capital, and Market Power</a> ）</p><p><img src="/images/image-20230214221239933.png" alt=""></p><p>LP方法的控制变量选择</p><p><img src="/images/image-20230214221331812.png" alt=""></p><p>讨论</p><p>1、VAR方法和LP方法本质相同。在时期较多的情况下，VAR与LP方法相近，并且LP方法拥有更好的性质；而在模型设定正确的情况下，VAR方法效率更高，脉冲响应结果也更平滑；</p><p>2、LP方法可用于宏观冲击、公司金融等问题中，且LP方法与多期DID模型的思想相近。</p><h3 id="二、论文和代码"><a href="#二、论文和代码" class="headerlink" title="二、论文和代码"></a>二、论文和代码</h3><p><a href="https://sites.google.com/site/oscarjorda/home/local-projections">Òscar Jordà主页</a></p><h4 id="（一）代码"><a href="#（一）代码" class="headerlink" title="（一）代码"></a>（一）代码</h4><p><strong>STATA code</strong></p><ul><li>simple time series example: <a href="https://drive.google.com/file/d/15mu23rUs7yQgUwbDfii4htFELBSsggmu/view?usp=sharing">lp_example.do</a></li><li>LPIV example:<a href="https://drive.google.com/file/d/1U1QXJRw5XRW_tQzE2dBZ2GTDQl5uN7cB/view?usp=sharing"> lpiv_example.do</a>; .dta files needed: <a href="https://drive.google.com/file/d/1U2Bq86BnkeI5Ncd7PZ2a68iC7Msqy-Ul/view?usp=sharing">lpiv_15Mar2022.dta</a> and <a href="https://drive.google.com/file/d/1U250PyE-uzofoZz4BtjB2jWtZuq1ojlr/view?usp=sharing">RR_monetary_shock_quarterly.dta</a></li><li>panel data example: <a href="https://drive.google.com/file/d/1mTQOWZQQ6VgXM10-7sVfOiR_IxWX4Q9B/view?usp=sharing">lp_example_panel.do</a></li><li><p><a href="https://www.google.com/url?q=https%3A%2F%2Fonlinelibrary.wiley.com%2Faction%2FdownloadSupplement%3Fdoi%3D10.1111%2Fecoj.12332%26attachmentId%3D119217110&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw0NEjAcpFoC8IxLdn9TGb4R">code</a> for <strong>inverse propensity score weighted - regression augmented LPs</strong> used in: <a href="http://www.google.com/url?q=http%3A%2F%2Fonlinelibrary.wiley.com%2Fdoi%2F10.1111%2Fecoj.12332%2Fabstract&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw2yJgsjHjkBu6Cb5XaQ-Qf3">The Time for Austerity: Estimating the Average Treatment Effect of Fiscal Policy</a>  <em>The Economic Journal,</em> 2016, 126(590): 219-255</p></li><li><p><a href="http://www.google.com/url?q=http%3A%2F%2Fonlinelibrary.wiley.com%2Fstore%2F10.1111%2Fjeea.12144%2Fasset%2Fsupinfo%2Fjeea12144-sup-0001-Replication.zip%3Fv%3D1%26s%3Dcf9c63f62c3237c793800e1da073f7442854a902&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw2Az7j7mBE3f-qc-7KoG9_P">code</a> for <strong>stratified LPs</strong> used in: <a href="http://www.google.com/url?q=http%3A%2F%2Fonlinelibrary.wiley.com%2Fdoi%2F10.1111%2Fjeea.12144%2Fabstract&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw1R8wBqgiSxCBt3s6ak-Xgq">Sovereigns versus Banks: Credit, Crises, and Consequences</a>  <em>Journal of the European Economic Association,</em> 2016, 14(1): 45-79</p></li></ul><p><strong>R code:</strong> package <em>lpirfs</em></p><ul><li>Code prepared by Philipp Adämmer. <a href="https://www.google.com/url?q=https%3A%2F%2Fcran.r-project.org%2Fweb%2Fpackages%2Flpirfs%2Flpirfs.pdf&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw0wE-B9OzXTPkmNHalQ6Fad">Here is a description of its capabilities</a></li></ul><h4 id="（二）论文"><a href="#（二）论文" class="headerlink" title="（二）论文"></a>（二）论文</h4><p><strong>Silvia Miranda Agrippino’s MATLAB code for “The Transmission of Monetary Policy Shocks” (with G. Ricco).</strong> </p><ul><li><p><a href="http://www.google.com/url?q=http%3A%2F%2Fsilviamirandaagrippino.com%2Fcode-data&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw1S96Z3Y0UqAtYfL__FIlDs">typical and Bayesian local projections available here</a></p></li><li><p><strong>IMPULSE RESPONSE FUNCTIONS: BVAR, LP, &amp; BLP</strong>—— <a href="\images\Direct and Iterated Methods for Impulse Responses theory and applications.pdf">ppt</a></p><p>The folder contains <strong>replication files for</strong> <a href="http://silviamirandaagrippino.com/s/MAIN_TransmissionMP-mnbl.pdf"><strong>Miranda-Agrippino &amp; Ricco (2016) “The Transmission of Monetary Policy Shocks”</strong></a>. The code estimates impulse response functions for a <strong>Bayesian Vector Autoregression with standard NIW priors</strong>, Local Projections, and <strong>Bayesian Local Projections</strong>. Identification can be one of either Cholesky or External Instruments (<strong>BSVAR-IV</strong> &amp; <strong>BLP-IV</strong>) </p><p>🔸<a href="http://silviamirandaagrippino.com/s/BLPreplication.zip">download BLP replication files (1.1 MB)</a></p></li></ul><p><strong>replication code for “Impulse responses by smooth local projections” by Barnichon and Brownlees</strong></p><ul><li><a href="https://www.google.com/url?q=https%3A%2F%2Fdataverse.harvard.edu%2Fdataset.xhtml%3FpersistentId%3Ddoi%3A10.7910%2FDVN%2F8KQJBJ&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw3_uVHWKVkvXAlWZhyNHLZh">code from the Review and Economic Statistics publication available here</a></li></ul><p><strong>Bayesian local projections</strong></p><ul><li>Amaze Lusompa has written a great paper on how to think about Bayesian local projections. <a href="https://www.google.com/url?q=https%3A%2F%2Fsites.google.com%2Fuci.edu%2Famazelusompa%2Fresearch&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw2crRuGVbeXloqpV8quEcKm">Check his research here</a></li></ul><p><strong>inference</strong></p><ul><li><a href="https://www.mikkelpm.com/">Mikkel Plagborg-Møller</a> is doing great research on local projections. I particularly like his paper with <a href="http://www.google.com/url?q=http%3A%2F%2Fwww.joseluismontielolea.com%2F&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw2VJvfG_ZkNfiUFBGSuQ1wK">José Luis Montiel Olea</a>. The paper “Local Projection Inference is Simpler and More Robust Than You Think” is <a href="http://www.joseluismontielolea.com/lp_inference_ecta.pdf">available here</a></li></ul><p><strong>references</strong></p><p>main reference: </p><ul><li><a href="/images/Estimation and Inference of Impulse Responses by Local Projections.pdf">Estimation and Inference of Impulse Responses by Local Projections</a> <em>American Economic Review 95(1), March 2005, 161-182</em> - Impulse Responses by Local Projections:  Practical Issues_<a href="/images/Local Projections OJorda-Impulse Responses by Local Projections -Practical Issues.pdf">PPT</a></li></ul><p>how to use IV methods for identification</p><ul><li><a href="https://www.google.com/url?q=https%3A%2F%2Fwww.frbsf.org%2Feconomic-research%2Ffiles%2Fwp2017-02.pdf&amp;sa=D&amp;sntz=1&amp;usg=AOvVaw3xiepuWv6DodApLgHQsKEr">The effects of quasi-random monetary experiments</a> <em>Journal of Monetary Economics, 112: 22-40</em></li></ul><p><strong>some related papers</strong></p><p>Luca Brugnolini: <a href="https://lucabrugnolini.github.io/publication/about_local_projection_reliability.pdf">ABOUT LOCAL PROJECTION IMPULSE RESPONSE FUNCTION RELIABILITY</a></p><p><strong>中文论文</strong>-local-projection</p><p><a href="\images\local-projection-老龄化是否削弱了中国货币政策的“稳增长”效果？.docx">老龄化是否削弱了中国货币政策的“稳增长”效果？</a></p><p><a href="\images\双支柱政策的时变效果及协调作用_王宇晴.pdf">双支柱政策的时变效果及协调作用_王宇晴</a></p><p><a href="\images\基于局部投影的脉冲响应函数对我国货币政策非对称的再检验.pdf">基于局部投影的脉冲响应函数对我国货币政策非对称的再检验</a></p><h3 id="Local-Projections-vs-VARs"><a href="#Local-Projections-vs-VARs" class="headerlink" title="Local Projections vs. VARs"></a>Local Projections vs. VARs</h3><h4 id="1-引子"><a href="#1-引子" class="headerlink" title="1 引子"></a>1 引子</h4><p>小组会再次听到了 LP， 之前也看到过，今天把之前找的资料汇总一下 。Bayesian VAR[1]</p><p><img src="/images/640.png" alt="">LP</p><h4 id="2-LP-VS-VAR"><a href="#2-LP-VS-VAR" class="headerlink" title="2 LP VS VAR"></a>2 LP VS VAR</h4><p>在推文 <a href="https://mp.weixin.qq.com/s?__biz=MzAwMjU1NTQyMg==&amp;mid=2247486169&amp;idx=1&amp;sn=2519167dcda1bd055ae7a975c9b46dcc&amp;scene=21#wechat_redirect">Virtual Time Series Seminar</a> 有一期关于LP和VAR的视频。</p><p><img src="/images/640-16763926299671.png" alt="">LP vs VAR</p><ul><li>Video Local Projections vs. VARs: Lessons From Thousands of DGPs[2]    <a href="\images\lp_var_simul.pdf">pdf</a></li><li>Slides mikkelpm-publications[3]</li></ul><p><img src="/images/640-16763926299672.png" alt=""></p><ul><li>github: lp_var_simul[4]</li></ul><p><img src="/images/640-16763926299673.png" alt=""></p><p>这个学者很顶！</p><p><img src="/images/640-16763926299674.png" alt=""></p><h4 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h4><p>[1]Bayesian VAR:<em><a href="https://www.cnblogs.com/RankFan/p/Bayesian_VAR.html">https://www.cnblogs.com/RankFan/p/Bayesian_VAR.html</a></em></p><p>[2]Local Projections vs. VARs:<em><a href="https://www.youtube.com/watch?v=pYLhKnQZWe4">https://www.youtube.com/watch?v=pYLhKnQZWe4</a></em></p><p>[3]mikkelpm-publications:<em><a href="https://scholar.princeton.edu/mikkelpm/publications">https://scholar.princeton.edu/mikkelpm/publications</a></em></p><p>[4]github lp_var_simul:<em><a href="https://github.com/dake-li/lp_var_simul">https://github.com/dake-li/lp_var_simul</a></em></p>]]></content>
      
      
      <categories>
          
          <category> 计量方法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Local projection </tag>
            
            <tag> VAR </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>宏观金融</title>
      <link href="/2021/08/24/hong-guan-jin-rong/"/>
      <url>/2021/08/24/hong-guan-jin-rong/</url>
      
        <content type="html"><![CDATA[<h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><span id="more"></span><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>firm investment and growth</p><p>corporate, household and sovereign debt</p><p>asset pricing in general equilibrium</p><p>equilibrium macro models with a financial sector.</p><div class="table-container"><table><thead><tr><th style="text-align:center">1</th><th style="text-align:center">1</th><th style="text-align:center">1</th></tr></thead><tbody><tr><td style="text-align:center">2        6</td><td style="text-align:center">1</td><td style="text-align:center">文章标题，强烈建议填写此选项</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">1</td><td style="text-align:center">1</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">1</td><td style="text-align:center">1</td></tr></tbody></table></div><script type="math/tex; mode=display">y_2=3</script><p><img src="/images/image-20221011190810349.png" alt=""></p><script type="math/tex; mode=display">ss</script><div class="table-container"><table><thead><tr><th style="text-align:left">配置选项</th><th style="text-align:left">默认值</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">title</td><td style="text-align:left"><code>Markdown</code> 的文件标题</td><td style="text-align:left">文章标题，强烈建议填写此选项</td></tr><tr><td style="text-align:left">date</td><td style="text-align:left">文件创建时的日期时间</td><td style="text-align:left">发布时间，强烈建议填写此选项，且最好保证全局唯一</td></tr><tr><td style="text-align:left">author</td><td style="text-align:left">根 <code>_config.yml</code> 中的 <code>author</code></td><td style="text-align:left">文章作者</td></tr><tr><td style="text-align:left">img</td><td style="text-align:left"><code>featureImages</code> 中的某个值</td><td style="text-align:left">文章特征图，推荐使用图床(腾讯云、七牛云、又拍云等)来做图片的路径.如: <code>http://xxx.com/xxx.jpg</code></td></tr><tr><td style="text-align:left">top</td><td style="text-align:left"><code>true</code></td><td style="text-align:left">推荐文章（文章是否置顶），如果 <code>top</code> 值为 <code>true</code>，则会作为首页推荐文章</td></tr><tr><td style="text-align:left">cover</td><td style="text-align:left"><code>false</code></td><td style="text-align:left"><code>v1.0.2</code>版本新增，表示该文章是否需要加入到首页轮播封面中</td></tr><tr><td style="text-align:left">coverImg</td><td style="text-align:left">无</td><td style="text-align:left"><code>v1.0.2</code>版本新增，表示该文章在首页轮播封面需要显示的图片路径，如果没有，则默认使用文章的特色图片</td></tr><tr><td style="text-align:left">password</td><td style="text-align:left">无</td><td style="text-align:left">文章阅读密码，如果要对文章设置阅读验证密码的话，就可以设置 <code>password</code> 的值，该值必须是用 <code>SHA256</code> 加密后的密码，防止被他人识破。前提是在主题的 <code>config.yml</code> 中激活了 <code>verifyPassword</code> 选项</td></tr><tr><td style="text-align:left">toc</td><td style="text-align:left"><code>true</code></td><td style="text-align:left">是否开启 TOC，可以针对某篇文章单独关闭 TOC 的功能。前提是在主题的 <code>config.yml</code> 中激活了 <code>toc</code> 选项</td></tr><tr><td style="text-align:left">mathjax</td><td style="text-align:left"><code>false</code></td><td style="text-align:left">是否开启数学公式支持 ，本文章是否开启 <code>mathjax</code>，且需要在主题的 <code>_config.yml</code> 文件中也需要开启才行</td></tr><tr><td style="text-align:left">summary</td><td style="text-align:left">无</td><td style="text-align:left">文章摘要，自定义的文章摘要内容，如果这个属性有值，文章卡片摘要就显示这段文字，否则程序会自动截取文章的部分内容作为摘要</td></tr><tr><td style="text-align:left">categories</td><td style="text-align:left">无</td><td style="text-align:left">文章分类，本主题的分类表示宏观上大的分类，只建议一篇文章一个分类</td></tr><tr><td style="text-align:left">tags</td><td style="text-align:left">无</td><td style="text-align:left">文章标签，一篇文章可以多个标签</td></tr><tr><td style="text-align:left">keywords</td><td style="text-align:left">文章标题</td><td style="text-align:left">文章关键字，SEO 时需要</td></tr><tr><td style="text-align:left">reprintPolicy</td><td style="text-align:left">cc_by</td><td style="text-align:left">文章转载规则， 可以是 cc_by, cc_by_nd, cc_by_sa, cc_by_nc, cc_by_nc_nd, cc_by_nc_sa, cc0, noreprint 或 pay 中的一个</td></tr></tbody></table></div><p><a href="/images/TVP-VAR-SV.pdf">pdf</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>实证研究方法</title>
      <link href="/2021/08/23/shi-zheng-yan-jiu-fang-fa/"/>
      <url>/2021/08/23/shi-zheng-yan-jiu-fang-fa/</url>
      
        <content type="html"><![CDATA[<h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><span id="more"></span><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p><a href="https://www.nber.org/lecture/summer-institute-2015-methods-lecture-machine-learning-and-causal-inference">Machine Learning and Causal Inference</a> <a href="https://www.nber.org/people/susan_athey">Susan Athey</a><em>, <a href="http://www.gsb.stanford.edu/users/athey">Stanford University</a> and <a href="https://athey.people.stanford.edu/">NBER</a></em> <a href="https://ideas.repec.org/e/pat6.html">About this author at RePEc</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2015-methods-lecture-unsupervised-learning-applications-networks-and-text-mining">Summer Institute 2015 Methods Lecture: Unsupervised Learning: Applications to Networks and Text Mining 夏季研究所2015年方法讲座: 非监督式学习: 应用于网络和文本挖掘</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2015-methods-lectures-machine-learning-economists">Summer Institute 2015 Methods Lectures: Machine Learning for Economists 暑期研究所2015年方法讲座: 经济学家的机器学习</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2015-methods-lecture-introduction-supervised-ml-concepts-and-algorithms">Summer Institute 2015 Methods Lecture: Introduction to Supervised ML Concepts and Algorithms 2015年夏季学院方法讲座: 有监督的机器学习概念和算法简介</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2015-methods-lecture-prediction-classification-and-applications">Summer Institute 2015 Methods Lecture: Prediction, Classification, and Applications</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2014-methods-lectures-theory-and-application-network-models"> Network Models 暑期学院2014方法讲座: 网络模型的理论与应用</a><a href="https://www.nber.org/people/matthew_jackson">https://www.nber.org/people/matthew_jackson</a>)</p><p><a href="https://www.nber.org/lecture/summer-institute-2014-methods-lecture-networks-games-over-networks-and-peer-effects">Summer Institute 2014 Methods Lecture: Networks: Games over Networks and Peer Effects 夏季研究所2014年方法讲座: 网络: 网络上的游戏和对等效应</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2014-methods-lecture-networks-propagation-shocks-over-economic-networks">Summer Institute 2014 Methods Lecture: Networks: Propagation of Shocks over Economic Networks 夏季研究所2014年方法讲座: 网络: 冲击在经济网络上的传播</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2014-methods-lecture-social-and-economic-networks-background">Summer Institute 2014 Methods Lecture: Social and Economic Networks: Background 2014年夏季研究所方法讲座: 社会和经济网络: 背景</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2014-methods-lecture-diffusion-identification-network-formation">Summer Institute 2014 Methods Lecture: Diffusion, Identification, Network Formation 夏季学院2014年方法讲座: 扩散，识别，网络形成</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2014-methods-lectures-theory-and-application-network-models">Summer Institute 2014 Methods Lectures: Theory and Application of Network Models 暑期学院2014方法讲座: 网络模型的理论与应用</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2013-methods-lecture-applications-using-text-data">Summer Institute 2013 Methods Lecture: Applications: Using Text as Data 暑期学院2013年方法讲座: 应用: 使用文本作为数据</a></p><p><a href="https://www.bilibili.com/video/BV1c64y1S7eT?from=search&amp;seid=5609008937651178785">因果推断Causal Inference，中英文字幕</a>—<a href="https://www.bradyneal.com/causal-inference-course">https://www.bradyneal.com/causal-inference-course</a></p><h1 id="Introduction-to-Causal-Inference"><a href="#Introduction-to-Causal-Inference" class="headerlink" title="Introduction to Causal Inference"></a>Introduction to Causal Inference</h1><hr><p>Fall 2020</p><p>You’ve found the online causal inference course page. Although, the course text is written from a machine learning perspective, this course is meant to be for anyone with the necessary <a href="https://www.bradyneal.com/causal-inference-course#prerequisites">prerequisites</a> who is interested in learning the basics of causality. I do my best to integrate insights from the <a href="https://www.bradyneal.com/which-causal-inference-book">many different fields</a> that utilize causal inference such as epidemiology, economics, political science, machine learning, etc. You can see the <a href="https://www.bradyneal.com/causal-inference-course#course-schedule-tentative">tentative course schedule</a> below.</p><p>You can join the <a href="https://join.slack.com/t/causalcourse/shared_invite/zt-qpomuitc-WRYfcbeUNb9UACJN2U~kGw">course Slack workspace</a> where you can easily start discussions with other people who are interested in causal inference. For information about office hours, see the <a href="https://www.bradyneal.com/causal-inference-course#office-hours">office hours section</a> below. If you’re interested in leading a reading group discussion, check out the <a href="https://www.bradyneal.com/causal-inference-course#potential-reading-group-papers-by-week">suggested reading group papers</a> to see if one piques your interest. When emailing me about this course, please include “[Causal Course]” at the beginning of your email subject to help make sure I see your email. If you want to receive course updates, sign up for the <a href="https://www.bradyneal.com/causal-inference-course#course-mailing-list">course mailing list</a>. The main <a href="https://www.bradyneal.com/causal-inference-course#course-textbook">textbook</a> we’ll use for this course is <em>Introduction to Causal Inference</em> (ICI), which is a book draft that I’ll continually update throughout this course.</p><h2 id="Course-Schedule-tentative"><a href="#Course-Schedule-tentative" class="headerlink" title="Course Schedule (tentative)"></a>Course Schedule (tentative)</h2><p><strong>Note about slides:</strong> they currently don’t work well with Adobe Acrobat, though they seem to work with other PDF viewers.</p><div class="table-container"><table><thead><tr><th style="text-align:left">Week</th><th style="text-align:left">Topics</th><th style="text-align:left">Lecture</th><th style="text-align:left">Readings</th><th style="text-align:left">Reading Group Paper</th></tr></thead><tbody><tr><td style="text-align:left">August 31</td><td style="text-align:left">Motivation Course Preview Course Information</td><td style="text-align:left"><a href="https://www.youtube.com/watch?v=CfzO4IEMVUk&amp;list=PLoazKTcS0Rzb6bb9L508cyJ1z-U9iWkA0&amp;index=1">Video</a> <a href="https://www.bradyneal.com/slides/1 - A Brief Introduction to Causal Inference.pdf">Slides</a> <a href="https://www.youtube.com/watch?v=xj-tzrm5Src&amp;list=PLoazKTcS0Rzb6bb9L508cyJ1z-U9iWkA0&amp;index=6">Info</a></td><td style="text-align:left">Chapter 1 of ICI</td><td style="text-align:left">None</td></tr><tr><td style="text-align:left">September 7</td><td style="text-align:left">Potential Outcomes A Complete Example with Estimation</td><td style="text-align:left"><a href="https://www.youtube.com/watch?v=q8x9aetyok0&amp;list=PLoazKTcS0Rzb6bb9L508cyJ1z-U9iWkA0&amp;index=8">Video</a> <a href="https://www.bradyneal.com/slides/2 - Potential Outcomes.pdf">Slides</a></td><td style="text-align:left">Chapter 2 of ICI</td><td style="text-align:left"><a href="https://www.nature.com/articles/ijo200882">Does obesity shorten life? The importance of well-defined interventions to answer causal questions (Hernán &amp; Taubman, 2008)</a></td></tr><tr><td style="text-align:left">September 14</td><td style="text-align:left">Graphical Models</td><td style="text-align:left"><a href="https://www.youtube.com/watch?v=Go4EkHN_PcA&amp;list=PLoazKTcS0Rzb6bb9L508cyJ1z-U9iWkA0&amp;index=19">Video</a> <a href="https://www.bradyneal.com/slides/3 - The Flow of Association and Causation in Graphs.pdf">Slides</a></td><td style="text-align:left">Chapter 3 of ICI</td><td style="text-align:left"><a href="https://ftp.cs.ucla.edu/pub/stat_ser/r483-reprint.pdf">Does Obesity Shorten Life? Or is it the Soda? On Non-manipulable Causes (Pearl, 2018)</a></td></tr><tr><td style="text-align:left">September 21</td><td style="text-align:left">Backdoor Adjustment Structural Causal Models</td><td style="text-align:left"><a href="https://www.youtube.com/watch?v=dB8r4Afmobo&amp;list=PLoazKTcS0Rzb6bb9L508cyJ1z-U9iWkA0&amp;index=28">Video</a> <a href="https://www.bradyneal.com/slides/4 - Causal Models.pdf">Slides</a></td><td style="text-align:left">Chapter 4 of ICI</td><td style="text-align:left"><a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.644.1881&amp;rep=rep1&amp;type=pdf">Single World Intervention Graphs: A Primer (Richardson &amp; Robins, 2013)</a></td></tr><tr><td style="text-align:left">September 28</td><td style="text-align:left">Randomized Experiments Frontdoor Adjustment <em>do</em>-calculus Graph-Based Identification</td><td style="text-align:left"><a href="https://www.youtube.com/watch?v=z91LnTDyhtI&amp;list=PLoazKTcS0Rzb6bb9L508cyJ1z-U9iWkA0&amp;index=37">Video</a> <a href="https://www.bradyneal.com/slides/5 - Identification.pdf">Slides</a></td><td style="text-align:left">Chapters 5-6 of ICI</td><td style="text-align:left"><a href="https://causalai.net/r60.pdf">On Pearl’s Hierarchy and the Foundations of Causal Inference (Bareinboim et al., 2020)</a></td></tr><tr><td style="text-align:left">October 5</td><td style="text-align:left">Estimation <a href="https://athey.people.stanford.edu/">Susan Athey</a> Guest Talk - Estimating Heterogeneous Treatment Effects (Oct 8th at 3 - 4 pm EDT)</td><td style="text-align:left"><a href="https://www.youtube.com/watch?v=YzcOYU-s2t4&amp;list=PLoazKTcS0Rzb6bb9L508cyJ1z-U9iWkA0&amp;index=42">Video</a> <a href="https://www.bradyneal.com/slides/6 - Estimation.pdf">Slides</a> <a href="https://www.youtube.com/watch?v=oZoizsX3bts&amp;list=PLoazKTcS0RzZ1SUgeOgc6SWt51gfT80N0&amp;index=7">Guest Talk</a></td><td style="text-align:left">Chapter 7 of ICI</td><td style="text-align:left"><a href="https://arxiv.org/abs/1906.02120">Adapting Neural Networks for the Estimation of Treatment Effects (Shi, Blei, Veitch, 2019)</a></td></tr><tr><td style="text-align:left">October 12</td><td style="text-align:left">Unobserved Confounding, Bounds, and Sensitivity Analysis</td><td style="text-align:left"><a href="https://www.youtube.com/watch?v=IXNMYqUsBBQ&amp;list=PLoazKTcS0Rzb6bb9L508cyJ1z-U9iWkA0&amp;index=47">Video</a> <a href="https://www.bradyneal.com/slides/7 - Unobserved Confounding.pdf">Slides</a></td><td style="text-align:left">Chapter 8 of ICI</td><td style="text-align:left"><a href="https://arxiv.org/abs/2003.01747">Sense and Sensitivity Analysis: Simple Post-Hoc Analysis of Bias Due to Unobserved Confounding (Veitch &amp; Zaveri, 2020)</a></td></tr><tr><td style="text-align:left">October 19</td><td style="text-align:left">Instrumental Variables</td><td style="text-align:left"><a href="https://www.youtube.com/watch?v=Mco16tUSA-U&amp;list=PLoazKTcS0Rzb6bb9L508cyJ1z-U9iWkA0&amp;index=53">Video</a> <a href="https://www.bradyneal.com/slides/8 - Instrumental Variables.pdf">Slides</a></td><td style="text-align:left">Chapter 9 of ICI</td><td style="text-align:left"><a href="http://proceedings.mlr.press/v70/hartford17a.html">Deep IV: A Flexible Approach for Counterfactual Prediction (Hartford et al., 2017)</a></td></tr><tr><td style="text-align:left">October 26</td><td style="text-align:left">Difference-in-Differences <a href="http://economics.mit.edu/faculty/abadie">Alberto Abadie</a> Guest Talk - Synthetic Control (Oct 29th at 10 - 11 am EDT)</td><td style="text-align:left"><a href="https://www.youtube.com/watch?v=tT8xLRS_cRQ&amp;list=PLoazKTcS0Rzb6bb9L508cyJ1z-U9iWkA0&amp;index=58">Video</a> <a href="https://www.bradyneal.com/slides/9 - Difference-in-Differences.pdf">Slides</a> <a href="https://www.youtube.com/watch?v=nKzNp-qpE-I&amp;list=PLoazKTcS0RzZ1SUgeOgc6SWt51gfT80N0&amp;index=11">Guest Talk</a></td><td style="text-align:left">Chapter 10 of ICI</td><td style="text-align:left"><a href="https://www.princeton.edu/~davidlee/wp/RDDEconomics.pdf">Regression Discontinuity Designs in Economics (Lee &amp; Lemieux, 2010)</a></td></tr><tr><td style="text-align:left">November 2</td><td style="text-align:left">—- Break Week - No Lecture —-</td><td style="text-align:left">None</td><td style="text-align:left">Past Readings</td><td style="text-align:left">None</td></tr><tr><td style="text-align:left">November 9</td><td style="text-align:left">Causal Discovery from Observational Data <a href="http://web.math.ku.dk/~peters/">Jonas Peters</a> Guest Talk (November 13 at 10 am EST)</td><td style="text-align:left"><a href="https://www.youtube.com/watch?v=lVE-4deFe7c&amp;list=PLoazKTcS0Rzb6bb9L508cyJ1z-U9iWkA0&amp;index=62">Video</a> <a href="https://www.bradyneal.com/slides/10 - Causal Discovery from Observational Data.pdf">Slides</a></td><td style="text-align:left">Chapter 11 of ICI</td><td style="text-align:left"><a href="https://www.nature.com/articles/s41467-019-10105-3">Inferring causation from time series in Earth system sciences (Runge et al., 2019)</a></td></tr><tr><td style="text-align:left">November 16</td><td style="text-align:left">Causal Discovery from Interventions</td><td style="text-align:left"><a href="https://www.youtube.com/watch?v=de2ODel8F1k&amp;list=PLoazKTcS0Rzb6bb9L508cyJ1z-U9iWkA0&amp;index=69">Video</a> <a href="https://www.bradyneal.com/slides/11 - Causal Discovery from Interventions.pdf">Slides</a></td><td style="text-align:left">Chapter 12 of ICI (Coming soon)</td><td style="text-align:left"><a href="https://arxiv.org/abs/1705.10220">Permutation-based Causal Inference Algorithms with Interventions (Wang et al., 2017)</a></td></tr><tr><td style="text-align:left">November 23</td><td style="text-align:left">Transfer Learning Transportability</td><td style="text-align:left"><a href="https://www.youtube.com/watch?v=JNq4oCV9C5k&amp;list=PLoazKTcS0Rzb6bb9L508cyJ1z-U9iWkA0&amp;index=77">Video</a> <a href="https://www.bradyneal.com/slides/12 - Transfer Learning and Transportability.pdf">Slides</a></td><td style="text-align:left">Chapter 13 of ICI (Coming soon)</td><td style="text-align:left"><a href="https://arxiv.org/abs/2006.07433">A causal framework for distribution generalization (Christiansen et al., 2020)</a></td></tr><tr><td style="text-align:left">November 30</td><td style="text-align:left"><a href="https://yoshuabengio.org/profile/">Yoshua Bengio</a> Guest Talk - Causal Representation Learning (Dec 1st at 1 - 2:30 pm EST)</td><td style="text-align:left"><a href="https://www.youtube.com/watch?v=rKZJ0TJWvTk&amp;list=PLoazKTcS0Rzb6bb9L508cyJ1z-U9iWkA0&amp;index=80">Guest Talk</a> <a href="https://www.bradyneal.com/slides/Yoshua_Bengio_Guest_Talk_Towards_Causal_Representation_Learning.pdf">Slides</a></td><td style="text-align:left">None</td><td style="text-align:left"><a href="https://arxiv.org/abs/1907.02893">Invariant Risk Minimization (Arjovsky et al., 2019)</a></td></tr><tr><td style="text-align:left">December 7</td><td style="text-align:left">Counterfactuals Mediation</td><td style="text-align:left"><a href="https://www.youtube.com/watch?v=f8PEpthLlN4&amp;list=PLoazKTcS0Rzb6bb9L508cyJ1z-U9iWkA0&amp;index=81">Video</a> <a href="https://www.bradyneal.com/slides/14 - Counterfactuals and Mediation.pdf">Slides</a></td><td style="text-align:left">Chapter 14 of ICI (Coming soon)</td><td style="text-align:left"><a href="https://ftp.cs.ucla.edu/pub/stat_ser/r321-ijcai05.pdf">Identifiability of Path-Specific Effects (Avin, Shpitser, &amp; Pearl, 2005)</a></td></tr></tbody></table></div><h2 id="Potential-Reading-Group-Papers-by-Week"><a href="#Potential-Reading-Group-Papers-by-Week" class="headerlink" title="Potential Reading Group Papers by Week"></a>Potential Reading Group Papers by Week</h2><p>We will have a small weekly reading group that runs in parallel to the course. Before any given week’s reading group meeting, 1-3 people will have read the week’s paper in detail and already thought about discussion topics. These 1-3 people will then lead a discussion of a small number of people who have all made themselves familiar with the paper. The discussion group will be kept small (at most 15) in order to facilitate quality discussion. You can ensure that you have a place in the discussion group every week you’d like by signing up to be a discussion leader for at least one week. Below, I give a list of potential reading group papers, organized by week/topic, just like the course schedule is. You can email me at bradyneal11@gmail.com to let me know that you’d like to lead a certain week’s discussion, which paper(s) you’re considering, or to discuss other papers you’d like to discuss that are not on the list.</p><ol><li><p>Motivation and Preview - No reading group</p></li><li><p>Potential Outcomes</p><ul><li><a href="https://www.nature.com/articles/ijo200882">Does obesity shorten life? The importance of well-defined interventions to answer causal questions (Hernán &amp; Taubman, 2008)</a></li><li><a href="https://ftp.cs.ucla.edu/pub/stat_ser/r483-reprint.pdf">Does Obesity Shorten Life? Or is it the Soda? On Non-manipulable Causes (Pearl, 2018)</a></li></ul></li><li><p>Graphical Models and SCMs</p><ul><li><a href="https://www.degruyter.com/view/j/jci.2019.7.issue-1/jci-2019-2002/jci-2019-2002.xml">On the Interpretation of do(x) (Pearl, 2019)</a></li><li><a href="https://arxiv.org/abs/1203.6502">Quantifying causal influences (Janzing et al., 2012)</a></li><li><a href="https://ftp.cs.ucla.edu/pub/stat_ser/r391.pdf">Trygve Haavelmo and the Emergence of Causal Calculus (Pearl, 2014)</a></li></ul></li><li><p>Randomized Experiments, Frontdoor Adjustment, and</p></li></ol><p>   do</p><p>   -calculus</p><ul><li><p><a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.644.1881&amp;rep=rep1&amp;type=pdf">Single World Intervention Graphs: A Primer (Richardson &amp; Robins, 2013)</a></p></li><li><p><a href="http://marcfbellemare.com/wordpress/wp-content/uploads/2019/08/BellemareBloemFDCAugust2019.pdf">The Paper of How: Estimating Treatment Effects Using the Front-Door Criterion (Bellemare &amp; Bloem, 2019)</a></p></li><li><a href="https://causalai.net/r60.pdf">On Pearl’s Hierarchy and the Foundations of Causal Inference (Bareinboim et al., 2020)</a></li></ul><ol><li><p>Estimation and Conditional Average Treatment Effects</p><ul><li><a href="https://arxiv.org/abs/1606.03976">Estimating individual treatment effect: generalization bounds and algorithms (Shalit, Johansson, &amp; Sontag, 2017)</a></li><li><a href="https://arxiv.org/abs/1906.02120">Adapting Neural Networks for the Estimation of Treatment Effects (Shi, Blei, Veitch, 2019)</a></li><li><a href="https://arxiv.org/abs/1610.01271">Generalized Random Forests (Athey, Tibshirani, Wager, 2019)</a></li><li><a href="https://arxiv.org/abs/1706.03461">Meta-learners for Estimating Heterogeneous Treatment Effects using Machine Learning (Künzel et al., 2017)</a> (caution: not about meta-learning in the ML sense)</li></ul></li><li><p>Sensitivity Analysis</p><ul><li><a href="https://rss.onlinelibrary.wiley.com/doi/full/10.1111/rssb.12348">Making sense of sensitivity: extending omitted variable bias (Cinelli &amp; Hazlett, 2019)</a></li><li><a href="https://arxiv.org/abs/2003.01747">Sense and Sensitivity Analysis: Simple Post-Hoc Analysis of Bias Due to Unobserved Confounding (Veitch &amp; Zaveri, 2020)</a></li><li><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3800481/">An Introduction to Sensitivity Analysis for Unobserved Confounding in Non-Experimental Prevention Research (Liu, Kuramoto, &amp; Stuart, 2013)</a></li><li><a href="http://proceedings.mlr.press/v97/cinelli19a.html">Sensitivity Analysis of Linear Structural Causal Models (Cinelli et al., 2019)</a></li></ul></li><li><p>Instrumental Variables, Regression Discontinuity, Difference-in-Differences, and Synthetic Control</p><ul><li><a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.883.6034&amp;rep=rep1&amp;type=pdf">Improving Causal Inference: Strengths and Limitations of Natural Experiments (Dunning, 2007)</a></li><li><a href="http://paa2019.populationassociation.org/uploads/190202">Alternative Causal Inference Methods in Population Health Research: Evaluating Tradeoffs and Triangulating Evidence (Mattay et al., 2019)</a></li><li><a href="http://proceedings.mlr.press/v70/hartford17a/hartford17a.pdf">Deep IV: A Flexible Approach for Counterfactual Prediction (Hartford et al., 2017)</a></li><li><a href="https://www.princeton.edu/~davidlee/wp/RDDEconomics.pdf">Regression Discontinuity Designs in Economics (Lee &amp; Lemieux, 2010)</a></li><li>Synthetic Controls (there are several different Abadie papers; message me, if you’re interested in this topic)</li></ul></li><li><p>BREAK</p></li><li><p>Causal Discovery without Experiments</p><ul><li><a href="https://www.nature.com/articles/s41467-019-10105-3">Inferring causation from time series in Earth system sciences (Runge et al., 2019)</a></li><li><p><a href="https://jmlr.org/papers/v17/14-518.html">Distinguishing Cause from Effect Using Observational Data: Methods and Benchmarks (Mooij et al., 2016)</a></p></li><li><p><a href="https://www.cs.helsinki.fi/u/mjarvisa/papers/hyttinen-eberhardt-jarvisalo.uai15.pdf">Do-calculus when the True Graph Is Unknown (Hyttinen, Eberhardt, Jarvisalo, 2015)</a></p></li><li><a href="https://www.frontiersin.org/articles/10.3389/fgene.2019.00524/full">Review of Causal Discovery Methods Based on Graphical Models (Glymour, Zhang, &amp; Spirtes, 2019)</a></li><li><a href="https://rss.onlinelibrary.wiley.com/doi/10.1111/rssb.12167">Causal inference by using invariant prediction: identification and confidence intervals (Peters, Bühlmann &amp; Meinshausen, 2016)</a></li><li><a href="https://papers.nips.cc/paper/3548-nonlinear-causal-discovery-with-additive-noise-models.pdf">Nonlinear causal discovery with additive noise models (Hoyer et al., 2008)</a></li><li><a href="https://arxiv.org/abs/1903.01672">Causal Discovery from Heterogeneous/Nonstationary Data with Independent Changes (Huang et al., 2020)</a></li></ul></li><li><p>Causal Discovery with Experiments</p><ul><li><a href="https://jmlr.csail.mit.edu/papers/v14/hyttinen13a.html">Experiment Selection for Causal Discovery (Hyttinen, Eberhardt, Hoyer, 2013)</a></li><li><a href="https://arxiv.org/abs/1104.2808">Characterization and Greedy Learning of Interventional Markov Equivalence Classes of Directed Acyclic Graphs (Hauser &amp; Bühlmann, 2012)</a></li><li><a href="https://arxiv.org/abs/1802.06310">Characterizing and Learning Equivalence Classes of Causal DAGs under Interventions (Yang, Katcoff, &amp; Uhler, 2018)</a></li><li><a href="https://www.jmlr.org/papers/volume21/17-123/17-123.pdf">Joint Causal Inference from Multiple Contexts (Mooij, Magliacane, &amp; Claassen, 2020)</a></li></ul></li><li><p>Transportability and Transfer Learning</p><ul><li><a href="https://ftp.cs.ucla.edu/pub/stat_ser/r400-reprint.pdf">External Validity: From Do-Calculus to Transportability Across Populations (Pearl &amp; Bareinboim, 2014)</a></li><li><a href="https://arxiv.org/abs/2006.07433">A causal framework for distribution generalization (Christiansen et al., 2020)</a></li><li><a href="https://www.pnas.org/content/113/27/7345">Causal inference and the data-fusion problem (Bareinboim &amp; Pearl, 2016)</a></li><li><a href="https://icml.cc/2012/papers/625.pdf">On Causal and Anticausal Learning (Schölkopf et al., 2012)</a></li><li><a href="http://proceedings.mlr.press/v28/zhang13d.html">Domain Adaptation under Target and Conditional Shift (Zhang et al., 2013)</a></li><li><a href="https://mingming-gong.github.io/papers/AAAI_MULTI.pdf">Multi-Source Domain Adaptation: A Causal View (Zhang, Gong, &amp; Schölkopf., 2015)</a></li><li><a href="http://www.jmlr.org/papers/volume19/16-432/16-432.pdf">Invariant Models for Causal Transfer Learning (Rojas-Carulla et al., 2016)</a></li><li><a href="https://arxiv.org/abs/2002.03278">Domain Adaptation As a Problem of Inference on Graphical Models (Zhang et al., 2020)</a></li><li><a href="https://arxiv.org/abs/1707.06422">Domain Adaptation by Using Causal Inference to Predict Invariant Conditional Distributions (Magliacane et al., 2018)</a></li></ul></li><li><p>Counterfactuals, Mediation, and Path-Specific Effects</p><ul><li><a href="https://imai.fas.harvard.edu/research/files/mediation.pdf">Identification, Inference and Sensitivity Analysis for Causal Mediation Effects (Imai, Keele, &amp; Yamamoto, 2010)</a></li><li><a href="https://ftp.cs.ucla.edu/pub/stat_ser/r321-ijcai05.pdf">Identifiability of Path-Specific Effects (Avin, Shpitser, &amp; Pearl, 2005)</a></li><li><a href="https://ftp.cs.ucla.edu/pub/stat_ser/r389.pdf">Interpretation and Identification of Causal Mediation (Pearl, 2014)</a></li></ul></li><li><p>TBD - Overflow Week</p></li><li><p>Causal Representation Learning</p><ul><li><a href="http://www.its.caltech.edu/~fehardt/papers/CPE_UAI2015.pdf">Visual Causal Feature Learning (Chalupka, Perona, &amp; Eberhardt, 2015)</a></li><li><a href="https://arxiv.org/abs/1605.08179">Discovering causal signals in images (Lopez-Paz et al., 2017)</a></li><li><a href="https://arxiv.org/abs/1907.02893">Invariant Risk Minimization (Arjovsky et al., 2019)</a></li></ul></li></ol><p><a href="https://www.nber.org/lecture/summer-institute-2021-methods-lectures-causal-inference-using-synthetic-controls-and-regression">Summer Institute 2021 Methods Lectures: Causal Inference Using Synthetic Controls and Regression Discontinuity Designs</a></p><p><a href="https://www.bilibili.com/video/BV1yA411v7q8?from=search&amp;seid=5609008937651178785">Causal inference James M. Robins 因果推断学习分享</a></p><h1 id="Causal-Inference-Book"><a href="#Causal-Inference-Book" class="headerlink" title="Causal Inference Book"></a>Causal Inference Book</h1><p>Jamie Robins and I have written a book that provides a cohesive presentation of concepts of, and methods for, causal inference. Much of this material is currently scattered across journals in several disciplines or confined to technical articles. We expect that the book will be of interest to anyone interested in causal inference, e.g., epidemiologists, statisticians, psychologists, economists, sociologists, political scientists, computer scientists… The book is divided in 3 parts of increasing difficulty: causal inference without models, causal inference with models, and causal inference from complex longitudinal data.</p><blockquote><p>To cite the book, please use “Hernán MA, Robins JM (2020). Causal Inference: What If. Boca Raton: Chapman &amp; Hall/CRC.”</p></blockquote><p>This book is only available online through this page. A print version (for purchase) is expected to become available some time in the future. The exact time, when known, will be announced here. The components of the book can be accessed by clicking on the links below:</p><ul><li><a href="https://cdn1.sph.harvard.edu/wp-content/uploads/sites/1268/2021/03/ciwhatif_hernanrobins_30mar21.pdf">The Causal Inference book</a> (1st edition, 2020)</li><li>NHEFS data<ul><li>In <a href="https://cdn1.sph.harvard.edu/wp-content/uploads/sites/1268/2012/10/nhefs_sas.zip">SAS</a>, <a href="https://cdn1.sph.harvard.edu/wp-content/uploads/sites/1268/2012/10/nhefs_stata.zip">Stata</a>, <a href="https://cdn1.sph.harvard.edu/wp-content/uploads/sites/1268/2017/01/nhefs_excel.zip">MS Excel</a>, and <a href="https://cdn1.sph.harvard.edu/wp-content/uploads/sites/1268/1268/20/nhefs.csv">CSV</a> formats</li><li><a href="https://cdn1.sph.harvard.edu/wp-content/uploads/sites/1268/2012/10/NHEFS_Codebook.xls">Codebook</a></li></ul></li><li>Computer code<ul><li><a href="https://cdn1.sph.harvard.edu/wp-content/uploads/sites/1268/2019/01/sas_part2.zip">SAS</a> by Roger Logan</li><li><a href="https://cdn1.sph.harvard.edu/wp-content/uploads/sites/1268/2019/11/stata_part2.zip">Stata</a> by Eleanor Murray and Roger Logan</li><li><a href="https://cdn1.sph.harvard.edu/wp-content/uploads/sites/1268/1268/20/Rcode_CIpart2.zip">R</a> by Joy Shi and Sean McGrath. <a href="https://remlapmot.github.io/cibookex-r/">Rendered version</a> by Tom Palmer.</li><li><a href="https://github.com/jrfiedler/causal_inference_python_code">Python</a> by James Fiedler</li><li>Parametric g-formula software in <a href="https://github.com/CausalInference/gfoRmula">R</a> and <a href="https://github.com/CausalInference/GFORMULA-SAS">SAS</a></li></ul></li></ul><blockquote><p>Warning: At this stage, we may still revise and correct errors without documenting the changes. Please make sure you use the most updated version of the book posted here.</p></blockquote><p><a href="https://www.nber.org/lecture/summer-institute-2011-methods-lecture-applications-indeterminacy-and-sunspots">Summer Institute 2011 Methods Lecture: Applications: Indeterminacy and Sunspots 夏季研究所2011年方法讲座: 应用: 不确定性和太阳黑子</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2011-methods-lecture-dynare-exercise">Summer Institute 2011 Methods Lecture: Dynare Exercise 夏季学院2011年方法讲座: 动态运动</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2011-methods-lecture-projection-methods">Summer Institute 2011 Methods Lecture: Projection Methods</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2011-methods-lecture-models-heterogeneous-agents">Summer Institute 2011 Methods Lecture: Models with Heterogeneous Agents</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2011-methods-lectures-computational-tools-macroeconomic-applications">Summer Institute 2011 Methods Lectures: Computational Tools &amp; Macroeconomic Applications 2011年夏季学院方法讲座: 计算工具和宏观经济应用</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2011-methods-lecture-introduction-perturbation-and-projection-methods-solving-dsge">Summer Institute 2011 Methods Lecture: Introduction: Perturbation and projection methods for solving DSGE models 夏季研究所2011年方法讲座: 介绍: 解决 DSGE 模型的摄动和投影方法</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2011-methods-lecture-financial-frictions-under-asymmetric-information-and-costly">Summer Institute 2011 Methods Lecture: Financial Frictions Under Asymmetric Information and Costly State Verification 夏季学院2011年方法讲座: 信息不对称和昂贵的国家核查下的金融摩擦</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2011-methods-lecture-why-non-linearnon-gausian-dsge-models-recursive-preferences">Summer Institute 2011 Methods Lecture: Why Non Linear/Non-Gausian DSGE Models? Recursive preferences, stochastic volatility, large shocks 夏季研究所2011年方法讲座: 为什么非线性/非高斯 DSGE 模型? 递归偏好，volatility model，大冲击</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2011-methods-lecture-perturbation-methods">Summer Institute 2011 Methods Lecture: Perturbation Methods 夏季研究所2011年方法讲座: 摄动法</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2008-methods-lecture-kalman-filter-nonlinear-filtering-and-markov-chain-monte-carlo">Summer Institute 2008 Methods Lecture: The Kalman filter, Nonlinear filtering, and Markov Chain Monte Carlo 2008年夏季研究所方法讲座: 卡尔曼滤波，非线性滤波和马尔科夫蒙特卡洛</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2008-methods-lecture-specification-and-estimation-models-stochastic-time-variation">Summer Institute 2008 Methods Lecture: Specification and estimation of models with stochastic time variation 夏季研究所2008年方法讲座: 随机时间变化模型的规格和估计</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2008-methods-lecture-recent-developments-structural-var-modeling">Summer Institute 2008 Methods Lecture: Recent Developments in Structural VAR Modeling 夏季研究所2008年方法讲座: 结构 VAR 模型的最新进展</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2008-methods-lecture-econometrics-dsge-models">Summer Institute 2008 Methods Lecture: Econometrics of DSGE Models 2008年夏季研究所方法讲座: DSGE 模型的计量经济学</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2008-methods-lectures-whats-new-econometrics-time-series">Summer Institute 2008 Methods Lectures: What’s New in Econometrics: Time Series 暑期研究所2008年方法讲座: 计量经济学的新进展: 时间序列</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2010-methods-lecture-gmm-and-consumption-based-asset-pricing-models">Summer Institute 2010 Methods Lecture: GMM and Consumption-Based Asset Pricing Models 夏季研究所2010年方法讲座: 广义矩和基于消费的资产定价模型</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2010-methods-lecture-linear-factor-models-and-event-studies">Summer Institute 2010 Methods Lecture: Linear Factor Models and Event Studies 暑期学院2010年方法讲座: 线性因素模型和事件研究</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2007-methods-lecture-linear-panel-data-models">Summer Institute 2007 Methods Lecture: Linear Panel Data Models 夏季学院2007年方法讲座: 线性面板数据模型</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2007-methods-lecture-regression-discontinuity-designs">Summer Institute 2007 Methods Lecture: Regression Discontinuity Designs 夏季研究所2007年方法讲座: 回归间断设计</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2007-methods-lecture-estimation-average-treatment-effects-under-unconfoundedness">Summer Institute 2007 Methods Lecture: Estimation of Average Treatment Effects Under Unconfoundedness 夏季研究所2007年方法讲座: 平均治疗效果估计在不混淆</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2007-methods-lecture-instrumental-variables-treatment-effect-heterogeneity-local">Summer Institute 2007 Methods Lecture: Instrumental Variables with Treatment Effect Heterogeneity: Local Average Treatment Effects 暑期研究所2007年方法讲座: 治疗效果异质性的工具变量: 局部平均治疗效果</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2007-methods-lecture-control-function-and-related-methods">Summer Institute 2007 Methods Lecture: Control Function and Related Methods 暑期学院2007方法讲座: 控制作用及相关方法</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2007-methods-lecture-bayesian-inference">Summer Institute 2007 Methods Lecture: Bayesian Inference 2007年夏季学院方法讲座: 贝叶斯推断</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2007-methods-lecture-cluster-and-stratified-sampling">Summer Institute 2007 Methods Lecture: Cluster and Stratified Sampling 2007年夏季研究所方法讲座: 集群和分层抽样</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2007-methods-lecture-partial-identification">Summer Institute 2007 Methods Lecture: Partial Identification 暑期学院2007方法讲座: 部分鉴定</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2007-methods-lecture-difference-differences-estimation">Summer Institute 2007 Methods Lecture: Difference-in-Differences Estimation 夏季学院2007年方法讲座: 差异中的差异估计</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2007-methods-lecture-discrete-choice-models">Summer Institute 2007 Methods Lecture: Discrete Choice Models 夏季学院2007年方法讲座: 离散选择模型</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2007-methods-lecture-missing-data">Summer Institute 2007 Methods Lecture: Missing Data 2007年夏季研究所方法讲座: 缺失数据</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2007-methods-lecture-weak-instruments-and-many-instruments">Summer Institute 2007 Methods Lecture: Weak Instruments and Many Instruments 暑期学院2007方法讲座: 弱仪器和多种仪器</a></p><p><a href="https://www.nber.org/lecture/summer-institute-2007-methods-lecture-quantile-methods">Summer Institute 2007 Methods Lecture: Quantile Methods 夏季研究所2007方法讲座: 分位数方法</a></p><p><a href="https://space.bilibili.com/522173499?spm_id_from=333.788.b_765f7570696e666f.1">https://space.bilibili.com/522173499?spm_id_from=333.788.b_765f7570696e666f.1</a></p><p><a href="https://awstringer1.github.io/sta238-book/">https://awstringer1.github.io/sta238-book/</a></p>]]></content>
      
      
      <categories>
          
          <category> 研究方法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DID PSM RDD ML CI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何使用hexo+gitte+typora建立个人博客网站？</title>
      <link href="/2021/08/20/ru-he-shi-yong-hexo-gitte-typora-jian-li-ge-ren-bo-ke-wang-zhan/"/>
      <url>/2021/08/20/ru-he-shi-yong-hexo-gitte-typora-jian-li-ge-ren-bo-ke-wang-zhan/</url>
      
        <content type="html"><![CDATA[<h2 id="一、准备工作"><a href="#一、准备工作" class="headerlink" title="一、准备工作"></a>一、准备工作</h2><h3 id="1-安装git"><a href="#1-安装git" class="headerlink" title="1.安装git"></a>1.安装git</h3><p>在各大电脑管家安装（我是用的是联想自带的电脑管家），速度比较快一点，用git官方安装速度太慢，不建议。</p><h3 id="2-安装node-js"><a href="#2-安装node-js" class="headerlink" title="2.安装node.js"></a>2.安装node.js</h3><p>node.js其自带npm，用来下载hexo插件，建议下载国内cnpm，速度较快</p><pre class=" language-lang-bash"><code class="language-lang-bash">https://nodejs.org/zh-cn/ #node.js中文网站npm install -g cnpm --registry=https://registry.npm.taobao.orgcnpm install hexo-symbols-count-time  #利用cnpm安装hexo插件</code></pre><h2 id="二、安装hexo（官网）"><a href="#二、安装hexo（官网）" class="headerlink" title="二、安装hexo（官网）"></a>二、安装hexo（<a href="https://hexo.io/zh-cn/">官网</a>）</h2><p>启动<em>Git Bash Here</em>，然后输入命令：</p><pre class=" language-lang-bash"><code class="language-lang-bash">npm install hexo-cli -g</code></pre><p>手动在d盘下建立blog文件夹，d:\blog或者使用命令：</p><pre class=" language-lang-bash"><code class="language-lang-bash">mkdir blog</code></pre><p>首先进行初始化在本地生成<em>Hexo</em>相关目录：</p><pre class=" language-lang-bash"><code class="language-lang-bash">hexo init</code></pre><p>然后就可以使用<em>Hexo三连</em>了，即我们最常用的三个主要命令（依旧在上述Git Bash命令端口中）：</p><pre class=" language-lang-bash"><code class="language-lang-bash">hexo clean # 清空已有hexo网站文件hexo generate(or g) # 依据网页文本与新的CSS样式生成新网站文件hexo server(or s) # 启动本地服务器，可以在localhost:4000查看网站修改效果</code></pre><p>依次运行上述三个命令，就可以在浏览器打开<em>localhost:4000</em>端口，查看对应网站界面效果，一般默认的是一个<em>landscape</em>主题，后期当提交新文章或者新的样式修改时，往往都是先从本地查看结果无误后再部署到<em>Gitee Page</em>。至此最简单的个人博客建立工作就已经完成了。接下来是如何部署到网上，让别人也能看到你的个人博客网站。</p><p><img src="/images/image-20210820100717848.png" alt="image-20210820100717848"></p><h2 id="三、-把博客部署到码云上"><a href="#三、-把博客部署到码云上" class="headerlink" title="三、 把博客部署到码云上"></a>三、 把博客部署到码云上</h2><blockquote><p>首先说明一下，为什么选择码云，最近 GitHub 经常性蹦，访问也比较慢，所以我就选择了码云实现一下，<strong>当然你有服务器就最好不过了</strong>。</p></blockquote><p>码云（gitee）：<strong><a href="https://gitee.com/">https://gitee.com/</a></strong></p><h3 id="1-注册码云，创建仓库"><a href="#1-注册码云，创建仓库" class="headerlink" title="1. 注册码云，创建仓库"></a>1. 注册码云，创建仓库</h3><p>我们需要在 gitee 创建自己的账户（<strong>如果没有</strong>），然后再创建一个自己仓库</p><p><img src="/images/image-20210820092812603.png" alt="image-20210820092812603"></p><p>输入仓库名称，其它默认即可，<strong>这里因为我已经创建了</strong>。</p><p><img src="/images/image-20210820092854486.png" alt="image-20210820092854486"></p><p>这里强烈建议使用与归属名相同的仓库名和路径名，最后会产生个人博客的网站时，没有二级目录，如<a href="https://www.xiahanlin.gitte.io">https://www.xiahanlin.gitte.io</a></p><p><img src="/images/image-20210820093120287.png" alt="image-20210820093120287"></p><h3 id="2-生成-添加-SSH-公钥"><a href="#2-生成-添加-SSH-公钥" class="headerlink" title="2. 生成/添加 SSH 公钥"></a>2. 生成/添加 SSH 公钥</h3><p>码云 Gitee 、GitHub 提供了基于 SSH 协议的 Git 服务，在使用 SSH 协议访问仓库仓库之前，需要先配置好账户/仓库的 SSH 公钥。</p><p><strong>2.1 配置 ssh 账户和邮箱</strong></p><p>邮箱不必与 Gitee 账号相同，个人邮箱即可。</p><pre class=" language-lang-bash"><code class="language-lang-bash">git config --global user.email *********@163.com # 设置邮箱git config --global user.name '****'   # 设置用户名</code></pre><p>查看账户和邮箱</p><pre class=" language-lang-bash"><code class="language-lang-bash">git config --global user.name git config --global user.email</code></pre><p><strong>2.2 本地生成ssh公钥</strong></p><p>邮箱为刚配置好的账户邮箱</p><pre class=" language-lang-bash"><code class="language-lang-bash">ssh-keygen -t rsa -C "xxxxx@xxxxx.com"</code></pre><p>按照提示完成三次回车，即可生成 ssh key</p><p><strong>2.3查看 ssh 公钥</strong></p><pre class=" language-lang-bash"><code class="language-lang-bash">vim ~/.ssh/id_rsa.pub# 退出:qa!</code></pre><p>复制公钥去 Gitee 粘贴，添加</p><p><strong>2.4 测试是否连接成功</strong></p><p>码云 Gitee</p><pre class=" language-lang-bash"><code class="language-lang-bash">ssh -T git@gitee.com</code></pre><p>如下图所示，则表示连接成功</p><p><img src="/images/image-20210820101100663.png" alt="image-20210820101100663"></p><h4 id="2-5-配置连接-Gitee"><a href="#2-5-配置连接-Gitee" class="headerlink" title="2.5 配置连接 Gitee"></a>2.5 配置连接 Gitee</h4><p>进入到我们新创建的仓库，复制项目地址</p><p><img src="/images/image-20210820093545187.png" alt="image-20210820093545187"></p><p>复制 URL ，到 hexo 的配置文件 <code>_config.yml</code>，相应位置修改成如下：</p><p><img src="/images/image-20210820093636497.png" alt="image-20210820093636497"></p><h2 id="四、部署博客"><a href="#四、部署博客" class="headerlink" title="四、部署博客"></a>四、部署博客</h2><h3 id="1-安装自动部署发布工具"><a href="#1-安装自动部署发布工具" class="headerlink" title="1.安装自动部署发布工具"></a>1.安装自动部署发布工具</h3><pre class=" language-lang-bash"><code class="language-lang-bash">cnmp install hexo-deployer-git --save</code></pre><p>新建 deployer.sh 文件，输入代码：</p><pre class=" language-lang-bash"><code class="language-lang-bash">hexo cleanhexo g hexo d</code></pre><p>一键部署博客</p><pre class=" language-lang-bash"><code class="language-lang-bash">sh deployer.sh</code></pre><h3 id="2-Gitee-Pages-设置"><a href="#2-Gitee-Pages-设置" class="headerlink" title="2.Gitee Pages 设置"></a>2.Gitee Pages 设置</h3><p>在项目的服务中选择 Pages 选项</p><p><img src="/images/image-20210820093813756.png" alt="image-20210820093813756"></p><p>默认配置，点击启动即可</p><p><img src="/images/image-20210820093843006.png" alt="image-20210820093843006"></p><p>下图则成功开启，记住博客地址，之后可以点更新进行操作</p><p><img src="/images/image-20210820093859677.png" alt="image-20210820093859677"></p><p><strong>博客发布成功之后，可以访问博客地址：xxxxxx，就可通过他提供的博客地址进行访问，预览在线博客啦！！</strong></p><p>如果博客的样式不对，则需要在_config.yml中配置下博客地址和路径：</p><pre class=" language-lang-yaml"><code class="language-lang-yaml">url: “码云提供给您的博客地址” #如https://www.xiahanlin.gitte.ioroot: /</code></pre><h2 id="五、主题配置"><a href="#五、主题配置" class="headerlink" title="五、主题配置"></a>五、主题配置</h2><p>下载自己喜欢的主题，可以去<a href="https://hexo.io/themes/">hexo官网主题探索</a>。这里我是用的是next主题，可以去next github仓库中下载压缩包然后<strong>放到博客项目根目录下的 themes 中</strong>。</p><p>然后配置站点 <strong>_config.yml</strong></p><pre class=" language-lang-yaml"><code class="language-lang-yaml">theme: “您的主题文件夹完整名称”  # 这里需要注意:后面要有一个空格，名称要和theme下的主题目录名称相同。</code></pre><p>修改完成，本地运行 <code>hexo s</code> 测试成功即可上传部署到 Gitee 然后点击更新即可。</p><p><img src="/images/image-20210820094259482.png" alt="image-20210820094259482"></p><h2 id="六、主题优化"><a href="#六、主题优化" class="headerlink" title="六、主题优化"></a>六、主题优化</h2><h3 id="1-Next主题风格"><a href="#1-Next主题风格" class="headerlink" title="1.Next主题风格"></a><strong>1.Next主题风格</strong></h3><p>Next提供了四种主题风格scheme，可以在主题配置文件blog/themes/next/_config.yml文件中进行选择，分别是Muse、Mist、Pisces、Gemini：</p><p><img src="/images/image-20210820102317772.png" alt="image-20210820102317772"></p><p><img src="/images/image-20210820102422526.png" alt="image-20210820102422526"></p><p><img src="/images/image-20210820102556541.png" alt="image-20210820102556541"></p><p><img src="/images/image-20210820102822192.png" alt="image-20210820102822192"></p><p>我目前使用的是第一个布局。</p><p><strong>Next主题一般配置</strong>：</p><pre class=" language-lang-yaml"><code class="language-lang-yaml">override: false# Console reminder if new version released.reminder: false# Allow to cache content generation. Introduced in NexT v6.0.0.cache:  enable: true #表示添加缓存功能，这样浏览器后续打开我们的博客网站会更快# Remove unnecessary files after hexo generate.minify: false# Define custom file paths.# Create your custom files in site directory `source/_data` and uncomment needed files below.custom_file_path:  #head: source/_data/head.swig  #header: source/_data/header.swig  #sidebar: source/_data/sidebar.swig  #postMeta: source/_data/post-meta.swig  #postBodyEnd: source/_data/post-body-end.swig  #footer: source/_data/footer.swig  #bodyEnd: source/_data/body-end.swig  #variable: source/_data/variables.styl  #mixin: source/_data/mixins.styl  #style: source/_data/styles.styl# ---------------------------------------------------------------# Site Information Settings# See: https://theme-next.org/docs/getting-started/# ---------------------------------------------------------------favicon:  small: /images/16×16.png  medium: /images/32×32.png  apple_touch_icon: /images/128×128.png  safari_pinned_tab: /images/icon-close.svg  #android_manifest: /images/manifest.json  #ms_browserconfig: /images/browserconfig.xml# Show multilingual switcher in footer.language_switcher: falsefooter:  # Specify the date when the site was setup. If not defined, current year will be used.  since: 2021 #建站时间</code></pre><h3 id="2-添加小宠物"><a href="#2-添加小宠物" class="headerlink" title="2.添加小宠物"></a>2.添加小宠物</h3><pre class=" language-lang-bash"><code class="language-lang-bash">  npm install --save live2d-widget-model-epsilon2_1</code></pre><p><img src="/images/image-20210820133717230.png" alt="image-20210820133717230"></p><pre class=" language-lang-bash"><code class="language-lang-bash">npm install --save live2d-widget-model-haruto</code></pre><p><img src="/images/image-20210820134326054.png" alt="image-20210820134326054"></p><pre class=" language-lang-bash"><code class="language-lang-bash">npm install --save live2d-widget-model-hibiki</code></pre><p><img src="/images/image-20210820134601730.png" alt="image-20210820134601730"></p><pre class=" language-lang-bash"><code class="language-lang-bash">npm install --save live2d-widget-model-hijiki</code></pre><p><img src="/images/image-20210820134828309.png" alt="image-20210820134828309"></p><pre class=" language-lang-bash"><code class="language-lang-bash">npm install --save live2d-widget-model-izumi</code></pre><p><img src="/images/image-20210820135033682.png" alt="image-20210820135033682"></p><pre class=" language-lang-bash"><code class="language-lang-bash">npm install --save live2d-widget-model-koharu</code></pre><p><img src="/images/image-20210820135205688.png" alt="image-20210820135205688"></p><pre class=" language-lang-bash"><code class="language-lang-bash">npm install --save live2d-widget-model-tororo</code></pre><p><img src="/images/image-20210820140512945.png" alt="image-20210820140512945"></p><h2 id="七、问题解决"><a href="#七、问题解决" class="headerlink" title="七、问题解决"></a>七、问题解决</h2><h3 id="1-hexo框架下，如何解决图片插入？"><a href="#1-hexo框架下，如何解决图片插入？" class="headerlink" title="1.hexo框架下，如何解决图片插入？"></a>1.hexo框架下，如何解决图片插入？</h3><p>试了好多方法，发现下面这种方法是可行，结合typora。</p><p>使用最简单的方式在 source 目录下创建images目录，然后图片都保存在这里。</p><p>关键是要在typora上做以下设置：</p><p><img src="/images/image-20210820095337861.png" alt="image-20210820095337861"></p><p>在md文件头部的配置项中，添加 <code>typora-root-url: ../</code></p><pre class=" language-lang-yaml"><code class="language-lang-yaml">---title:  hexo+typora 插入图片date: 2019-06-08 10:37:22tags:typora-root-url: ../---Copy</code></pre><p>这样引用的图片都以上一级目录即 sourse作为根目录了，并在偏好设置中，设置插入图片复制到指定到路径，此时插入的图片，都会自动保存在 sourse/images目录下，并且本地的显示和服务器上的根目录完全一致，使用体验还是很方便的。</p><p><img src="/images/image-20210820095008002.png" alt="image-20210820095008002"></p><p>总结以上，就是在每篇md文件中，开头设置<code>typora-root-url: ../</code>，然后设置偏好设置，就可以既实现typora本地实时预览和网上配图的完美结合。</p><p>一次配置，永久实现，在<code>scaffolds</code>文件夹下的post.md，是每次hexo n 的默认模板，可以通过更改它，实现每次新建md文件，就已经配置好，然后在typora设置一下，就可以永久不用担心图片在博客中的实现问题。</p><p>8.测试代码和公式支持</p><pre class=" language-lang-stata"><code class="language-lang-stata">****  合并数据 ****use C:\Users\msi\Desktop\数据处理\asset.dta,replacemerge m:m BankCode Date using C:\Users\msi\Desktop\数据处理\operation.dta,nogenmerge m:m BankCode Date using C:\Users\msi\Desktop\数据处理\profit.dta,nogenmerge m:m BankCode Date using C:\Users\msi\Desktop\数据处理\creditlossprepare.dta,nogen****  转换文字变量为数字变量和日期变量 ****destring BankCode,gen(Code)gen date = date(Date,"YMD")format date %tdtsset Code datedrop BankCode drop Datelabel var Code 银行代码label var BankName 银行名称label var date 统计日期label var FCIC 手续费及佣金收入label var NIAPC 归属于母公司所有者的净利润label var BEPS 基本每股收益label var REV 营业收入label var TDepo 存款总额label var TLoan 贷款总额label var CptAdqRt "资本充足率(%)"label var NpfLnRt5 不良贷款比例label var NpfPpCvRt5 不良贷款拨备覆盖率label var CsIncRt "成本收入比(%)"label var TA 资产总计label var EAPC 归属于母公司所有者权益合计label var DdLnRsvfd "贷款呆帐准备金"****  导出为excel格式  ****export excel using "C:\Users\msi\Desktop\数据处理\年度数据.xls", sheetreplace firstrow(varlabels)</code></pre><script type="math/tex; mode=display">\frac{x^2}{y^2}*z^2=m^2+n^2</script><p>$y^2=2$</p><p>$y^2=2$</p><script type="math/tex; mode=display">y^2=3</script><pre class=" language-lang-yaml"><code class="language-lang-yaml">---title: 基于Hexo的hexo-theme-matery主题搭建博客并优化date: 2019-10-03 14:25:00author: 悟尘img: /source/images/xxx.jpgtop: truecover: truecoverImg: /images/1.jpgpassword: 8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92toc: falsemathjax: falsesummary: 这是你自定义的文章摘要内容，如果这个属性有值，文章卡片摘要就显示这段文字，否则程序会自动截取文章的部分内容作为摘要categories: 工具tags:  - blog  - hexo---</code></pre><p><code>Front-matter</code> 选项中的所有内容均为<strong>非必填</strong>的。但我仍然建议至少填写 <code>title</code> 和 <code>date</code> 的值。</p><div class="table-container"><table><thead><tr><th style="text-align:left">配置选项</th><th style="text-align:left">默认值</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">title</td><td style="text-align:left"><code>Markdown</code> 的文件标题</td><td style="text-align:left">文章标题，强烈建议填写此选项</td></tr><tr><td style="text-align:left">date</td><td style="text-align:left">文件创建时的日期时间</td><td style="text-align:left">发布时间，强烈建议填写此选项，且最好保证全局唯一</td></tr><tr><td style="text-align:left">author</td><td style="text-align:left">根 <code>_config.yml</code> 中的 <code>author</code></td><td style="text-align:left">文章作者</td></tr><tr><td style="text-align:left">img</td><td style="text-align:left"><code>featureImages</code> 中的某个值</td><td style="text-align:left">文章特征图，推荐使用图床(腾讯云、七牛云、又拍云等)来做图片的路径.如: <code>http://xxx.com/xxx.jpg</code></td></tr><tr><td style="text-align:left">top</td><td style="text-align:left"><code>true</code></td><td style="text-align:left">推荐文章（文章是否置顶），如果 <code>top</code> 值为 <code>true</code>，则会作为首页推荐文章</td></tr><tr><td style="text-align:left">cover</td><td style="text-align:left"><code>false</code></td><td style="text-align:left"><code>v1.0.2</code>版本新增，表示该文章是否需要加入到首页轮播封面中</td></tr><tr><td style="text-align:left">coverImg</td><td style="text-align:left">无</td><td style="text-align:left"><code>v1.0.2</code>版本新增，表示该文章在首页轮播封面需要显示的图片路径，如果没有，则默认使用文章的特色图片</td></tr><tr><td style="text-align:left">password</td><td style="text-align:left">无</td><td style="text-align:left">文章阅读密码，如果要对文章设置阅读验证密码的话，就可以设置 <code>password</code> 的值，该值必须是用 <code>SHA256</code> 加密后的密码，防止被他人识破。前提是在主题的 <code>config.yml</code> 中激活了 <code>verifyPassword</code> 选项</td></tr><tr><td style="text-align:left">toc</td><td style="text-align:left"><code>true</code></td><td style="text-align:left">是否开启 TOC，可以针对某篇文章单独关闭 TOC 的功能。前提是在主题的 <code>config.yml</code> 中激活了 <code>toc</code> 选项</td></tr><tr><td style="text-align:left">mathjax</td><td style="text-align:left"><code>false</code></td><td style="text-align:left">是否开启数学公式支持 ，本文章是否开启 <code>mathjax</code>，且需要在主题的 <code>_config.yml</code> 文件中也需要开启才行</td></tr><tr><td style="text-align:left">summary</td><td style="text-align:left">无</td><td style="text-align:left">文章摘要，自定义的文章摘要内容，如果这个属性有值，文章卡片摘要就显示这段文字，否则程序会自动截取文章的部分内容作为摘要</td></tr><tr><td style="text-align:left">categories</td><td style="text-align:left">无</td><td style="text-align:left">文章分类，本主题的分类表示宏观上大的分类，只建议一篇文章一个分类</td></tr><tr><td style="text-align:left">tags</td><td style="text-align:left">无</td><td style="text-align:left">文章标签，一篇文章可以多个标签</td></tr><tr><td style="text-align:left">keywords</td><td style="text-align:left">文章标题</td><td style="text-align:left">文章关键字，SEO 时需要</td></tr><tr><td style="text-align:left">reprintPolicy</td><td style="text-align:left">cc_by</td><td style="text-align:left">文章转载规则， 可以是 cc_by, cc_by_nd, cc_by_sa, cc_by_nc, cc_by_nc_nd, cc_by_nc_sa, cc0, noreprint 或 pay 中的一个</td></tr></tbody></table></div><h2 id="八、插入PDF"><a href="#八、插入PDF" class="headerlink" title="八、插入PDF"></a>八、插入PDF</h2><p>如果我们想在word上编辑，然后放到博客上，可以先利用word另存为pdf，然后利用pdf插件实现。这一点在我所使用的Next6主题中采用了，具体如下：</p><ul><li><p>step1 安装pdf插件</p><p>进入我们博客的主题目录，如blog/themes/next6，执行：</p></li></ul><pre class=" language-lang-bash"><code class="language-lang-bash">git clone https://github.com/theme-next/theme-next-pdf source/lib/pdf</code></pre><p>或者在blog/目录下执行：</p><pre class=" language-lang-bash"><code class="language-lang-bash">npm install hexo-pdf --save</code></pre><ul><li>step2 hexo 配置（如果采用第一种安装方式）</li></ul><pre class=" language-lang-yaml"><code class="language-lang-yaml">pdf:  enable: true  per_page: true  height: 500px  pdfobject:    cdn: //cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js</code></pre><ul><li><p>step3 存放pdf</p><p>存放pdf的方式跟图片一模一样，具体我就不说了</p></li><li><p>step4 插入pdf</p><p>官方支持的方式是</p></li></ul><pre class=" language-lang-markdown"><code class="language-lang-markdown">[](pdf链接)</code></pre><p>而采用方法二的使用方式是：</p><pre class=" language-lang-markdown"><code class="language-lang-markdown">&#123;% pdf pdf链接 %&#125;</code></pre><p>官方的那个我总是编译出问题，所以下面给出方法二的效果：</p><p><img src="/images/1548178854323.png" alt="1548178854323"></p><h2 id="九、配置个性化域名"><a href="#九、配置个性化域名" class="headerlink" title="九、配置个性化域名"></a>九、配置个性化域名</h2><h1 id="配置个性化域名"><a href="#配置个性化域名" class="headerlink" title="配置个性化域名"></a>配置个性化域名</h1><p>一顿操作下来，打开我们的博客还是：<a href="http://www.xxx.github.io/">www.xxx.github.io</a>，是不是很没有牌面？我们可以考虑购买一个专属域名，以后打开博客就是这样：<a href="http://www.xxx.com/">www.xxx.com</a> 。</p><p><a href="https://www.aliyun.com/">阿里云</a>和<a href="https://cloud.tencent.com/">腾讯云</a>都可以，我的是腾讯云，购买域名后首先需要添加解析：</p><p><strong>方法一：</strong>点击添加记录，需要添加两个记录，两个记录类型都是 CNAME ，第一个主机记录为 @ ，第二个主机记录为 www，记录值都是填你自己的博客地址（比如我的是：muyiio.github.io），保存之后域名解析就完成了！</p><p><strong>方法二：</strong>两个记录类型为 A ，第一个主机记录为 @ ，第二个主机记录为 www，记录值都为博客的 IP 地址，IP 地址可以 cmd 中输入 ping 你的博客地址 获得（比如我的：ping muyiio.github.io），保存之后域名解析就完成了！</p><p>参考资料：</p><p><a href="https://blog.csdn.net/it_man/article/details/9017307">《域名解析中A记录、CNAME、MX记录、NS记录的区别和联系》</a></p><p><strong>不管在哪个平台购买域名，操作都大同小异，这里说明两点</strong>：</p><blockquote><p>如果你填写的是没有www的，比如 muyio.com，那么无论是访问 <a href="https://www.muyiio.com/">https://www.muyiio.com</a> 还是 <a href="https://muyiio.com/">https://muyiio.com</a> ，都会自动跳转到 <a href="https://muyiio.com/">https://muyiio.com</a>。</p><p>如果你填写的是带www的，比如 <a href="http://www.muyiio.com/">www.muyiio.com</a> ，那么无论是访问 <a href="https://www.muyiio.com/">https://www.muyiio.com</a> 还是 <a href="https://muyiio.com/">https://muyiio.com</a> ，都会自动跳转到 <a href="http://www.imuyiio.com/">http://www.imuyiio.com</a>。</p></blockquote><p>然后打开你的github博客项目，点击settings，拉到下面Custom domain处，填上你自己的域名，保存就可以了。</p><p>现在我们的项目根目录应该会出现一个名为CNAME的文件了。如果没有的话，打开你本地博客/source目录，我的是C:\Blog\Hexo\source，新建CNAME文件，（注意不要加.txt，没有任何后缀名！）。然后在里面写上你的域名，保存。最后运行hexo g、hexo d上传到github。</p><p>现在就可以通过我们的个性化域名：<a href="http://www.xxx.xn--comxxx-kr3e.com/">www.xxx.com、xxx.com</a>访问自己的博客了</p><p><img src="/images/image-20221011183719730.png" alt="image-20221011183719730"></p><p><a href="https://github.com/xiahanlin1993">xiahanlin1993</a></p><p>git config —global user.name “xiahanlin1993”<br>git config —global user.email “xiahanlin1993@163.com”</p><p>git config user.email</p><p>ssh-keygen -t rsa -C “xiahanlin1993@163.com”</p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
